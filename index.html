<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-TECH SOLUTIONS | Electronics & Computer Projects</title> 
     <link rel="icon" type="image/png" href="https://lh3.googleusercontent.com/pw/AP1GczNty6_2Cq0hySwk_JWjLVcINZz0lyqfq9BNLXjr9-qhG_94UV7oQLhTNB7VtAP8qM1G06Gj36pEqbZyvBWZlV4508OriC45KwQoabQ8qSRc5HHMGPVu=w2400?source=screenshot.guru">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- UPDATED: Added necessary Firebase Social Auth imports -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <!-- Load KaTeX for beautiful math/symbol rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" xintegrity="sha384-Gvr4iO9rQk5QxK3m1i5hI9jP5i5E6qE6kQ5A0tE4Q4p5/2w7J3w8P4q1n2p7Q3E" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" xintegrity="sha384-6Xh5n0k2f/rJvC9g2z8tN7i5hE6qE6kQ5A0tE4Q4p5/2w7J3w8P4q1n2p7Q3E" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" xintegrity="sha384-FpYtW5m3gT/4t7/p/K0m6p+g5/2w7J3w8P4q1n2p7Q3E" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
    <!-- NEW: Load D3.js for Skill Tree Visualization -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <style>
        :root {
            /* DARK THEME VARIABLES */
            --primary: #121212; /* Deep Dark Background */
            --secondary: #00e5ff; /* Cyan Accent - Main highlight */
            --accent: #ff4081; /* Pink Accent - Secondary highlight/call-to-action */
            --text-light: #ffffff; /* White text for visibility */
            --text-mid: #a0a0a0; /* Gray text for body/subtext */
            --card-bg: #1e1e1e; /* Slightly lighter card background */
            --border-color: #333333; /* Dark border lines */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--primary);
            color: var(--text-light); /* Ensure all body text is light */
            scroll-behavior: smooth;
            overflow-x: hidden;
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        /* High Visibility Text */
        .glow-text {
            text-shadow: 0 0 5px rgba(0, 229, 255, 0.2), 0 0 10px rgba(0, 229, 255, 0.4);
            color: var(--text-light);
        }
        
        /* NEW: E-TECH SOLUTIONS Heading Hover Effect */
        .logo-text.glow-text:hover {
            background: linear-gradient(135deg, var(--secondary), var(--accent), var(--secondary));
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: text-gradient-shift 1s linear infinite;
            text-shadow: 0 0 10px rgba(255, 64, 129, 0.8), 0 0 20px rgba(0, 229, 255, 0.5);
            transition: all 0.5s ease-in-out;
        }

        @keyframes text-gradient-shift {
            to {
                background-position: 200% center;
            }
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }

        header {
            background: rgba(18, 18, 18, 0.85); /* Semi-transparent dark header */
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            transition: transform 0.3s ease-in-out; /* Added transform transition */
        }
        
        /* NEW: Header Hiding Class */
        header.header-hidden {
            transform: translateY(-100%);
        }

        .header-container {
            display: flex;
            /* FIX: Ensure content does not wrap unnecessarily */
            flex-wrap: nowrap; 
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }
        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            white-space: nowrap; /* Prevent wrapping in desktop/tablet */
            min-width: 0;
        }
        .logo-text span {
            color: var(--accent);
        }
        nav a {
            color: var(--text-light);
            text-decoration: none;
            font-weight: 600;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
            position: relative;
        }
        nav a:hover {
            color: var(--secondary);
            text-shadow: 0 0 8px rgba(0, 229, 255, 0.5);
        }
        nav a.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 2px;
            background: linear-gradient(90deg, var(--secondary), var(--accent));
        }

        .mobile-toggle {
            display: none;
            cursor: pointer;
            font-size: 1.5rem;
        }

        .hero {
            padding: 10rem 0;
            text-align: center;
            position: relative;
            /* Added deep space background image */
            background-image: url('https://images.unsplash.com/photo-1517336714731-489689fd1ca8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            overflow: hidden;
        }
        
        /* Overlay for contrast */
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1;
        }

        .hero > .container {
            position: relative;
            z-index: 2;
        }
        
        .hero h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 3.5rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--secondary);
            text-shadow: 0 0 15px var(--secondary);
        }
        
        .section {
            padding: 8rem 0;
            position: relative;
        }

        .section-title h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            display: inline-block;
            margin-bottom: 2rem;
            /* Ensure the text is visible with gradient */
            background: linear-gradient(45deg, var(--secondary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.2);
        }
        
        /* Card Styles (Dark Mode, High Visibility) */
        .card-3d {
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }
        
        .card-3d:hover {
            transform: scale(1.05) translateZ(10px);
            box-shadow: 0 0 25px rgba(0, 229, 255, 0.4);
            border-color: var(--secondary);
        }
        
        .glassmorphism {
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }
        
        .neon-glow {
            box-shadow: 0 0 10px rgba(0, 229, 255, 0.3);
        }
        
        .btn-3d {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            color: var(--text-light); /* Default button text color */
        }
        
        .btn-3d:active {
            transform: translateY(2px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }

        /* NEW: Box Style for Action Buttons */
        .btn-box {
            border-radius: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        /* Styling for the Primary Action Buttons (Add to Cart, Checkout) */
        .btn-primary-action {
            background: linear-gradient(90deg, var(--secondary), var(--accent));
            color: var(--text-light);
            border: none;
        }
        .btn-primary-action:hover {
            opacity: 0.9;
            box-shadow: 0 0 15px var(--secondary);
            transform: scale(1.02);
        }
        
        /* NEW: Buy Now Button Styling - Slightly different from primary to distinguish */
        .btn-buy-now {
            background-color: var(--accent);
            color: var(--text-light);
            border: none;
        }
        .btn-buy-now:hover {
            opacity: 0.9;
            box-shadow: 0 0 15px var(--accent);
            transform: scale(1.02);
        }


        /* Styling for the Secondary/Disabled Buttons (Available Soon) */
        .btn-secondary-action {
            background-color: var(--card-bg);
            color: var(--text-mid);
            border: 1px solid var(--secondary);
        }
        .btn-secondary-action.disabled {
            background-color: #333333;
            border-color: #555555;
            color: #777777;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        /* Floating Button Positioning & Styling */
        #techwhiz-fab {
            bottom: 2rem;
            right: 2rem;
            z-index: 1001;
            width: 64px;
            height: 64px;
            border-radius: 0.5rem; /* Box Type */
        }

        /* TechWhiz Voice Active Indicator */
        #techwhiz-fab.speech-active {
            animation: pulse-ring 1.5s infinite;
            box-shadow: 0 0 30px rgba(0, 229, 255, 1);
        }

        @keyframes pulse-ring {
            0% { transform: scale(0.9); box-shadow: 0 0 0 0 rgba(0, 229, 255, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(0, 229, 255, 0); }
            100% { transform: scale(0.9); box-shadow: 0 0 0 0 rgba(0, 229, 255, 0); }
        }

        #cart-fab {
            /* Positioned 4rem (64px button height + 16px gap) above techwhiz-fab (2rem) */
            bottom: 6rem;
            right: 2rem;
            z-index: 1002; /* Above techwhiz */
            width: 60px;
            height: 60px;
            border-radius: 0.5rem; /* Box Type */
            background: linear-gradient(145deg, var(--secondary), var(--accent));
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: fixed; /* Added to ensure it floats */
        }
        
        #cart-fab:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 229, 255, 0.7);
        }

        #cart-fab:active {
            transform: translateY(2px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }

        #cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--accent);
            color: white;
            border-radius: 9999px;
            padding: 0.1rem 0.5rem;
            font-size: 0.75rem;
            font-weight: bold;
            line-height: 1;
        }

        /* Cart Modal Styling (Futuristic, Slides In) */
        #cart-modal {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            max-width: 400px; /* Enhanced max width */
            height: 100%;
            background: var(--card-bg);
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.7);
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 1003;
            display: flex;
            flex-direction: column;
            border-left: 2px solid var(--secondary); /* Neon border */
        }
        
        #cart-modal.open {
            transform: translateX(0);
        }
        
        .cart-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary); /* Header contrast */
        }
        
        .cart-header h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--secondary);
        }
        
        #close-cart-btn {
            font-size: 2rem;
            padding: 0 0.5rem;
            transition: color 0.2s;
        }
        
        #cart-modal-items {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem 1.5rem;
            background: var(--card-bg);
        }

        .cart-modal-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .cart-modal-item img {
            min-width: 48px;
            min-height: 48px;
        }
        
        /* NEW: Cart Item Controls Styling */
        .cart-controls button {
            width: 24px;
            height: 24px;
            background: var(--primary);
            color: var(--secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            line-height: 1;
            transition: background-color 0.2s, color 0.2s;
        }
        
        .cart-controls button:hover {
            background: var(--secondary);
            color: var(--primary);
        }

        .cart-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border-color);
            background: var(--primary);
        }
        
        .cart-total-display {
            display: flex;
            justify-content: space-between;
            font-size: 1.5rem;
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 1rem;
        }
        
        .cart-total-display span:last-child {
            color: var(--accent);
            text-shadow: 0 0 5px rgba(255, 64, 129, 0.5);
        }
        
        /* Component Detail Modal Styling */
        #component-detail-modal {
            background: rgba(0, 0, 0, 0.9);
            /* Centering fix applied here */
            display: none; /* Hidden by default */
            position: fixed;
            inset: 0;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            z-index: 1005;
        }
        
        #component-detail-content {
            background: var(--card-bg);
            border: 1px solid var(--secondary);
            box-shadow: 0 0 30px rgba(0, 229, 255, 0.5);
            color: var(--text-light);
            max-width: 800px;
            width: 100%;
            padding: 2rem;
            border-radius: 0.75rem;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        #component-detail-content .detail-header {
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
        
        #component-detail-content .detail-info h4 {
            color: var(--secondary);
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            font-family: 'Orbitron', sans-serif;
        }

        /* NEW: Canvas for Sensor Mock Visualization */
        #sensor-viz-canvas {
            width: 100%;
            height: 150px;
            background-color: #0d0d0d;
            border: 1px solid var(--accent);
            border-radius: 0.5rem;
            margin-top: 1rem;
        }

        /* New Styles for Dynamic Suggestions Sidebar */
        .suggestions-sidebar {
            position: fixed;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            width: 250px;
            background: rgba(30, 30, 30, 0.9);
            backdrop-filter: blur(5px);
            border-right: 2px solid var(--accent);
            border-top-right-radius: 10px;
            border-bottom-right-radius: 10px;
            padding: 1rem;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.5);
            z-index: 999;
            max-height: 60vh;
            overflow-y: auto;
        }
        .suggestions-sidebar a {
            text-decoration: none;
        }
        .progress-bar-container {
            height: 10px;
            background-color: #333;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--secondary);
            transition: width 0.5s ease-in-out;
        }
        
        /* D3 Skill Tree Container */
        #skill-tree-container {
            width: 100%;
            height: 600px;
            background-color: var(--card-bg);
            border-radius: 0.75rem;
            margin-top: 3rem;
            border: 1px solid var(--border-color);
            overflow: auto; /* Ensure tree is viewable */
        }
        
        /* D3 Node Styles */
        .node circle {
            cursor: pointer;
            fill: #555;
            stroke: var(--secondary);
            stroke-width: 3px;
            transition: all 0.3s;
        }
        .node.completed circle {
            fill: var(--secondary);
            stroke: var(--accent);
        }
        .node text {
            font-family: 'Inter', sans-serif;
            font-size: 10px;
            fill: var(--text-light);
        }
        .link {
            fill: none;
            stroke: #555;
            stroke-width: 1.5px;
            transition: stroke 0.3s;
        }
        .link.completed {
            stroke: var(--secondary);
        }

        /* --- NEW/UPDATED RESPONSIVE LAYOUT STYLES --- */
        
        /* Mobile: Default is stack (col-span-1) */
        .responsive-grid-section {
            display: grid;
            grid-template-columns: repeat(1, minmax(0, 1fr));
            gap: 2rem;
            padding: 0 1rem;
        }

        /* Tablet/Desktop: 2 columns */
        @media (min-width: 768px) {
            .responsive-grid-section {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }
        
        /* Large Desktop: 3 columns for projects/components section */
        @media (min-width: 1024px) {
            /* Applies to the main sections with component cards */
            #basics .responsive-card-grid, 
            #microcontrollers .responsive-card-grid, 
            #sensors .responsive-card-grid {
                grid-template-columns: repeat(4, minmax(0, 1fr)); /* Use Tailwind classes here to maintain consistency */
            }
            #sensors .responsive-card-grid {
                 grid-template-columns: repeat(6, minmax(0, 1fr)); /* 6 columns for dense sensor data */
            }
            #projects .responsive-card-grid {
                 grid-template-columns: repeat(3, minmax(0, 1fr)); 
            }
            
            /* Ensure Microcontrollers uses 4 columns on large screens */
            #microcontrollers .responsive-card-grid {
                 grid-template-columns: repeat(4, minmax(0, 1fr)); 
            }
        }
        
        /* Overriding existing tailwind classes for consistency */
        #basics .grid, #microcontrollers .grid, #sensors .grid, #projects .grid {
            display: grid;
            gap: 2rem;
        }

        /* Mobile Responsive Nav Menu (Auto-Hides) */
        @media (max-width: 768px) {
            .mobile-toggle {
                display: block;
                color: var(--text-light);
            }
            /* FIX: Ensure logo text shrinks on mobile for fit */
            .logo-text {
                font-size: 1.5rem; 
            }
            
            nav ul {
                display: flex; /* Kept display: flex here to enable positioning */
                flex-direction: column;
                width: 100%;
                
                /* FIX: Use fixed position for true overlay */
                position: fixed; 
                top: 65px; 
                left: 0;
                right: 0;
                min-height: calc(100vh - 65px); 
                background: rgba(18, 18, 18, 0.95); 
                backdrop-filter: blur(8px); 
                border-top: 1px solid var(--border-color);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.8);
                
                /* 1. INITIAL HIDE: Move the menu completely off-screen to the left */
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out; /* Use ease-in-out for smooth slide */
                
                overflow-y: auto; 
                z-index: 999; 
                padding-bottom: 2rem; 
            }
            /* 2. SHOW MENU: Only move the menu back into view when the 'active' class is present */
            nav ul.active {
                transform: translateX(0);
            }

            nav ul li {
                width: 100%;
                text-align: center;
                border-bottom: 1px solid var(--border-color); /* Corrected variable name */
            }
            nav ul li:last-child {
                border-bottom: none;
            }
            nav a {
                display: block;
                padding: 1rem 0;
            }
            .user-status {
                display: none;
            }
            .about-content, .contact-container {
                flex-direction: column;
                grid-template-columns: 1fr;
            }
            .hero h1 {
                font-size: 2.2rem;
            }
            
            /* FIX: Project Cards Side-by-Side on Mobile */
            #projects .projects-grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
            
            #cart-modal {
                max-width: 100%; /* Full width on mobile */
            }

            #techwhiz-fab, #cart-fab {
                right: 1rem;
                bottom: 1rem;
                width: 50px;
                height: 50px;
            }

            #cart-fab {
                bottom: 4.5rem; /* 50px + 10px gap */
            }

            #component-detail-content {
                max-width: 100%;
                padding: 1rem;
            }
            .detail-content {
                flex-direction: column;
            }
            .suggestions-sidebar {
                display: none; /* Hide sidebar on mobile for space */
            }
        }
        
        /* Project Detail Modal Fixes for visibility */
        #project-detail-modal {
            background: rgba(0, 0, 0, 0.9);
            /* FIX: Set a high Z-index to ensure it appears instantly and on top of everything */
            z-index: 9999; /* MAXIMUM Z-INDEX */
        }

        #project-detail-content {
            background: var(--card-bg);
            border: 1px solid var(--secondary);
            color: var(--text-light);
            /* Ensure it is scrollable and constrained */
            max-height: 95vh; 
            overflow-y: auto;
        }
        
        /* New Styles for Project Detail Info Tabs */
        .project-detail-tabs button {
            transition: all 0.3s ease;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            color: var(--text-mid);
        }
        .project-detail-tabs button.active {
            border-bottom-color: var(--secondary);
            color: var(--secondary);
        }
        .project-detail-tab-content {
            padding-top: 1rem;
        }

        .close-project-detail {
            color: var(--text-light);
        }
        
        .project-detail-meta {
            color: var(--secondary);
        }

        .project-detail-info {
            color: var(--text-mid);
        }
        
        /* Component Detail Modal Fixes (Targeted for high visibility) */
        .component-detail {
            /* This section is removed as it's now replaced by #component-detail-modal */
            display: none !important;
        }
        
        /* Form input color fix */
        input:not(.razorpay-payment-button), textarea {
            background-color: #333333 !important;
            border-color: #555555 !important;
            color: var(--text-light) !important;
        }

        /* Overriding tailwind classes for text visibility */
        .text-gray-700 {
            color: var(--text-mid);
        }
        .text-black {
            color: var(--text-light);
        }
        .bg-gray-800 {
            background-color: #333 !important;
        }
        .bg-gray-900 {
            background-color: #121212 !important;
        }
        
        /* KaTeX specific style override for dark mode */
        .katex {
            color: var(--secondary);
            font-size: 1.1em;
            vertical-align: middle;
        }

        /* FIX: Center all Modals */
        .modal-overlay-center {
            position: fixed;
            inset: 0;
            display: none; /* Hidden by default */
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            align-items: center; /* Center vertically */
            justify-content: center; /* Center horizontally */
            padding: 1rem;
            z-index: 1005;
            overflow-y: auto; /* Allow scrolling if content is too large */
        }
        
        /* NEW: Image scaling fix for component detail modal */
        #component-detail-content img {
            object-fit: contain; /* Ensures the whole image is visible without cropping */
            max-height: 200px; /* Optional: Constrain max height for better layout on desktop */
        }
    </style>
</head>
<body>
    <header id="main-header"> <!-- Added ID for JS scroll functionality -->
        <div class="container header-container">
            <div class="logo flex items-center">
                <img src="https://lh3.googleusercontent.com/pw/AP1GczMFGvwVU32NSsKv5V5pVdolG2i9-eEUBOupJmE6wvE5hKb08fmmPauG62OnGUmD0esm9pa-d285g6XBzAxuULCghMe8Obxi1mUTI3LcaMuGB0IJz-5-=w2400" alt="INDRA" class="w-12 h-12 rounded-full border-2 border-secondary">
                <div class="logo-text ml-4 glow-text">E-TECH <span>SOLUTIONS</span></div>
            </div>
            <div class="mobile-toggle"><i class="fas fa-bars"></i></div>
            <nav>
                <ul id="nav-menu" class="flex list-none gap-6 text-xl">
                    <li><a href="#home" class="nav-link-3d active mobile-nav-link">Home</a></li>
                    <li><a href="#about" class="nav-link-3d mobile-nav-link">About</a></li>
                    <li><a href="#basics" class="nav-link-3d mobile-nav-link">Basics</a></li>
                    <li><a href="#microcontrollers" class="nav-link-3d mobile-nav-link">Microcontrollers</a></li>
                    <li><a href="#sensors" class="nav-link-3d mobile-nav-link">Sensors</a></li>
                    <li><a href="#courses" class="nav-link-3d mobile-nav-link">Courses</a></li>
                    <li><a href="#projects" class="nav-link-3d mobile-nav-link">Projects</a></li>
                    <li><a href="https://forms.gle/ruvWdt6W2N5QmdRN6" class="nav-link-3d mobile-nav-link">Contact</a></li>
                    <li id="user-nav">
                        <a href="#" id="login-btn-nav" class="nav-link-3d">Login</a>
                        <!-- UPDATED: Added click event to user avatar for profile modal -->
                        <div class="user-status flex items-center hidden" id="user-status">
                            <div id="user-avatar" class="user-avatar w-10 h-10 rounded-lg bg-secondary text-white flex items-center justify-center font-bold cursor-pointer hover:ring-2 ring-accent transition-all"></div>
                            <span id="user-name" class="ml-2"></span>
                            <a href="#" id="logout-btn" class="ml-4 nav-link-3d">Logout</a>
                            <a href="#" id="order-history-btn" class="ml-4 nav-link-3d">Orders</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero" id="home">
        <div class="container">
            <h1>Electronics & Computer Science Projects</h1>
            <p class="mt-4 text-lg text-gray-400 relative z-20">Master electronics and computer science by building real-world projects with our comprehensive learning resources.</p>
            <div class="hero-btns mt-10 relative z-20">
                <a href="#projects" class="btn btn-3d bg-secondary hover:bg-accent text-white font-bold py-3 px-6 rounded-lg transition-all">Explore Projects</a>
                <a href="#courses" class="btn btn-3d border-2 border-secondary text-secondary hover:text-white hover:bg-secondary font-bold py-3 px-6 rounded-lg transition-all ml-4">View Courses</a>
                <a href="https://forms.gle/fgiNbFHnNMYH2QqW8" class="btn btn-3d btn-primary-action btn-box text-white font-bold transition-all ml-4">
                    <i class="fas fa-shopping-cart"></i> Buy Kits
                </a>
            </div>
        </div>
    </section>

    <section class="section" id="about">
        <div class="container">
            <div class="section-title text-center">
                <h2>About Me</h2>
            </div>
            <!-- Using responsive-grid-section for dual column layout on desktop/tablet -->
            <div class="about-content responsive-grid-section items-center justify-center card-3d glassmorphism p-8 neon-border">
                <div class="profile-img transform hover:rotate-3 transition-transform duration-500">
                    <img src="https://lh3.googleusercontent.com/pw/AP1GczMFGvwVU32NSsKv5V5pVdolG2i9-eEUBOupJmE6wvE5hKb08fmmPauG62OnGUmD0esm9pa-d285g6XBzAxuULCghMe8Obxi1mUTI3LcaMuGB0IJz-5-=w2400" alt="INDRA" class="rounded-xl shadow-xl transition-all duration-500 hover:shadow-2xl hover:scale-105 border-4 border-secondary/50">
                </div>
                <div class="profile-info text-center md:text-left">
                    <h3 class="text-3xl font-bold font-orbitron text-white">Hi, I'm INDRA</h3>
                    <p class="mt-4 text-lg text-gray-400">I'm an electronics engineer and educator with over 3 years of experience in the field. My passion is to make electronics and computer science education accessible to everyone, regardless of their background or experience level.</p>
                    <div class="qualifications mt-6">
                        <h4 class="text-xl font-orbitron font-bold text-secondary">Qualifications</h4>
                        <ul class="list-none mt-2 text-gray-400">
                            <li class="flex items-center mt-2"><i class="fas fa-graduation-cap mr-2 text-secondary"></i> DIPLOMA in Electronics And Communication Engineering</li>
                            <li class="flex items-center mt-2"><i class="fas fa-certificate mr-2 text-secondary"></i> Certified IoT Specialist</li>
                            <li class="flex items-center mt-2"><i class="fas fa-briefcase mr-2 text-secondary"></i> 2+ years of industry experience</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="basics">
        <div class="container">
            <div class="section-title text-center">
                <h2>Electronic Basics</h2>
                <p class="text-gray-400">Learn the fundamental components that form the building blocks of all electronic devices</p>
            </div>
            <!-- Skill Tree Visualization Container -->
           
            <!-- End Skill Tree Visualization Container -->

            <!-- UPDATED: Added responsive-card-grid class for fine-grained mobile control -->
            <div class="responsive-card-grid grid grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-8 mt-12">
                <!-- Component Cards (Click to show details instantly in modal) -->
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="resistor" data-concept-id="resistor-basics">
                    <div class="component-icon"><i class="fas fa-bolt"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Resistor</h4>
                    <p class="text-sm mt-2 text-gray-400">Limit and control the flow of electric current</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="capacitor" data-concept-id="capacitor-basics">
                    <div class="component-icon"><i class="fas fa-battery-half"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Capacitor</h4>
                    <p class="text-sm mt-2 text-gray-400">Store and release electrical energy</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="inductor" data-concept-id="inductor-basics">
                    <div class="component-icon"><i class="fas fa-magnet"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Inductor</h4>
                    <p class="text-sm mt-2 text-gray-400">Store energy in a magnetic field</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="diode" data-concept-id="diode-basics">
                    <div class="component-icon"><i class="fas fa-arrow-right"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Diode</h4>
                    <p class="text-sm mt-2 text-gray-400">Allow current to flow in one direction</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="transistor" data-concept-id="transistor-basics">
                    <div class="component-icon"><i class="fas fa-microchip"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Transistor</h4>
                    <p class="text-sm mt-2 text-gray-400">Act as electronic switches or amplifiers</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="ic" data-concept-id="ic-basics">
                    <div class="component-icon"><i class="fas fa-braille"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Integrated Circuit (IC)</h4>
                    <p class="text-sm mt-2 text-gray-400">Miniaturized circuits on a single chip</p>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="microcontrollers">
        <div class="container">
            <div class="section-title text-center">
                <h2>Microcontrollers</h2>
                <p class="text-gray-400">Explore popular microcontroller platforms for embedded systems development</p>
            </div>
            <!-- UPDATED: Added responsive-card-grid class, using 2 columns on mobile, 4 on desktop -->
            <div class="responsive-card-grid grid grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-8">
                <!-- Microcontroller Cards (Click to show details instantly in modal) -->
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="arduino-uno" data-concept-id="mcu-arduino-uno">
                    <div class="component-icon"><i class="fas fa-bolt"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Arduino Uno</h4>
                    <p class="text-sm mt-2 text-gray-400">The most popular Arduino board for beginners</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="arduino-nano" data-concept-id="mcu-arduino-nano">
                    <div class="component-icon"><i class="fas fa-microchip"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Arduino Nano</h4>
                    <p class="text-sm mt-2 text-gray-400">A compact and breadboard-friendly version</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="arduino-mega" data-concept-id="mcu-arduino-mega">
                    <div class="component-icon"><i class="fas fa-list-ol"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Arduino Mega</h4>
                    <p class="text-sm mt-2 text-gray-400">Ideal for complex projects with many I/O pins</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="esp32" data-concept-id="mcu-esp32">
                    <div class="component-icon"><i class="fas fa-wifi"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">ESP32</h4>
                    <p class="text-sm mt-2 text-gray-400">Wi-Fi and Bluetooth enabled MCU</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="raspberrypi" data-concept-id="mcu-rpi-pico">
                    <div class="component-icon"><i class="fas fa-computer"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Raspberry Pi Pico</h4>
                    <p class="text-sm mt-2 text-gray-400">Powerful, low-cost MCU</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="stm32" data-concept-id="mcu-stm32">
                    <div class="component-icon"><i class="fas fa-microchip"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">STM32</h4>
                    <p class="text-sm mt-2 text-gray-400">High-performance ARM-based MCUs</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="avr" data-concept-id="mcu-avr">
                    <div class="component-icon"><i class="fas fa-desktop"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">AVR</h4>
                    <p class="text-sm mt-2 text-gray-400">Used in many hobbyist projects</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="pic" data-concept-id="mcu-pic">
                    <div class="component-icon"><i class="fas fa-gear"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">PIC</h4>
                    <p class="text-sm mt-2 text-gray-400">Simple and reliable MCUs</p>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="sensors">
        <div class="container">
            <div class="section-title text-center">
                <h2>Sensors</h2>
                <p class="text-gray-400">Discover various sensors that enable interaction between the physical and digital worlds</p>
            </div>
            <!-- UPDATED: Added responsive-card-grid class, using 3 columns on mobile, 6 on desktop -->
            <div class="responsive-card-grid grid grid-cols-3 lg:grid-cols-6 xl:grid-cols-6 gap-8">
                <!-- Sensor Cards (Click to show details instantly in modal) -->
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="ultrasonic" data-concept-id="sensor-ultrasonic">
                    <div class="component-icon"><i class="fas fa-wave-square"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Ultrasonic</h4>
                    <p class="text-sm mt-2 text-gray-400">Distance measurement using sound waves</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="pir" data-concept-id="sensor-pir">
                    <div class="component-icon"><i class="fas fa-running"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">PIR Motion</h4>
                    <p class="text-sm mt-2 text-gray-400">Detect human movement in an area</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="temperature" data-concept-id="sensor-temperature">
                    <div class="component-icon"><i class="fas fa-thermometer-half"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Temperature</h4>
                    <p class="text-sm mt-2 text-gray-400">Measure ambient temperature</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="humidity" data-concept-id="sensor-humidity">
                    <div class="component-icon"><i class="fas fa-tint"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Humidity</h4>
                    <p class="text-sm mt-2 text-gray-400">Measure moisture in the air</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="light" data-concept-id="sensor-ldr">
                    <div class="component-icon"><i class="fas fa-lightbulb"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Light (LDR)</h4>
                    <p class="text-sm mt-2 text-gray-400">Measure light intensity</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="gas" data-concept-id="sensor-gas">
                    <div class="component-icon"><i class="fas fa-cloud"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Gas (MQ series)</h4>
                    <p class="text-sm mt-2 text-gray-400">Detect specific gases</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="soilmoisture" data-concept-id="sensor-soil">
                    <div class="component-icon"><i class="fas fa-seedling"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Soil Moisture</h4>
                    <p class="text-sm mt-2 text-gray-400">Check moisture levels in soil</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="rfid" data-concept-id="sensor-rfid">
                    <div class="component-icon"><i class="fas fa-id-card"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">RFID</h4>
                    <p class="text-sm mt-2 text-gray-400">Radio frequency identification technology</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="accelerometer" data-concept-id="sensor-accelerometer">
                    <div class="component-icon"><i class="fas fa-arrows-up-down-left-right"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Accelerometer</h4>
                    <p class="text-sm mt-2 text-gray-400">Measure acceleration and tilt</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="sound" data-concept-id="sensor-sound">
                    <div class="component-icon"><i class="fas fa-volume-up"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Sound</h4>
                    <p class="text-sm mt-2 text-gray-400">Detect and measure sound levels</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="heartbeat" data-concept-id="sensor-heartbeat">
                    <div class="component-icon"><i class="fas fa-heartbeat"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Heartbeat</h4>
                    <p class="text-sm mt-2 text-gray-400">Monitor heart rate and pulse</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="gesture" data-concept-id="sensor-gesture">
                    <div class="component-icon"><i class="fas fa-hand-rock"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Gesture</h4>
                    <p class="text-sm mt-2 text-gray-400">Detect and interpret hand movements</p>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="courses">
        <div class="container">
            <div class="section-title text-center">
                <h2>Our Premium Courses</h2>
                <p class="text-gray-400">Unlock in-depth knowledge and advanced project building with our specialized courses.</p>
            </div>
            <!-- UPDATED: Added responsive-card-grid class, using 1 column on mobile, 3 on desktop -->
            <div class="responsive-card-grid grid grid-cols-1 lg:grid-cols-3 xl:grid-cols-3 gap-8">
                <div class="course-card card-3d glassmorphism p-6 rounded-xl overflow-hidden neon-border">
                    <img src="https://lh3.googleusercontent.com/pw/AP1GczPvtSebwcEAoTS8k-OCNn_xZnUKH5rZXKAI4jLois7jfNsvPT14A1m11ZxNc1OFk6QXgYjp9lHolvmOWD8YnrbuP2acdqCFe_XIolbmvWSOd38hTmc=w2400" alt="Arduino Master" class="rounded-md w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
                    <div class="mt-4">
                        <h3 class="font-orbitron text-2xl font-bold text-white">Arduino Master Class</h3>
                        <p class="text-gray-400 mt-2">Become a master of Arduino programming and hardware. This course covers advanced topics, complex projects, and troubleshooting techniques.</p>
                        <div class="text-2xl font-bold font-orbitron text-accent mt-4">â‚¹ _ _9</div>
                        <a href="https://etechcourse11.netlify.app/" class="btn btn-3d btn-secondary-action disabled py-2 px-4 mt-4 rounded-lg inline-block">AVAILABLE SOON</a>
                    </div>
                </div>
                <div class="course-card card-3d glassmorphism p-6 rounded-xl overflow-hidden neon-border">
                    <img src="https://images.unsplash.com/photo-1517336714731-489689fd1ca8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="AI for Robotics" class="rounded-md w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
                    <div class="mt-4">
                        <h3 class="font-orbitron text-2xl font-bold text-white">AI for Robotics</h3>
                        <p class="text-gray-400 mt-2">Dive into the world of Artificial Intelligence applied to robotics. Learn machine learning fundamentals, computer vision, and robot navigation.</p>
                        <div class="text-2xl font-bold font-orbitron text-accent mt-4">â‚¹ _ _9</div>
                        <a href="https://etechcourse11.netlify.app/" class="btn btn-3d btn-secondary-action disabled py-2 px-4 mt-4 rounded-lg inline-block">AVAILABLE SOON</a>
                    </div>
                </div>
                <div class="course-card card-3d glassmorphism p-6 rounded-xl overflow-hidden neon-border">
                    <img src="https://images.unsplash.com/photo-1550751827-4bd374c3f58b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="IoT Course" class="rounded-md w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
                    <div class="mt-4">
                        <h3 class="font-orbitron text-2xl font-bold text-white">Advanced IoT Development</h3>
                        <p class="text-gray-400 mt-2">Master the Internet of Things with advanced development techniques, cloud integration, data analytics, and security best practices.</p>
                        <div class="text-2xl font-bold font-orbitron text-accent mt-4">â‚¹ _ _9</div>
                        <a href="https://etechcourse11.netlify.app/" class="btn btn-3d btn-secondary-action disabled py-2 px-4 mt-4 rounded-lg inline-block">AVAILABLE SOON</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section" id="projects">
        <div class="container">
            <div class="section-title text-center">
                <h2>Electronics & CSE Projects</h2>
                <p class="text-gray-400">Browse our collection of IoT, Arduino, and Computer Science projects with complete guides and code.</p>
            </div>
            <!-- RECTIFIED: Filter buttons unified to rely solely on JavaScript for active styling -->
            <div class="project-filters flex justify-center flex-wrap gap-4 mb-8">
                <button class="filter-btn btn btn-3d bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-secondary" data-filter="all">All</button>
                <button class="filter-btn btn btn-3d bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-secondary" data-filter="iot">IoT</button>
                <button class="filter-btn btn btn-3d bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-secondary" data-filter="arduino">Arduino</button>
                <button class="filter-btn btn btn-3d bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-secondary" data-filter="cse">Computer Science</button>
            </div>
            <!-- UPDATED: Changed grid-cols-1 to grid-cols-2 for side-by-side mobile project cards -->
            <div class="projects-grid responsive-card-grid grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-8" id="projects-grid">
                <!-- Projects will be dynamically rendered here -->
            </div>
        </div>
    </section>
    
    <section class="section" id="contact">
        <div class="container">
            <div class="section-title text-center">
                <h2>Contact Me</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="contact-info flex flex-col gap-6">
                    <div class="contact-card card-3d glassmorphism p-6 rounded-xl neon-border flex items-center gap-4">
                        <div class="contact-icon w-14 h-14 rounded-lg bg-secondary flex items-center justify-center text-xl text-white"><i class="fas fa-map-marker-alt"></i></div>
                        <div class="contact-text">
                            <h4 class="font-orbitron text-lg font-bold text-white">Location</h4>
                            <p class="text-gray-400">Sri Sathya Sai, India</p>
                        </div>
                    </div>
                    <div class="contact-card card-3d glassmorphism p-6 rounded-xl neon-border flex items-center gap-4">
                        <div class="contact-icon w-14 h-14 rounded-lg bg-secondary flex items-center justify-center text-xl text-white"><i class="fas fa-phone"></i></div>
                        <div class="contact-text">
                            <h4 class="font-orbitron text-lg font-bold text-white">Phone</h4>
                            <p class="text-gray-400">+91 9392090575, +91 9618646604, +91 7619457762</p>
                        </div>
                    </div>
                    <div class="contact-card card-3d glassmorphism p-6 rounded-xl neon-border flex items-center gap-4">
                        <div class="contact-icon w-14 h-14 rounded-lg bg-secondary flex items-center justify-center text-xl text-white"><i class="fas fa-envelope"></i></div>
                        <div class="contact-text">
                            <h4 class="font-orbitron text-lg font-bold text-white">Email</h4>
                            <p class="text-gray-400">etechsolutions9392@gmail.com</p>
                        </div>
                    </div>
                    <div class="contact-card card-3d glassmorphism p-6 rounded-xl neon-border flex items-center gap-4">
                        <div class="contact-icon w-14 h-14 rounded-lg bg-secondary flex items-center justify-center text-xl text-white"><i class="fas fa-globe"></i></div>
                        <div class="contact-text">
                            <h4 class="font-orbitron text-lg font-bold text-white">Website</h4>
                            <p class="text-gray-400">etechsolutions.co.in</p>
                        </div>
                    </div>
                </div>
                <form id="contactForm" class="contact-form glassmorphism p-8 rounded-xl neon-border flex flex-col gap-4">
                    <div class="form-group">
                        <label for="name" class="block mb-2 font-bold text-gray-400">Your Name</label>
                        <input type="text" id="name" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:outline-none focus:border-secondary transition-colors text-white">
                    </div>
                    <div class="form-group">
                        <label for="email" class="block mb-2 font-bold text-gray-400">Email Address</label>
                        <input type="email" id="email" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-4 focus:outline-none focus:border-secondary" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <label for="subject" class="block mb-2 font-bold text-gray-400">Subject</label>
                        <input type="text" id="subject" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-secondary transition-colors">
                    </div>
                    <div class="form-group">
                        <label for="message" class="block mb-2 font-bold text-gray-400">Message</label>
                        <textarea id="message" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:outline-none focus:border-secondary transition-colors text-white"></textarea>
                    </div>
                    <button type="submit" class="btn btn-3d btn-primary-action btn-box w-full mt-4">Send Message</button>
                </form>
            </div>
        </div>
    </section>

    <footer class="bg-card-bg p-8 border-t border-border-color">
        <div class="container">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="footer-col">
                    <h4 class="font-orbitron text-xl font-bold text-white">E-TECH SOLUTIONS</h4>
                    <p class="text-sm mt-4 text-gray-400">Providing high-quality e-learning resources for electronics enthusiasts and students worldwide.</p>
                    <div class="social-links flex gap-4 mt-4">
                        <a href="https://www.facebook.com/share/1YqHbBfq8W/" class="w-10 h-10 rounded-lg bg-border-color text-gray-400 flex items-center justify-center hover:bg-secondary hover:text-white transition-colors"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.instagram.com/e_techsolutions_?igsh=am0wa3ZoY2c5ZDE=" class="w-10 h-10 rounded-lg bg-border-color text-gray-400 flex items-center justify-center hover:bg-accent hover:text-white transition-colors"><i class="fab fab fa-instagram"></i></a>
                        <a href="https://youtube.com/@e-techsolutions-techwhiz?si=rWXLsO87Y93k34dF" class="w-10 h-10 rounded-lg bg-border-color text-gray-400 flex items-center justify-center hover:bg-red-600 hover:text-white transition-colors"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4 class="font-orbitron text-lg font-bold text-white">Learning Resources</h4>
                    <ul class="list-none mt-4 text-gray-400">
                        <li><a href="#basics" class="hover:text-secondary transition-colors">Electronics Basics</a></li>
                        <li><a href="#microcontrollers" class="hover:text-secondary transition-colors">Microcontrollers</a></li>
                        <li><a href="#sensors" class="hover:text-secondary transition-colors">Sensors</a></li>
                        <li><a href="#courses" class="hover:text-secondary transition-colors">Courses</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="font-orbitron text-lg font-bold text-white">Quick Links</h4>
                    <ul class="list-none mt-4 text-gray-400">
                        <li><a href="#home" class="hover:text-secondary transition-colors">Home</a></li>
                        <li><a href="#about" class="hover:text-secondary transition-colors">About</a></li>
                        <li><a href="#projects" class="hover:text-secondary transition-colors">Projects</a></li>
                        <li><a href="https://forms.gle/ruvWdt6W2N5QmdRN6" class="hover:text-secondary transition-colors">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="font-orbitron text-lg font-bold text-white">Newsletter</h4>
                    <p class="text-sm mt-4 text-gray-400">Subscribe for the latest tutorials and project ideas.</p>
                    <form>
                        <input type="email" placeholder="Your Email Address" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:outline-none focus:border-secondary transition-colors mt-4 text-white">
                        <a href="https://forms.gle/ruvWdt6W2N5QmdRN6"><button type="submit" class="btn btn-3d btn-primary-action btn-box w-full mt-4">Subscribe</button></a>
                    </form>
                </div>
            </div>
            <div class="text-center mt-8 text-gray-500 text-sm border-t border-border-color pt-6">
                &copy; 2025 E-TECH SOLUTIONS. All Rights Reserved.
            </div>
        </div>
    </footer>

   
    <!-- Chatbot Button (Z-index 1001, bottom: 2rem) -->
    <button id="techwhiz-fab" class="btn btn-3d fixed w-16 h-16 flex items-center justify-center text-3xl text-white focus:outline-none focus:ring-4 focus:ring-secondary/50" style="background: linear-gradient(145deg, var(--secondary), var(--accent));">
        <i class="fas fa-robot"></i>
    </button>
    
    <!-- Floating Cart Button (Z-index 1002, bottom: 6rem, above TechWhiz) -->
    <button id="cart-fab" class="fixed text-xl text-white focus:outline-none">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count">0</span>
    </button>
    
    <!-- Cart Modal (Advanced Floating Panel) -->
    <div id="cart-modal">
        <div class="cart-header">
            <h3 class="text-white">Your Cart (<span id="cart-item-count-header">0</span>)</h3>
            <button id="close-cart-btn" class="text-white hover:text-accent">&times;</button>
        </div>
        <div id="cart-modal-items" class="bg-card-bg">
            <p class="cart-empty-msg text-gray-400 text-center p-8">Your cart is currently empty. Start exploring projects!</p>
        </div>
        <div class="cart-footer bg-card-bg">
            <div class="cart-total-display">
                <span class="text-white">Total:</span>
                <span id="cart-total-price">â‚¹0</span>
            </div>
            <button id="cart-checkout-btn" class="btn btn-3d btn-primary-action btn-box w-full">Proceed to Checkout</button>
        </div>
    </div>
    
    <!-- Component Detail MODAL (Overlay component details here) -->
    <div id="component-detail-modal">
        <div id="component-detail-content" class="glassmorphism p-8 rounded-xl relative">
            <div class="detail-header flex justify-between items-center">
                <h3 class="font-orbitron text-2xl font-bold text-secondary" id="detail-title">Component Details</h3>
                <button class="close-detail absolute top-4 right-4 text-4xl text-gray-400 hover:text-accent transition-colors">&times;</button>
            </div>
            <div class="detail-content flex flex-col md:flex-row gap-8 mt-6">
                <!-- IMPORTANT: Removed object-cover and set max-height to 200px in CSS class above for object-fit: contain -->
                <img id="detail-img" src="https://via.placeholder.com/400x300" alt="Component" class="rounded-lg shadow-lg w-full md:w-1/3 object-cover border-2 border-secondary/50">
                <div class="detail-info flex-1">
                    <h4 class="font-bold text-lg text-secondary">Definition</h4>
                    <p id="detail-definition" class="text-gray-400"></p>
                    <h4 class="font-bold text-lg text-secondary mt-4">Symbol</h4>
                    <div id="detail-symbol" class="text-gray-400 p-2 border border-border-color rounded-lg mt-1"></div>
                    <!-- NEW: Sensor Visualization Container (only visible for sensor types) -->
                    <div id="sensor-visualization-area" class="mt-4 hidden">
                         <h4 class="font-bold text-lg text-accent">Live Data Mock-up</h4>
                         <canvas id="sensor-viz-canvas"></canvas>
                         <p id="sensor-data-readout" class="text-sm text-gray-500 mt-1 italic">Status: Idle</p>
                    </div>
                    <!-- END: Sensor Visualization Container -->
                    <h4 class="font-bold text-lg text-secondary mt-4">Characteristics</h4>
                    <ul id="detail-characteristics" class="list-disc ml-6 text-gray-400"></ul>
                    <h4 class="font-bold text-lg text-secondary mt-4">Applications</h4>
                    <p id="detail-applications" class="text-gray-400"></p>
                </div>
            </div>
            <div class="mt-8">
                <button id="ask-techwhiz-component-btn" class="btn btn-3d btn-secondary-action btn-box w-full">
                    <i class="fas fa-robot mr-2"></i> Ask TechWhiz About This Component
                </button>
            </div>
        </div>
    </div>
    <!-- END: Component Detail MODAL -->
    
    <!-- Chatbox Modal -->
    <div id="techwhiz-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-4 z-50">
        <div id="assistant-chat-modal-content" class="rounded-lg shadow-2xl max-w-lg w-full bg-gray-900 border border-secondary/20">
            <div class="sticky top-0 bg-gray-800 p-4 border-b border-gray-700 flex justify-between items-center rounded-t-lg">
                <h3 class="text-xl font-bold text-white"><i class="fas fa-robot mr-3 text-secondary"></i>TECHWHIZ Assistant</h3>
                <button id="close-techwhiz-modal" class="text-gray-400 hover:text-white text-4xl leading-none">&times;</button>
            </div>
            <div id="chat-history" class="p-4 overflow-y-auto h-[400px] flex flex-col-reverse gap-3">
                <div class="chat-message assistant p-3 rounded-lg rounded-bl-none self-start mr-auto bg-gray-800 text-white" style="font-size:15px; font-weight:normal; padding:10px; border-radius:10px; margin-right:auto;">Hello! How can I help you today with electronics and CSE concepts?</div>
            </div>
            <div class="p-4 border-t border-gray-700 bg-gray-900">
                <div class="flex items-center space-x-2">
                    <input type="text" id="techwhiz-input" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-secondary transition-colors" placeholder="Ask me anything...">
                    <button id="mic-btn" class="btn btn-3d bg-secondary hover:bg-accent text-white py-3 px-4 rounded-lg"><i class="fas fa-microphone"></i></button>
                    <button id="send-btn" class="btn btn-3d bg-secondary hover:bg-accent text-white py-3 px-4 rounded-lg"><i class="fas fa-paper-plane"></i></button>
                </div>
                <div class="flex justify-between items-center mt-3">
                    <button id="stop-speech-btn" class="btn bg-accent hover:bg-red-700 py-2 px-4 rounded-lg text-sm">
                        <i class="fas fa-volume-mute mr-2"></i>Stop Voice Output
                    </button>
                    <span id="listening-status" class="text-sm text-gray-500 italic hidden">Listening...</span>
                    <span id="thinking-status" class="text-sm text-secondary italic hidden">Thinking...</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <!-- UPDATED: Added modal-overlay-center class -->
    <div id="auth-modal" class="modal-overlay-center">
        <!-- LOGIN MODAL CONTAINER - Centered via items-center and justify-center -->
        <div class="bg-gray-900 rounded-lg shadow-2xl p-8 max-w-md w-full border border-secondary/20">
            <div class="flex justify-end"><button class="close-auth text-3xl text-gray-400 hover:text-white">&times;</button></div>
            <div class="auth-tabs flex justify-around mb-6 border-b border-gray-700">
                <div class="auth-tab text-xl font-bold py-2 px-4 cursor-pointer text-secondary active" data-tab="login">Login</div>
                <div class="auth-tab text-xl font-bold py-2 px-4 cursor-pointer text-gray-400" data-tab="register">Register</div>
            </div>
            <!-- Login Form -->
            <form id="login-form" class="auth-form">
                <input type="email" id="login-email" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-4 focus:outline-none focus:border-secondary" placeholder="Email" required>
                <input type="password" id="login-password" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-6 focus:outline-none focus:border-secondary" placeholder="Password" required>
                <button type="submit" class="btn btn-3d btn-primary-action btn-box w-full">Login</button>
            </form>
            
            <!-- Register Form -->
            <form id="register-form" class="auth-form hidden">
                <input type="text" id="register-name" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-4 focus:outline-none focus:border-secondary" placeholder="Full Name" required>
                <input type="email" id="register-email" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-4 focus:outline-none focus:border-secondary" placeholder="Email" required>
                <input type="password" id="register-password" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-6 focus:outline-none focus:border-secondary" placeholder="Password" required>
                <button type="submit" class="btn btn-3d btn-primary-action btn-box w-full">Register</button>
            </form>

            <!-- Social Login Options -->
            <div class="mt-6 text-center">
                <p class="text-gray-400 mb-4">Or login with:</p>
                <div class="flex justify-center gap-4">
                    <button id="google-login-btn" class="btn btn-3d bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg flex items-center gap-2">
                        <i class="fab fa-google"></i> Google
                    </button>
                    <button id="github-login-btn" class="btn btn-3d bg-gray-800 hover:bg-secondary text-white py-2 px-4 rounded-lg flex items-center gap-2">
                        <i class="fab fa-github"></i> GitHub
                    </button>
                </div>
        </div>
    </div>

    <!-- Order History Modal -->
    <!-- UPDATED: Added modal-overlay-center class -->
    <div id="order-history-modal" class="modal-overlay-center">
        <div class="bg-gray-900 rounded-lg shadow-2xl p-8 max-w-lg w-full border border-secondary/20">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold font-orbitron text-secondary">Your Order History</h2>
                <button class="close-history text-3xl text-gray-400 hover:text-white">&times;</button>
            </div>
            <div id="order-history-list" class="mt-6 h-[400px] overflow-y-auto">
                <p class="text-center text-gray-500">You have no past orders.</p>
            </div>
        </div>
    </div>
    
    <!-- NEW: Profile Management Modal -->
    <!-- UPDATED: Added modal-overlay-center class -->
    <div id="profile-modal" class="modal-overlay-center">
        <div class="bg-gray-900 rounded-lg shadow-2xl p-8 max-w-xl w-full border border-accent/20">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold font-orbitron text-accent"><i class="fas fa-user-cog mr-2"></i> User Profile & Settings</h2>
                <button id="close-profile-btn" class="text-3xl text-gray-400 hover:text-white">&times;</button>
            </div>
            
            <div class="mt-6 grid grid-cols-1 gap-6"> <!-- CHANGED: Removed unnecessary md:grid-cols-2 -->
                <!-- User Info -->
                <div class="glassmorphism p-4 rounded-lg border border-border-color">
                    <h3 class="text-xl font-bold text-secondary mb-3">Account Details</h3>
                    <p class="text-gray-400"><strong>Display Name:</strong> <span id="profile-display-name" class="text-white"></span></p>
                    <p class="text-gray-400"><strong>Email:</strong> <span id="profile-email" class="text-white"></span></p>
                    <p class="text-gray-400"><strong>User ID:</strong> <span id="profile-user-id" class="text-xs text-accent break-all"></span></p>
                    <button id="edit-profile-btn" class="btn btn-3d btn-secondary-action py-2 px-4 mt-4 w-full">Edit Name</button>
                </div>
                
            </div> <!-- CHANGED: Removed Project List Section here -->
            
            <div class="mt-6 border-t border-border-color pt-6 text-center">
                 <button id="profile-logout-btn" class="btn btn-3d bg-red-600 hover:bg-red-700 text-white py-2 px-6 rounded-lg">Sign Out</button>
            </div>
        </div>
    </div>
    <!-- END: Profile Management Modal -->


    <!-- Project Detail Modal (FIXED: Ensuring immediate display on click) -->
    <!-- NOTE: #project-detail-modal Z-index is 9999 for maximum priority -->
    <div id="project-detail-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-4" style="z-index: 9999;">
        <div id="project-detail-content" class="glassmorphism p-8 rounded-xl max-w-3xl w-full relative">
            <button class="close-project-detail absolute top-4 right-4 text-4xl text-white hover:text-secondary">&times;</button>
            <div class="text-xl font-orbitron font-bold text-secondary mb-3">E-TECH SOLUTIONS Project Details</div>
            
            <!-- Project Image & Quick Info -->
            <div class="flex flex-col md:flex-row gap-6">
                <img id="project-detail-image" src="" alt="Project Image" class="rounded-lg w-full md:w-1/3 h-48 object-cover border-2 border-secondary/50">
                <div class="flex-1">
                    <h3 class="text-3xl font-orbitron font-bold text-white" id="project-detail-title"></h3>
                    <div class="project-detail-meta flex flex-wrap gap-4 text-sm mt-2">
                        <span id="project-detail-time" class="text-white"><i class="fas fa-clock text-secondary"></i></span>
                        <span id="project-detail-chip" class="text-white"><i class="fas fa-microchip text-secondary"></i></span>
                        <span id="project-detail-theme" class="text-white"><i class="fas fa-lightbulb text-secondary"></i> Theme: <span id="theme-value">N/A</span></span>
                    </div>
                    <p class="mt-4 text-gray-400" id="project-detail-description"></p>
                </div>
            </div>
            
            <!-- NEW: Tabbed Content for Detailed Information -->
            <div class="mt-6">
                 <div class="project-detail-tabs flex border-b border-border-color gap-4 overflow-x-auto">
                    <button class="py-2 px-1 text-base active" data-tab-target="#tab-details">Details & Aim</button>
                    <button class="py-2 px-1 text-base" data-tab-target="#tab-features">Features & Uses</button>
                    <button class="py-2 px-1 text-base" data-tab-target="#tab-requirements">Requirements</button>
                    <button id="ask-techwhiz-detail-btn-tab" class="py-2 px-1 text-base text-accent hover:text-secondary" data-tab-target="#tab-techwhiz">Ask TechWhiz</button>
                 </div>
                 
                 <div id="project-detail-tab-wrapper" class="project-detail-tab-content">
                    <!-- Tab 1: Details & Aim -->
                    <div id="tab-details" data-tab-content class="active">
                        <h4 class="text-xl font-bold text-secondary mt-4">Project Aim</h4>
                        <p id="project-detail-aim" class="text-gray-400 mt-2 italic"></p>
                        
                        <h4 class="text-xl font-bold text-secondary mt-4">Applications & Uses</h4>
                        <ul class="list-disc ml-6 mt-2 text-gray-400" id="project-detail-applications"><li>N/A</li></ul>
                        
                        <h4 class="text-xl font-bold text-secondary mt-4">E-TECH Advantages</h4>
                        <ul class="list-disc ml-6 mt-2 text-gray-400" id="project-detail-advantages"><li>N/A</li></ul>
                        
                        <!-- NEW: Sensor View Section (Hidden if no relevant sensors) -->
                        <div id="project-sensor-view" class="mt-6 p-4 rounded-lg glassmorphism hidden">
                            <h4 class="text-xl font-bold text-accent"><i class="fas fa-satellite-dish mr-2"></i> Sensor View (Data Flow)</h4>
                            <ul class="flex flex-wrap gap-3 mt-3" id="project-detail-sensors-used"></ul>
                        </div>
                    </div>
                    
                    <!-- Tab 2: Key Features -->
                    <div id="tab-features" data-tab-content class="hidden">
                        <h4 class="text-xl font-bold text-secondary mt-4">Key Features</h4>
                        <ul class="list-disc ml-6 mt-2 text-gray-400" id="project-detail-features"><li>N/A</li></ul>
                    </div>
                    
                    <!-- Tab 3: Requirements -->
                    <div id="tab-requirements" data-tab-content class="hidden">
                         <h4 class="text-xl font-bold text-secondary mt-4">Required Components</h4>
                        <ul class="list-disc ml-6 mt-2 text-gray-400" id="project-detail-components"><li>N/A</li></ul>
                    </div>
                    
                    <!-- Tab 4: AI Summary / TechWhiz Interaction -->
                    <div id="tab-techwhiz" data-tab-content class="hidden">
                        <h4 class="text-xl font-bold text-secondary mt-4">AI-Powered Overview</h4>
                        <button id="ai-summary-btn" class="btn btn-3d bg-accent text-white py-2 px-4 rounded-lg mt-2 w-full">AI-Powered Summary âœ¨</button>
                        <div id="ai-summary-container" class="glassmorphism p-4 mt-4 rounded-lg border border-accent/50">
                            <p id="ai-summary-text" class="text-sm italic text-gray-400">Click the button above for an intelligent summary...</p>
                        </div>
                        
                        <h4 class="text-xl font-bold text-secondary mt-6">Expert Q&A</h4>
                        <button id="ask-techwhiz-detail-btn" class="btn btn-3d btn-secondary-action btn-box w-full mt-2">
                             <i class="fas fa-robot mr-2"></i> Ask TechWhiz About This Project
                        </button>
                    </div>
                 </div>
            </div>

                <!-- Action Buttons: Buy Now and Add to Cart -->
                <div class="mt-8 flex gap-4 justify-between">
                    <a id="buy-now-from-detail" target="_blank" class="btn btn-3d btn-buy-now btn-box flex-1 text-lg">
                        <i class="fas fa-bolt mr-2"></i> Buy Kit Now
                    </a>
                    <button id="add-to-cart-from-detail" class="btn btn-3d btn-primary-action btn-box flex-1 text-lg">
                        <i class="fas fa-cart-plus mr-2"></i> Add to Cart
                    </button>
                </div>
                
                <button id="simulator-placeholder-btn" class="btn btn-3d bg-purple-700 hover:bg-purple-800 text-white py-2 px-4 rounded-lg mt-4 w-full">
                    <i class="fas fa-microchip mr-2"></i> Embedded Circuit Simulator (Coming Soon)
                </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Firebase Config & Setup ---
            const __app_id = "default-app-id";
            const __firebase_config = '{"apiKey": "AIzaSyCyk9Jg_FW7jbVFh5XasK1Vb8_sP8J4zSE", "authDomain": "etech-d39e5.firebaseapp.com", "projectId": "etech-d39e5", "storageBucket": "etech-d39e5.firebasestorage.app", "messagingSenderId": "323388421053", "appId": "1:323388421053:web:9057d22d4ee4b7450398d4", "measurementId": "G-EV7M78EBGC"}';
            
            const firebaseConfig = JSON.parse(__firebase_config);
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const db = firebase.firestore();
            firebase.firestore.setLogLevel('debug');

            // --- UI Elements ---
            const mainHeader = document.getElementById('main-header'); // Get the main header
            const authModal = document.getElementById('auth-modal');
            const loginBtnNav = document.getElementById('login-btn-nav');
            const closeAuthBtn = document.querySelector('.close-auth');
            const authTabs = document.querySelectorAll('.auth-tab');
            const authForms = document.querySelectorAll('.auth-form');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const googleLoginBtn = document.getElementById('google-login-btn');
            const userStatus = document.getElementById('user-status');
            const userAvatar = document.getElementById('user-avatar');
            const userName = document.getElementById('user-name');
            const logoutBtn = document.getElementById('logout-btn');
            const mobileToggle = document.querySelector('.mobile-toggle');
            const navMenu = document.getElementById('nav-menu');
            // NEW: Select all mobile nav links
            const mobileNavLinks = document.querySelectorAll('.mobile-nav-link'); 
            const techwhizFab = document.getElementById('techwhiz-fab');
            const techwhizModal = document.getElementById('techwhiz-modal');
            const closeTechwhizModalBtn = document.getElementById('close-techwhiz-modal');
            const chatHistory = document.getElementById('chat-history');
            const techwhizInput = document.getElementById('techwhiz-input');
            const micBtn = document.getElementById('mic-btn');
            const sendBtn = document.getElementById('send-btn');
            const stopSpeechBtn = document.getElementById('stop-speech-btn');
            const listeningStatus = document.getElementById('listening-status');
            const thinkingStatus = document.getElementById('thinking-status');
            const orderHistoryBtn = document.getElementById('order-history-btn');
            const orderHistoryModal = document.getElementById('order-history-modal');
            const closeHistoryBtn = document.querySelector('.close-history');
            const orderHistoryList = document.getElementById('order-history-list');
            const projectsGrid = document.getElementById('projects-grid');
            const filterBtns = document.querySelectorAll('.filter-btn');
            const projectDetailModal = document.getElementById('project-detail-modal');
            const closeProjectDetailBtn = document.querySelector('.close-project-detail');
            const projectDetailTitle = document.getElementById('project-detail-title');
            const projectDetailImage = document.getElementById('project-detail-image');
            const projectDetailDescription = document.getElementById('project-detail-description');
            const projectDetailTime = document.getElementById('project-detail-time');
            const projectDetailChip = document.getElementById('project-detail-chip');
            const projectDetailFeatures = document.getElementById('project-detail-features');
            const projectDetailComponents = document.getElementById('project-detail-components');
            
            // --- NEW Project Detail Elements ---
            const projectDetailApplications = document.getElementById('project-detail-applications');
            const projectDetailAdvantages = document.getElementById('project-detail-advantages');
            const projectDetailAim = document.getElementById('project-detail-aim'); // NEW
            const projectDetailThemeValue = document.getElementById('theme-value'); // NEW
            const projectSensorView = document.getElementById('project-sensor-view');
            const projectDetailSensorsUsed = document.getElementById('project-detail-sensors-used');

            const addToCartFromDetailBtn = document.getElementById('add-to-cart-from-detail');
            const buyNowFromDetailBtn = document.getElementById('buy-now-from-detail'); 
            
            const aiSummaryBtn = document.getElementById('ai-summary-btn');
            const aiSummaryContainer = document.getElementById('ai-summary-container');
            const aiSummaryText = document.getElementById('ai-summary-text');
            const simulatorPlaceholderBtn = document.getElementById('simulator-placeholder-btn');
            
            // NEW: Project Detail Tabs
            const projectDetailTabBtns = document.querySelectorAll('.project-detail-tabs button');
            const projectDetailTabWrapper = document.getElementById('project-detail-tab-wrapper');
            const askTechwhizDetailBtn = document.getElementById('ask-techwhiz-detail-btn'); // Button in the content pane
            const askTechwhizDetailBtnTab = document.getElementById('ask-techwhiz-detail-btn-tab'); // Button in the tab bar


            // --- Component Detail Modal Elements ---
            const componentCards = document.querySelectorAll('.component-card');
            const componentDetailModal = document.getElementById('component-detail-modal');
            const detailTitle = document.getElementById('detail-title');
            const detailImg = document.getElementById('detail-img');
            const detailDefinition = document.getElementById('detail-definition');
            const detailSymbol = document.getElementById('detail-symbol');
            const detailCharacteristics = document.getElementById('detail-characteristics');
            const detailApplications = document.getElementById('detail-applications');
            const closeDetailBtn = document.querySelector('#component-detail-modal .close-detail');
            const askTechwhizComponentBtn = document.getElementById('ask-techwhiz-component-btn');
            // NEW Sensor Visualization elements
            const sensorVizArea = document.getElementById('sensor-visualization-area');
            const sensorVizCanvas = document.getElementById('sensor-viz-canvas');
            const sensorDataReadout = document.getElementById('sensor-data-readout');
            let sensorVizInterval = null; // To hold the setInterval reference
            
            // --- Cart Elements ---
            const cartFab = document.getElementById('cart-fab');
            const cartModal = document.getElementById('cart-modal');
            const closeCartBtn = document.getElementById('close-cart-btn');
            const cartModalItemsContainer = document.getElementById('cart-modal-items');
            const cartTotalPriceElement = document.getElementById('cart-total-price');
            const cartCountElement = document.getElementById('cart-count');
            const cartItemCountHeader = document.getElementById('cart-item-count-header');
            const cartCheckoutBtn = document.getElementById('cart-checkout-btn');

            // --- Profile Modal Elements ---
            const profileModal = document.getElementById('profile-modal');
            const closeProfileBtn = document.getElementById('close-profile-btn');
            const profileDisplayName = document.getElementById('profile-display-name');
            const profileEmail = document.getElementById('profile-email');
            const profileUserId = document.getElementById('profile-user-id');
            const editProfileBtn = document.getElementById('edit-profile-btn');
            const profileLogoutBtn = document.getElementById('profile-logout-btn');
            const profileConceptsCount = document.getElementById('profile-concepts-count');
            const profileProjectsCount = document.getElementById('profile-projects-count');
            const profileOverallProgressBar = document.getElementById('profile-overall-progress-bar');
            
            // --- Progress Elements ---
            const suggestionsSidebar = document.querySelector('.suggestions-sidebar');
            const dynamicSuggestionsContent = document.getElementById('dynamic-suggestions-content');
            const overallProgressBar = document.getElementById('overall-progress-bar');
            const progressPercentage = document.getElementById('progress-percentage');
            
            let cart = [];
            let userProgress = {}; // Stores { conceptId: true/false }
            let allConcepts = []; // Array of all concepts from Skill Tree data
            let userId = null;
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
            const progressCollectionPath = () => `artifacts/${appId}/users/${userId}/progress`;

            // --- Skill Tree Data Structure (Unchanged) ---
            const skillTreeData = {
                id: "root",
                name: "E-TECH Path",
                children: [
                    {
                        id: "level1-basics",
                        name: "Level 1: Electronics Fundamentals",
                        children: [
                            { id: "resistor-basics", name: "Resistor", type: "concept" },
                            { id: "capacitor-basics", name: "Capacitor", type: "concept", parentId: "resistor-basics" },
                            { id: "diode-basics", name: "Diode", type: "concept", parentId: "capacitor-basics" },
                            { id: "project-blinking-led", name: "Project: Blinking LED", type: "project", parentId: "diode-basics" }
                        ]
                    },
                    {
                        id: "level2-microcontrollers",
                        name: "Level 2: MCUs & Logic",
                        parentId: "project-blinking-led",
                        children: [
                            { id: "mcu-arduino-uno", name: "Arduino Uno", type: "concept" },
                            { id: "transistor-basics", name: "Transistor", type: "concept", parentId: "mcu-arduino-uno" },
                            { id: "project-traffic-light", name: "Project: Traffic Light", type: "project", parentId: "transistor-basics" },
                            { id: "mcu-esp32", name: "ESP32 & WiFi", type: "concept", parentId: "project-traffic-light" }
                        ]
                    },
                    {
                         id: "level3-sensing",
                         name: "Level 3: Sensing & IoT",
                         parentId: "mcu-esp32",
                         children: [
                             { id: "sensor-ultrasonic", name: "Ultrasonic Sensor", type: "concept" },
                             { id: "sensor-pir", name: "PIR Motion Sensor", type: "concept" },
                             { id: "project-smart-alarm", name: "Project: Smart Alarm", type: "project", parentId: "sensor-ultrasonic" },
                             { id: "project-smart-alarm-iot", name: "Project: IoT Alarm", type: "project", parentId: "project-smart-alarm" }
                         ]
                    }
                ]
            };
            
            function extractAllConcepts(node) {
                if (node.type === 'concept' || node.type === 'project') {
                    allConcepts.push(node.id);
                }
                if (node.children) {
                    node.children.forEach(extractAllConcepts);
                }
            }
            extractAllConcepts(skillTreeData);
            const totalConcepts = allConcepts.length;
            
            // --- D3.js Skill Tree Rendering (Unchanged) ---
            function renderSkillTree(progress) {
                const container = document.getElementById('skill-tree-container');
                container.innerHTML = ''; // Clear previous tree
                
                const width = container.clientWidth;
                const height = 600;
                
                const svg = d3.select("#skill-tree-container").append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .attr("viewBox", `0 0 ${width} ${height}`)
                    .style("overflow", "visible")
                    .append("g")
                    .attr("transform", `translate(40, 0)`); // Shift tree right for nodes

                const treeLayout = d3.tree()
                    .size([height, width - 160]); // Size of the drawing area

                // Define links based on parentId for non-nested children
                function restructureData(data) {
                    const nodesMap = new Map();
                    const process = (node) => {
                        nodesMap.set(node.id, node);
                        if (node.children) {
                            node.children.forEach(process);
                        }
                    };
                    process(data);

                    // Manually assign children based on parentId fields
                    const rootNode = nodesMap.get("root");
                    const level1 = rootNode.children[0];
                    const level2 = rootNode.children[1];
                    const level3 = rootNode.children[2];
                    
                    // Clear default hierarchy structure for flat/linear linking
                    rootNode.children = [level1, level2, level3]; 

                    // Define sequential links within levels
                    level1.children[0].children = [level1.children[1]]; // Resistor -> Capacitor
                    level1.children[1].children = [level1.children[2]]; // Capacitor -> Diode
                    level1.children[2].children = [level1.children[3]]; // Diode -> Blinking LED

                    level2.children[0].children = [level2.children[1]]; // Arduino Uno -> Transistor
                    level2.children[1].children = [level2.children[2]]; // Transistor -> Traffic Light
                    level2.children[2].children = [level2.children[3]]; // Traffic Light -> ESP32

                    level3.children[0].children = [level3.children[2]]; // Ultrasonic -> Smart Alarm
                    level3.children[1].children = []; // PIR is a parallel path
                    level3.children[2].children = [level3.children[3]]; // Smart Alarm -> IoT Alarm
                    
                    // Link between levels
                    level1.children[3].children = [level2]; // Blinking LED -> Level 2
                    level2.children[3].children = [level3]; // ESP32 -> Level 3

                    return d3.hierarchy(rootNode);
                }

                const root = restructureData(JSON.parse(JSON.stringify(skillTreeData))); // Deep clone for modification
                
                // Set custom node depths for better horizontal flow
                root.each(d => {
                    const nodesMap = new Map(root.descendants().map(d => [d.data.id, d]));
                    if (d.data.id.includes('level1')) d.depth = 1;
                    else if (d.data.id.includes('level2')) d.depth = 2;
                    else if (d.data.id.includes('level3')) d.depth = 3;
                    else if (d.data.parentId && nodesMap.get(d.data.parentId)) {
                        d.depth = nodesMap.get(d.data.parentId).depth + 1;
                    } else if (d.data.parentId) {
                         // Fallback for nodes like 'resistor-basics' that are first in their level
                        d.depth = d.data.id.includes('basics') ? 2 : (d.data.id.includes('mcu') ? 3 : 4);
                    }
                });

                treeLayout(root);

                const nodesMap = new Map(root.descendants().map(d => [d.data.id, d]));

                // 1. Draw Links
                const link = svg.selectAll(".link")
                    .data(root.links())
                    .enter().append("path")
                    .attr("class", d => `link ${progress[d.target.data.parentId] ? 'completed' : ''}`)
                    .attr("d", d3.linkHorizontal()
                        .x(d => d.y)
                        .y(d => d.x)
                    );

                // 2. Draw Nodes
                const node = svg.selectAll(".node")
                    .data(root.descendants())
                    .enter().append("g")
                    .attr("class", d => `node ${d.children ? 'internal' : 'leaf'} ${progress[d.data.id] ? 'completed' : ''}`)
                    .attr("transform", d => `translate(${d.y},${d.x})`);

                // Add circles
                node.append("circle")
                    .attr("r", d => d.data.id === 'root' ? 0 : (d.children ? 6 : 10))
                    .attr("stroke-width", d => d.data.id === 'root' ? 0 : 3)
                    .on("click", (event, d) => {
                        if (d.data.type === 'concept' || d.data.type === 'project') {
                             handleConceptClick(d.data.id, progress);
                        }
                    })
                    .on("mouseover", function(event, d) {
                        d3.select(this).attr('r', d.children ? 8 : 12).style("fill", varFromTailwind('--accent'));
                        showToast(d.data.name + (progress[d.data.id] ? ' (Completed)' : ' (Pending)'), 'secondary');
                    })
                    .on("mouseout", function(event, d) {
                        d3.select(this).attr('r', d.children ? 6 : 10).style("fill", progress[d.data.id] ? varFromTailwind('--secondary') : '#555');
                    });

                // Add text labels
                node.append("text")
                    .attr("dy", d => d.children ? 20 : 15)
                    .attr("text-anchor", "middle")
                    .text(d => d.data.name)
                    .style("fill", varFromTailwind('--text-light'));
                    
                // Add icons for completed nodes
                node.filter(d => progress[d.data.id] && (d.data.type === 'concept' || d.data.type === 'project'))
                    .append("text")
                    .attr("dy", 4)
                    .attr("text-anchor", "middle")
                    .attr("class", "fas text-lg")
                    .style("font-family", "FontAwesome")
                    .style("fill", varFromTailwind('--primary'))
                    .text('\uf058'); // Checkmark icon
            }

            function handleConceptClick(conceptId, progress) {
                 if (userId) {
                    if (progress[conceptId]) {
                        showToast(`${conceptId} already completed!`, 'secondary');
                    } else {
                        // Check dependencies (simplified mock check)
                        let isDependencyComplete = true;
                        // Simplified check: allow completion if a dependency is marked as 'completed'
                        // In a real app, this would require traversing the dependency chain.
                        // For the purpose of this demo, we'll keep the mock simple.
                        
                        if (isDependencyComplete) {
                            toggleConceptCompletion(conceptId, true);
                        } else {
                             showToast(`Must complete prerequisite before starting ${conceptId}.`, 'accent');
                        }
                    }
                } else {
                    showToast("Please log in to track your progress.", 'accent');
                }
            }
            
            // --- Progress Tracking (Firestore) (Unchanged) ---
            
            async function toggleConceptCompletion(conceptId, isComplete) {
                if (!userId) return;
                const docRef = db.collection(progressCollectionPath()).doc(conceptId);

                try {
                    await docRef.set({ completed: isComplete, timestamp: firebase.firestore.FieldValue.serverTimestamp() }, { merge: true });
                    showToast(`${conceptId} marked as ${isComplete ? 'completed' : 'incomplete'}.`, isComplete ? 'secondary' : 'accent');
                } catch (error) {
                    console.error("Error writing progress: ", error);
                    showToast("Failed to update progress.", 'accent');
                }
            }

            function updateLearningProgress(progressData) {
                userProgress = progressData;
                const completedCount = Object.keys(progressData).length;
                const percentage = totalConcepts > 0 ? Math.round((completedCount / totalConcepts) * 100) : 0;
                
                // Update Skill Tree
                renderSkillTree(progressData);
                
                // Update Component Card borders
                document.querySelectorAll('.component-card').forEach(card => {
                    const conceptId = card.dataset.conceptId;
                    card.classList.remove('border-green-500', 'ring-2', 'ring-green-500');
                    if (progressData[conceptId]) {
                        card.classList.add('border-green-500', 'ring-2', 'ring-green-500');
                    } else {
                        card.classList.remove('ring-2', 'ring-green-500');
                    }
                });
            }
            
            function generateDynamicSuggestions(progressData) {
                // NOTE: This function is simplified due to dependency on missing elements
                // dynamicSuggestionsContent.innerHTML = '';
                // ... (logic remains the same)
            }
            
            // --- Component Completion Mock Button (Unchanged) ---
            document.querySelectorAll('.component-card').forEach(card => {
                card.addEventListener('dblclick', () => {
                    if (userId) {
                        const conceptId = card.dataset.conceptId;
                        const isCompleted = userProgress[conceptId] === true;
                        toggleConceptCompletion(conceptId, !isCompleted);
                    } else {
                        showToast("Please log in to track your progress.", 'accent');
                    }
                });
            });

            // --- Real-time Firestore Progress Listener (Unchanged) ---
            function setupProgressListener(currentUserId) {
                if (window.unsubscribeProgress) {
                    window.unsubscribeProgress(); // Unsubscribe from previous user's listener
                }
                
                if (!currentUserId) {
                    updateLearningProgress({}); // Clear progress if logged out
                    return;
                }
                
                const q = db.collection(progressCollectionPath());
                
                // Listen for changes
                window.unsubscribeProgress = q.onSnapshot(snapshot => {
                    const progressData = {};
                    snapshot.forEach(doc => {
                        if (doc.data().completed) {
                            progressData[doc.id] = true;
                        }
                    });
                    updateLearningProgress(progressData);
                }, error => {
                    console.error("Firestore Progress Listener Error:", error);
                    showToast("Error loading learning progress.", 'accent');
                });
            }


            // --- Sensor Visualization Mock Logic (Unchanged) ---
            const sensorData = {
                ultrasonic: { unit: 'cm', min: 2, max: 200, value: 50, update: 100 },
            };

            function startSensorVisualization(type) {
                if (sensorVizInterval) clearInterval(sensorVizInterval);

                const data = sensorData[type];
                if (!data) return;

                const ctx = sensorVizCanvas.getContext('2d');
                let width = sensorVizCanvas.width = sensorVizCanvas.clientWidth;
                let height = sensorVizCanvas.height = sensorVizCanvas.clientHeight;
                
                // Gauge drawing function
                const drawGauge = () => {
                    ctx.clearRect(0, 0, width, height);

                    const centerX = width / 2;
                    const centerY = height; // Draw from the bottom
                    const radius = height * 0.9;
                    const startAngle = Math.PI; // 180 degrees
                    const endAngle = 2 * Math.PI; // 360 degrees

                    // Scale the value to the angle range (180 to 360 degrees)
                    const range = data.max - data.min;
                    const angleRatio = (data.value - data.min) / range;
                    const needleAngle = startAngle + (endAngle - startAngle) * angleRatio;
                    
                    // Background Arc
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, startAngle, endAngle, false);
                    ctx.lineWidth = 20;
                    ctx.strokeStyle = varFromTailwind('--border-color');
                    ctx.stroke();

                    // Fill Arc (Progress)
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, startAngle, needleAngle, false);
                    ctx.lineWidth = 20;
                    ctx.strokeStyle = varFromTailwind('--secondary');
                    ctx.stroke();

                    // Needle
                    ctx.beginPath();
                    ctx.strokeStyle = varFromTailwind('--accent');
                    ctx.lineWidth = 3;
                    ctx.moveTo(centerX, centerY);
                    ctx.lineTo(
                        centerX + radius * Math.cos(needleAngle),
                        centerY + radius * Math.sin(needleAngle)
                    );
                    ctx.stroke();
                    
                    // Center Dot
                    ctx.fillStyle = varFromTailwind('--accent');
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, 5, 0, 2 * Math.PI);
                    ctx.fill();

                    // Text Readout
                    ctx.fillStyle = varFromTailwind('--text-light');
                    ctx.font = '24px Orbitron';
                    ctx.textAlign = 'center';
                    ctx.fillText(`${data.value}${data.unit}`, centerX, centerY - radius / 3);
                };
                
                // Mock data generation loop
                sensorVizInterval = setInterval(() => {
                    // Simulate random fluctuation
                    const delta = (Math.random() * 20) - 10;
                    let newValue = data.value + delta;
                    
                    // Clamp value within min/max
                    if (newValue < data.min) newValue = data.min;
                    if (newValue > data.max) newValue = data.max;

                    data.value = Math.round(newValue);
                    sensorDataReadout.textContent = `Reading: ${data.value} ${data.unit} (Mock Data)`;
                    drawGauge();
                }, data.update);

                // Initial draw and resize handler
                drawGauge();
                window.addEventListener('resize', () => {
                    width = sensorVizCanvas.width = sensorVizCanvas.clientWidth;
                    height = sensorVizCanvas.height = sensorVizCanvas.clientHeight;
                    drawGauge();
                });
            }

            function stopSensorVisualization() {
                if (sensorVizInterval) {
                    clearInterval(sensorVizInterval);
                    sensorVizInterval = null;
                }
                sensorVizArea.classList.add('hidden');
                sensorDataReadout.textContent = 'Status: Idle';
            }
            
            // Helper function to get Tailwind colors
            function varFromTailwind(varName) {
                return getComputedStyle(document.documentElement).getPropertyValue(varName) || '#ffffff';
            }


            // --- Consolidated Project Data (EXPANDED with two new projects) ---
            const projectsList = [
                { 
                    id: 'iot1', 
                    name: 'Smart Home Automation System', 
                    theme: 'IoT & Remote Control', // NEW FIELD
                    aim: 'To develop a comprehensive, wireless system capable of controlling household appliances securely over the internet.', // NEW FIELD
                    description: 'Build a system to control lights, fans, and appliances remotely using ESP32 and a secure cloud platform.', 
                    image: 'https://images.unsplash.com/photo-1550745165-9bc0b252726f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80', 
                    price: 4500, 
                    time: '4 hours', 
                    chip: 'ESP32', 
                    type: 'iot',
                    applications: ['Residential automation', 'Remote device management', 'Energy optimization'],
                    advantages: ['Wireless control via Wi-Fi.', 'Scalable design for adding more devices.', 'Learning cloud integration basics (MQTT/HTTP).'],
                    features: ['Remote control via app', 'Scheduler functions', 'Voice command integration', 'Over-The-Air (OTA) updates'], // EXPANDED
                    requirements: ['ESP32 board', '2-channel Relay module', 'LEDs', 'Solid internet connection', 'Breadboard and Jumper Wires'], // EXPANDED
                    sensorsUsed: ['None (Actuator focus)'],
                    buyLink: 'https://rzp.io/rzp/smarthomeautomations',
                
                    aiSummary: "This core IoT project teaches you how to bridge hardware (relays, lights) and software (cloud platform, Wi-Fi) to create a controllable home environment. The key learning outcome is **secure device control over the internet**, foundational for any smart device career."
                },
                { 
                    id: 'ard1', 
                    name: 'Automatic Irrigation System', 
                    theme: 'Agriculture & Environmental Monitoring', // NEW FIELD
                    aim: 'To design and implement an automated watering system for plants based on real-time soil moisture data, saving water and improving plant health.', // NEW FIELD
                    description: 'A project using Arduino Uno to measure soil moisture and automatically water plants using a small pump.', 
                    image: 'https://images.unsplash.com/photo-1594803986683-12a81878d655?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80', 
                    price: 3500, 
                    time: '3 hours', 
                    chip: 'Arduino Uno', 
                    type: 'arduino',
                    applications: ['Small home gardens', 'Vertical farming setups', 'Educational tool for sensors'],
                    advantages: ['Simple to build and program.', 'Excellent introduction to analog inputs and DC motors.', 'Efficient water usage.'],
                    features: ['Soil moisture level display (LCD)', 'Automatic pump activation', 'Adjustable moisture threshold', 'Manual override button'], // EXPANDED
                    requirements: ['Arduino Uno', 'Soil Moisture Sensor', 'DC Water Pump', 'Relay Module', 'LCD Display (16x2)', 'Hoses and Water Supply'], // EXPANDED
                    sensorsUsed: ['Soil Moisture Sensor'],
                    buyLink: 'https://forms.gle/buy-arduino-irrigation-kit',
                    aiSummary: "This project provides a perfect introduction to closed-loop control systems. You'll learn how to interpret analog data from a **Soil Moisture Sensor** and use an **Arduino** to trigger an actuator (water pump) to maintain optimal conditions. It's practical and a great resume builder."
                },
                
  
   
    {
      "id": "iot2",
      "name": "Weather Monitoring Station",
      "theme": "Environmental Sensing & Data Logging",
      "aim": "To build a device for collecting real-time weather data and visualizing it on a cloud-based dashboard.",
      "description": "Real-time weather data collection with cloud dashboard visualization.",
      "image": "https://images.unsplash.com/photo-1603732551681-2e91159b9dc2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
      "price": 2500,
      "time": "6 hours",
      "chip": "NodeMCU",
      "type": "iot",
      "applications": [
        "Hobbyist weather reporting",
        "Agriculture (microclimate monitoring)",
        "Educational data science projects"
      ],
      "advantages": [
        "Mastering multiple digital sensors (DHT11/BME280).",
        "Deep understanding of HTTP/MQTT data transfer.",
        "Creating custom data dashboards (ThingSpeak)."
      ],
      "features": [
        "Measures temperature, humidity, pressure",
        "Uploads data to a cloud platform (e.g., ThingSpeak)",
        "Real-time dashboard"
      ],
      "requirements": [
        "NodeMCU ESP8266 board",
        "DHT11 or BME280 sensor",
        "Jumper wires",
        "Micro-USB cable"
      ],
      "sensorsUsed": [
        "DHT11/BME280 (Temperature, Humidity, Pressure)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-2",
      "aiSummary": "A practical project that focuses on **data acquisition and cloud analytics**. You'll connect the NodeMCU to environmental sensors and establish reliable data streams to a cloud platform for visualization."
    },
    {
      "id": "iot3",
      "name": "Smart Plant Monitoring System",
      "theme": "Agri-tech & Automated Care",
      "aim": "To create an automated system that monitors plant health factors and can trigger irrigation when necessary.",
      "description": "Automated plant care system with soil moisture and light sensors.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMz4IzRgDdfg8mYYH_kaqB8PP5ULbi4FEa8OB5HQQNlpGXKoZRaAqxtNi6GcMMcH60GImYAtDT_EuaqN9P-XowHtrXO9c6dyx3dAl5VLqENPLFJbE0=w2400",
      "price": 2800,
      "time": "3 hours",
      "chip": "Arduino IoT",
      "type": "iot",
      "applications": [
        "Home gardening automation",
        "Greenhouse management",
        "Educational robotics"
      ],
      "advantages": [
        "Integration of analog sensors (Moisture, LDR).",
        "Implementing decision logic (IF moisture < threshold THEN water).",
        "Introduction to the Arduino IoT Cloud."
      ],
      "features": [
        "Measures soil moisture and light level",
        "Sends alerts for low moisture",
        "Can trigger automatic watering"
      ],
      "requirements": [
        "Arduino MKR IoT Carrier",
        "Soil Moisture sensor",
        "LDR (Light Dependent Resistor) sensor",
        "Water pump (optional)",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "Soil Moisture Sensor",
        "LDR Sensor (Light)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-3",
      "aiSummary": "This project offers a great introduction to **Agri-tech and embedded decision-making**. You learn how to use sensor inputs to automate physical actions, ensuring your plants stay healthy."
    },
    {
      "id": "iot4",
      "name": "Smart Door Lock System",
      "theme": "Security & Biometrics",
      "aim": "To design and implement a high-security access control system using multiple authentication methods (biometric/RFID).",
      "description": "Biometric and RFID-based door lock system with remote access.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOhh4amBa25ZdPCNwOYKvKm5qWbsM6qBiCmcb7XwWNMRG5PnFdmQpFxzWbOZj1WrZnyVdfvnPB47MI2PQ_DNInLqnU3YoxCsfMpXMcFB6hWsw2EAns=w2400",
      "price": 3000,
      "time": "5 hours",
      "chip": "Raspberry Pi",
      "type": "iot",
      "applications": [
        "Home and office security",
        "Restricted access areas",
        "Time-based access control systems"
      ],
      "advantages": [
        "Programming in Python on a Linux environment (Raspberry Pi).",
        "Interfacing with complex peripherals (Fingerprint/RFID).",
        "Creating a simple web interface for remote management."
      ],
      "features": [
        "Fingerprint or RFID unlock",
        "Remote unlock via web interface",
        "Logs access history"
      ],
      "requirements": [
        "Raspberry Pi board",
        "Fingerprint sensor or RFID reader",
        "Servo motor or solenoid lock",
        "Power supply",
        "External display (optional)"
      ],
      "sensorsUsed": [
        "Fingerprint Sensor",
        "RFID Reader"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-4",
      "aiSummary": "A powerful project on **embedded Linux and multi-factor authentication**. You will learn to manage peripherals and build a robust, logging-enabled security system using the Raspberry Pi."
    },
    {
      "id": "iot5",
      "name": "Water Quality Monitor",
      "theme": "Environmental Sensing & Analysis",
      "aim": "To monitor and report on critical water parameters (pH, turbidity, temperature) in real-time for safety analysis.",
      "description": "Real-time monitoring of pH, turbidity, and temperature in water sources.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczO3wUaCNA1YtgMGIXYfHBkPdXIqv-Nhm_jU-060QjUuy9Q1U75Pa6ci1l1qujYxvj_5dAwSEQIrYGh0twldk6RmtX1i6ukHGfvpzaYh1UnLwHCroOo=w2400",
      "price": 3200,
      "time": "7 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Aquaculture monitoring",
        "Home drinking water analysis",
        "Industrial liquid process control"
      ],
      "advantages": [
        "Handling sensitive analog-to-digital (ADC) conversions.",
        "Sensor calibration techniques (crucial for pH/Turbidity).",
        "Implementing cloud alerts for critical parameter deviations."
      ],
      "features": [
        "Measures multiple parameters (pH, temp, turbidity)",
        "Online data visualization",
        "Alerts for unsafe levels"
      ],
      "requirements": [
        "ESP32 board",
        "pH sensor with interface board",
        "Turbidity sensor",
        "DS18B20 Temperature sensor",
        "Wi-Fi module (integrated)",
        "Waterproof enclosure (recommended)"
      ],
      "sensorsUsed": [
        "pH Sensor",
        "Turbidity Sensor",
        "DS18B20 Temperature Sensor"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-5",
      "aiSummary": "An advanced sensing project that focuses on **accurate data acquisition from challenging environments**. You will gain experience in handling analog data from multiple specialized chemical sensors and sending it via Wi-Fi."
    },
    {
      "id": "iot6",
      "name": "Air Quality Monitor",
      "theme": "Health & Environmental Monitoring",
      "aim": "To provide accurate, real-time measurements of indoor air quality pollutants (CO2, VOCs) and notify users of unsafe conditions.",
      "description": "Monitor indoor air quality (CO2, VOCs) and get alerts on your phone.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNbPQTQpT-v2jgjYClkeiZbiBTJZdj9C8GSxR4JKjcYtIoLntk4OTlkuY39GH7MzpBM92nbBuJBxH-V8BhK6MVjxHlTgH2aLS68CWZuewDJ-M_3TbYW=w2400",
      "price": 2200,
      "time": "4 hours",
      "chip": "ESP8266",
      "type": "iot",
      "applications": [
        "Indoor home monitoring",
        "Office ventilation analysis",
        "Safety systems for laboratories"
      ],
      "advantages": [
        "Understanding gas sensor linearization and calibration.",
        "Implementing asynchronous data transmission.",
        "Setting up push notifications for critical alerts."
      ],
      "features": [
        "Measures CO2 and particulate matter",
        "Mobile alerts via push notification",
        "Historical data logging"
      ],
      "requirements": [
        "ESP8266 NodeMCU board",
        "MQ-135 Air Quality Sensor or equivalent",
        "Blynk or ThingSpeak cloud account",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "MQ-135 (CO2/VOCs/Air Quality)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-6",
      "aiSummary": "Focuses on **air quality sensing and mobile integration**. You will learn how to interface the ESP8266 with specialized gas sensors and deliver critical information directly to a smartphone app."
    },
    {
      "id": "iot7",
      "name": "Smart Garage Door Controller",
      "theme": "Remote Access & Security",
      "aim": "To enable secure, remote operation and real-time status monitoring of a garage door via a smartphone.",
      "description": "Open and close your garage door securely with your smartphone.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOtE0jiqG8uxzVojjNKXzjtlpdcaaknl9za2lbpf-2tgenIcjpo6HUgt1HFOV6b4h_iMUdNUJcsmVRoXDuYRvwHkGIn7ulNzU2W8HjPPzce7RZVnuvt=w2400",
      "price": 2700,
      "time": "3 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Home convenience and security",
        "Remote property access management"
      ],
      "advantages": [
        "Interfacing actuators (Relay) and sensors (Contact Sensor) simultaneously.",
        "Implementing a secure, momentary trigger mechanism.",
        "Real-time state management and feedback over Wi-Fi."
      ],
      "features": [
        "Remote control via smartphone",
        "Real-time status monitoring",
        "Security logging"
      ],
      "requirements": [
        "ESP32 board",
        "Single-channel Relay module",
        "Magnetic contact sensor",
        "Jumper wires",
        "Power supply"
      ],
      "sensorsUsed": [
        "Magnetic Contact Sensor (Door status)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-7",
      "aiSummary": "A fast, high-utility project focused on **actuator and feedback control**. You'll master the logic required to safely and remotely operate a simple mechanical system with full status verification."
    },
    {
      "id": "iot8",
      "name": "Smart Parking System",
      "theme": "Smart City & Infrastructure",
      "aim": "To build a proof-of-concept system that detects parking occupancy and displays it on a centralized web map.",
      "description": "Detect available parking spots and display the status on a web app.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMcTyJEqQieDRarrMtJGIokVaOjlcdPVM2UGRyXPkAHdyAkOXaJob1KD0mZLBStte4k-fHF-UPDdvjANIljeMYkz9IcXmyG-h8aH2AaPtxz01erYZaM=w2400",
      "price": 3800,
      "time": "9 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Urban parking management",
        "Mall/office complex optimization",
        "Traffic flow monitoring"
      ],
      "advantages": [
        "Handling input from multiple identical sensors (Ultrasonic).",
        "Building a simple embedded web server on the ESP32.",
        "Implementing centralized real-time data aggregation."
      ],
      "features": [
        "Uses ultrasonic sensors to detect cars",
        "Web-based status map",
        "Real-time occupancy calculation"
      ],
      "requirements": [
        "ESP32 board",
        "Multiple HC-SR04 Ultrasonic sensors",
        "Breadboard and Jumper Wires",
        "Basic HTML/CSS knowledge for web app"
      ],
      "sensorsUsed": [
        "HC-SR04 Ultrasonic Sensor (Distance/Presence)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-8",
      "aiSummary": "This complex project involves **multi-sensor fusion and embedded web hosting**. You'll manage data from several ultrasonic sensors simultaneously to create a functional 'Smart City' infrastructure application."
    },
    {
      "id": "iot9",
      "name": "Water Leak Detector",
      "theme": "Preventative Home Safety",
      "aim": "To provide an early warning system for water leaks using a simple sensor and instant notification mechanism.",
      "description": "Get instant alerts on detecting water leaks to prevent property damage.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMwJuf2Gao8XnNIbQPNniX9ui2aL2jrN7VkK3lKp5025JjUy2qDSGiWV_2BH5dppduINUbedELTBpleqsaqrFU9st2VebPl110pvFLGSm5DgQA_lxty=w2400",
      "price": 1800,
      "time": "2 hours",
      "chip": "ESP8266",
      "type": "iot",
      "applications": [
        "Basement/laundry room monitoring",
        "Pipe leak detection",
        "Battery-powered remote sensing"
      ],
      "advantages": [
        "Focus on ultra-low power consumption (deep sleep mode).",
        "Setting up email/app alert triggers.",
        "Simple, effective binary sensor integration."
      ],
      "features": [
        "Instant email/app alerts",
        "Simple sensor interface",
        "Battery-powered operation"
      ],
      "requirements": [
        "ESP8266 NodeMCU board",
        "Water level sensor or leak sensor",
        "Buzzer (optional)",
        "Battery power source (e.g., Li-ion battery)"
      ],
      "sensorsUsed": [
        "Water Level/Leak Sensor"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-9",
      "aiSummary": "A quick, entry-level project focusing on **critical alerting and low-power design**. The main takeaway is setting up instant, reliable notifications for binary events over Wi-Fi."
    },
    {
      "id": "iot10",
      "name": "Automated Window Blinds",
      "theme": "Mechanical Automation & Scheduling",
      "aim": "To motorize window blinds and control them based on a time schedule or manual app input.",
      "description": "Control your window blinds based on time of day or with a mobile app.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNLgUMAQiX0-78WGyUGE0ON8hhEYXGtIkOXhzH9eotPT3fA08VX6J2M1qbYJgtBvsFLD_v7Btrx0qFxAa1o0WW5aNmV8E8Q-g8phTF65_SjVp59FqRZ=w2400",
      "price": 4000,
      "time": "5 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Smart home convenience",
        "Energy efficiency (solar gain control)",
        "Accessibility devices"
      ],
      "advantages": [
        "Precision control of stepper/servo motors.",
        "Implementing time-based scheduling (RTC/NTP sync).",
        "Optional sensor feedback for light-level automation."
      ],
      "features": [
        "Scheduled automation",
        "Manual control via app",
        "Sunlight tracking option"
      ],
      "requirements": [
        "ESP32 board",
        "Stepper motor or high-torque Servo",
        "Motor driver (e.g., A4988 for Stepper)",
        "LDR (optional for light tracking)",
        "Custom mounting/pulley system"
      ],
      "sensorsUsed": [
        "LDR (optional, for light sensing)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-10",
      "aiSummary": "This is a great **electro-mechanical automation** project. You will combine Wi-Fi connectivity with motor control techniques to precisely move a physical system based on remote commands and internal timing."
    },
    {
      "id": "iot11",
      "name": "Smart Trash Can Monitor",
      "theme": "Smart City & Waste Management",
      "aim": "To measure the fill level of a trash can and report the status remotely to optimize waste collection logistics.",
      "description": "A trash can that reports when it's full to optimize collection routes.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNTNQoCfHLWX08xLsqZeQuVo99HtEqhR8zu5htwDjzXjwCbcYi6J03MHm70VQLFEgsdkl7yjd7QyVKUdyq6Ik5r_O2moA1MrcCk43ELanukSAl1I8Kp=w2400",
      "price": 3600,
      "time": "4 hours",
      "chip": "Arduino Uno & ESP8266",
      "type": "iot",
      "applications": [
        "Municipal waste management",
        "Inventory level monitoring",
        "Capacity planning"
      ],
      "advantages": [
        "Integrating two microcontrollers (Arduino for sensing, ESP for Wi-Fi).",
        "Using ultrasonic distance measurement for non-contact level detection.",
        "Data communication between two chips (Serial/I2C)."
      ],
      "features": [
        "Ultrasonic sensing for fill level",
        "Remote status reporting",
        "Web interface visualization"
      ],
      "requirements": [
        "Arduino Uno board",
        "ESP8266 module (for WiFi connectivity)",
        "HC-SR04 Ultrasonic sensor",
        "Power supply",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "HC-SR04 Ultrasonic Sensor (Distance/Level)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-11",
      "aiSummary": "A solid project in **sensor integration and logistics optimization**. You will focus on reliably measuring fill levels using ultrasonic technology and reporting that data over a network for visualization."
    },
    {
      "id": "iot12",
      "name": "Gas Leakage Detector",
      "theme": "Safety & Critical Alerting",
      "aim": "To detect dangerous concentrations of flammable gases and trigger instant, reliable alerts via SMS.",
      "description": "Detects flammable gases and sends an alert to your phone via SMS.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOZc5U7gYfBqpvVESXFTTUDR-Qpbm_9AcRCElSQ6DteyU2EjHfmmcyDsd68szD9PWMGdGpnCrd0dhUzR3EQBrT73UCfkb2xwSrHQWxvZWH3xqDWBZ29=w2400",
      "price": 4200,
      "time": "3 hours",
      "chip": "NodeMCU & GSM Module",
      "type": "iot",
      "applications": [
        "Kitchen/utility room safety",
        "Industrial gas monitoring",
        "Remote security applications"
      ],
      "advantages": [
        "Interfacing with GSM/GPRS modules (AT commands).",
        "Setting up reliable, non-internet-dependent communication (SMS).",
        "Calibrating and using chemical gas sensors (MQ series)."
      ],
      "features": [
        "High-sensitivity gas detection",
        "Instant SMS alerts to multiple users",
        "Audible alarm"
      ],
      "requirements": [
        "NodeMCU ESP8266 board",
        "MQ-2 Gas Sensor",
        "SIM800L GSM Module (requires SIM card)",
        "Buzzer",
        "Separate power supply for GSM module"
      ],
      "sensorsUsed": [
        "MQ-2 Gas Sensor (Flammable Gas)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-12",
      "aiSummary": "This high-importance project focuses on **critical communication via GSM**. You will learn to use a specialized gas sensor and ensure that emergency alerts are delivered instantly using SMS text messaging."
    },
    {
      "id": "iot13",
      "name": "Smart Pill Dispenser",
      "theme": "Healthcare & Automated Assistance",
      "aim": "To create a device that reminds users and automatically dispenses medication according to a set, programmable schedule.",
      "description": "An automated pill dispenser that reminds and provides medication on schedule.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNItSPWo_al2EEtsxrCDpIu5Vff597duvTuTWL5ZeJ2Z7gbnqEEQAewh7A2XNHDsYP3Hz3BzxaMF2FdIkYxl7PfkTQjv25LkujUP061XYW4B8YaDbiJ=w2400",
      "price": 4500,
      "time": "7 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Elderly care assistance",
        "Chronic medication management",
        "Clinical trial compliance"
      ],
      "advantages": [
        "Complex scheduling logic using Real-Time Clock (RTC).",
        "Precision control of multiple servo motors for dispensing.",
        "Developing a user-friendly mobile application interface."
      ],
      "features": [
        "Programmable scheduling",
        "Mobile app reminders",
        "Dispenses medication accurately"
      ],
      "requirements": [
        "ESP32 board",
        "Multiple Servo motors",
        "RTC (Real-Time Clock) module (e.g., DS3231)",
        "Custom housing (e.g., 3D printed dispenser mechanism)"
      ],
      "sensorsUsed": [
        "RTC Module (Time keeping)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-13",
      "aiSummary": "A challenging **mechatronics and scheduling** project. The focus is on using the RTC and Wi-Fi to maintain precise timing for medication dispensing, which is crucial for health-related applications."
    },
    {
      "id": "iot14",
      "name": "Community Noise Monitor",
      "theme": "Environmental Sensing & Public Data",
      "aim": "To continuously monitor ambient noise levels in a specific area and share the data publicly on an online platform.",
      "description": "Monitor noise levels in your neighborhood and visualize the data online.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczP5oLCjmMnMsBxC45jafW_zGbEAMQITQzJ68Q3YmLPXD8_8v_UnTaapyL7_yUkQuKMDBBPV1dh7FJLWx_Gj84SQ_E7GB1910BoDDAogQeCwb99jxyrX=w2400",
      "price": 3000,
      "time": "3 hours",
      "chip": "NodeMCU",
      "type": "iot",
      "applications": [
        "Urban planning",
        "Noise pollution research",
        "Community engagement projects"
      ],
      "advantages": [
        "Converting analog sound input to meaningful digital dB values.",
        "Uploading data to public platforms (e.g., Ubidots).",
        "Understanding sampling rates and data averaging."
      ],
      "features": [
        "Measures Decibel (dB) levels",
        "Time-series data plotting online",
        "Alerts for excessive noise"
      ],
      "requirements": [
        "NodeMCU ESP8266 board",
        "Sound sensor module",
        "Cloud platform (e.g., Ubidots) account",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "Sound Sensor Module (Decibel)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-14",
      "aiSummary": "Focuses on **sound processing and public data visualization**. You'll use the sound sensor to convert physical noise into digital metrics and publish it for community consumption using an IoT platform."
    },
    {
      "id": "iot15",
      "name": "Automated Attendance System",
      "theme": "Access Control & Database Management",
      "aim": "To use RFID or fingerprint authentication to track user attendance and log the data automatically to a cloud database.",
      "description": "Use RFID or fingerprint scanning to take attendance and store it in the cloud.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczPGKK9Ou3S5cZQ3MLtrlNpi1evu_A1UJvCS-R281bBkWlSVX9r3LLtJqci9seEJp4jjfS0O2kkh641xM7m46g-uV91kZkGjYpd5y2DdohOgvVIJyvX1=w2400",
      "price": 3000,
      "time": "5 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Classroom/workplace attendance tracking",
        "Event registration systems",
        "Time clock applications"
      ],
      "advantages": [
        "Interfacing with authentication hardware (Biometrics/RFID).",
        "Securely writing and retrieving data from an external cloud database (Firebase).",
        "Developing a simple administration web interface for records."
      ],
      "features": [
        "Biometric/RFID authentication",
        "Cloud database logging",
        "Web interface for admin review"
      ],
      "requirements": [
        "ESP32 board",
        "RFID or Fingerprint sensor module",
        "External cloud database (e.g., Firebase setup)",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "RFID Sensor or Fingerprint Sensor"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-15",
      "aiSummary": "A business-focused project covering **authentication and robust database integration**. You will learn how to securely link a hardware event (a scan) to a timestamped entry in a cloud database."
    },
    {
      "id": "iot16",
      "name": "Smart Energy Monitor",
      "theme": "Energy Management & Analytics",
      "aim": "To accurately measure and log household energy consumption (current/voltage) in real-time for detailed usage analytics.",
      "description": "Track home energy consumption in real-time with cloud analytics.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMQHImgAVpKLMrB0HgqxOyOCvCf3DRh7QoOSD1hEC37tibujuitBjZahY_vpqnPxLHD-1mOlUYT7RMivEPoCqNJGa3e6j83uvvR6FDcV4oPcgCtHuI=w2400",
      "price": 2300,
      "time": "6 hours",
      "chip": "ESP8266",
      "type": "iot",
      "applications": [
        "Home energy auditing",
        "Solar power system monitoring",
        "Identifying energy-wasting appliances"
      ],
      "advantages": [
        "Interfacing with complex measurement sensors (CT/Voltage modules).",
        "Implementing mathematical calculations (Voltage x Current = Power).",
        "Creating historical trend charts for energy consumption."
      ],
      "features": [
        "Real-time current/voltage measurement",
        "Energy cost estimation",
        "Historical data trends"
      ],
      "requirements": [
        "ESP8266 NodeMCU board",
        "Current Transformer sensor (CT clamp)",
        "Voltage sensor module",
        "Cloud platform for analytics",
        "Safety precautions for electrical wiring"
      ],
      "sensorsUsed": [
        "Current Transformer (CT) Sensor",
        "Voltage Sensor"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-16",
      "aiSummary": "This challenging project focuses on **precision electrical measurement and computation**. You will learn how to safely and accurately measure AC parameters and convert them into valuable energy consumption data."
    },
    {
      "id": "ard1",
      "name": "RFID Door Lock System",
      "theme": "Security & Basic Actuators",
      "aim": "To build a simple, secure door lock system using RFID card authentication.",
      "description": "Secure door lock system using RFID cards for authentication.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOgMwMLSmyMPWQu2UZt3_P60dSVM3eOyRvzt2lEAzMmy1lC0lIWxdcYl1C05WNAHIcxcr9EDiAzzNf0oz9ln5lZOAxKH-U6nyC5d48CCfqgpk9PEEY=w2400",
      "price": 2500,
      "time": "3 hours",
      "chip": "Arduino Uno",
      "type": "arduino",
      "applications": [
        "Home/school locker security",
        "Access control for hobby projects",
        "Basic authentication training"
      ],
      "advantages": [
        "Mastering SPI communication for the RC522 module.",
        "Precise control of a Servo motor for locking.",
        "Implementing simple ID storage and verification logic."
      ],
      "features": [
        "Card-based access control",
        "Simple programming",
        "Uses a servo motor for locking mechanism"
      ],
      "requirements": [
        "Arduino Uno board",
        "RC522 RFID reader module",
        "Servo motor",
        "Breadboard and Jumper Wires",
        "Arduino IDE"
      ],
      "sensorsUsed": [
        "RC522 RFID Reader"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-1",
      "aiSummary": "A foundational project on **access control and security**. You will gain hands-on experience using the RC522 RFID module to read unique identifiers and trigger a physical actuator (the servo motor)."
    },
    {
      "id": "ard2",
      "name": "Bluetooth Controlled Car",
      "theme": "Robotics & Wireless Control",
      "aim": "To construct a mobile robot and control its movement wirelessly using a smartphone via a Bluetooth connection.",
      "description": "Smartphone-controlled car using Bluetooth module.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNotsOrKUzeRAeXLL4dPEe2y8cdeQGi21-fHEUdQX39zdsfOfbPa22rNrGyNASSRxYibDHVE9GzGXLfPB7Lb-ECgOCt9naJjY1JlmUJJcAa0--wmnAn=w2400",
      "price": 2700,
      "time": "4 hours",
      "chip": "Arduino Nano",
      "type": "ard",
      "applications": [
        "Remote-controlled toys",
        "Educational robotics platforms",
        "Introduction to mechatronics"
      ],
      "advantages": [
        "Understanding Serial communication via Bluetooth (HC-05).",
        "Controlling DC motors using an H-bridge driver (L298N).",
        "Implementing command parsing logic (Forward, Back, Turn)."
      ],
      "features": [
        "App-based control (forward, backward, turn)",
        "Easy to assemble chassis",
        "Fun to build and play with"
      ],
      "requirements": [
        "Arduino Nano board",
        "HC-05 Bluetooth module",
        "L298N motor driver",
        "DC motors (2 or 4)",
        "Wheels and Chassis kit",
        "Battery pack"
      ],
      "sensorsUsed": [
        "HC-05 Bluetooth Module (Receiver)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-2",
      "aiSummary": "A hands-on project that is core to **robotics and motor control**. You will focus on receiving commands via Bluetooth and translating them into precise movements using the L298N motor driver."
    },
    {
      "id": "ard3",
      "name": "Ultrasonic Radar System",
      "theme": "Sensing & Data Visualization",
      "aim": "To build a sweep radar that detects the distance of objects in a 180-degree field and plots the data on a computer screen.",
      "description": "Object detection system with servo-mounted ultrasonic sensor.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNnRLm4YRZDNsHd66bzXpC4uyAxseClnEnp0xJO84xtn9hGqYOpnfvjVo5aqP3q21N4p7PZBrA00-tcL_TgqUV06eKT6huAmjoGDPsWDRJieAKxPAzg=w2400",
      "price": 2400,
      "time": "4 hours",
      "chip": "Arduino Uno",
      "type": "ard",
      "applications": [
        "Proximity sensing",
        "Educational radar concept demonstration",
        "Visualizing sensor data over serial"
      ],
      "advantages": [
        "Integrating a servo motor for angular scanning.",
        "Mastering the HC-SR04 ultrasonic distance sensor.",
        "Using the Processing IDE for graphic data visualization."
      ],
      "features": [
        "Visual representation on PC screen",
        "Detects objects in a 180-degree range",
        "Uses ultrasonic sound waves for detection"
      ],
      "requirements": [
        "Arduino Uno board",
        "HC-SR04 ultrasonic sensor",
        "Servo motor",
        "Processing IDE installed on PC",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "HC-SR04 Ultrasonic Sensor",
        "Servo Motor (Actuator for scanning)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-3",
      "aiSummary": "A classic project that bridges **physical sensing and computer graphics**. The key learning is serial communication to transfer distance and angle data from Arduino to a desktop application (Processing) for real-time plotting."
    },
    {
      "id": "ard4",
      "name": "Home Security Alarm (PIR & GSM)",
      "theme": "Security & Cellular Communication",
      "aim": "To create a stand-alone security system that detects motion and immediately alerts the user via SMS text message.",
      "description": "Intrusion detection with PIR sensors and GSM alerts.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczPH1Ylq_UUsh0zo3Q_TWf7DuBNaJqbC0J0ftpRFfTjeCkmZC-dGyPaLrMnWnkTCwRnPa1j4Is_hX87ayGLNs0IU8yTkZ1CIruZyM_lvdHgrwiLfPyVQ=w2400",
      "price": 2800,
      "time": "5 hours",
      "chip": "Arduino + SIM800L",
      "type": "ard",
      "applications": [
        "Remote cabin security",
        "Basic home intrusion alarms",
        "SMS-based reporting systems"
      ],
      "advantages": [
        "Interfacing with the PIR passive infrared motion sensor.",
        "Sending SMS via the SIM800L GSM module (AT commands).",
        "Implementing low-power standby modes."
      ],
      "features": [
        "Motion detection",
        "Instant SMS alerts",
        "Alarm sound trigger"
      ],
      "requirements": [
        "Arduino Uno board",
        "PIR sensor",
        "SIM800L GSM module (requires SIM card)",
        "Buzzer",
        "Separate power supply for GSM module"
      ],
      "sensorsUsed": [
        "PIR Sensor (Motion)",
        "GSM Module (Communication)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-4",
      "aiSummary": "This robust project covers **motion detection and GSM communication**. You will learn how to reliably identify intrusion using the PIR sensor and send non-internet-dependent alerts via a cellular module."
    },
    {
      "id": "ard5",
      "name": "Digital Voltmeter",
      "theme": "Measurement & Display",
      "aim": "To accurately measure DC voltage across a specified range and display the result on an LCD screen.",
      "description": "Measure voltage from 0-30V with LCD display.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMfS-R0cFMewGT9E48md13C2dcCzGlTDWkOf0PBUcWx79EqnSTlUObUIUuC6_-e-HGKyI39jcEB1MKFhDwsmMsqt4im25pimcQL_LEZzNKhivM-l1q=w2400",
      "price": 2200,
      "time": "2 hours",
      "chip": "Arduino Uno",
      "type": "ard",
      "applications": [
        "Basic electronics testing",
        "Power supply monitoring",
        "Battery level indicators"
      ],
      "advantages": [
        "Understanding voltage divider circuits for measurement.",
        "Mastering Analog-to-Digital Conversion (ADC) in Arduino.",
        "Interfacing with the LCD 16x2 display (I2C/Parallel)."
      ],
      "features": [
        "Measures DC voltage accurately",
        "LCD display for readings",
        "Simple calibration process"
      ],
      "requirements": [
        "Arduino Uno board",
        "LCD 16x2 Display (with optional I2C adapter)",
        "Resistors for Voltage divider circuit",
        "Breadboard and Jumper Wires"
      ],
      "sensorsUsed": [
        "Voltage Divider Circuit (External sensing mechanism)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-5",
      "aiSummary": "A fundamental electronics project focusing on **analog measurement and data presentation**. The core concept is creating a voltage divider to safely measure higher voltages and displaying the calculated value on an LCD."
    },
    {
      "id": "ard6",
      "name": "Smart Traffic Light System",
      "theme": "Logic & Sequential Control",
      "aim": "To simulate a functional, automated traffic light system with a sequence customizable for a pedestrian crossing.",
      "description": "Automated traffic light system with pedestrian crossing.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczO1gYL2YZaBq7v10UyxYe_PQLhEZ7z4Op3Xvf3vcy3vWRDvwwTsMprOK3emK5mE11CAygK9xA5v4Dblh-sQcGM7MExIwRYonYz6qiw6pUBrJ_IudGlo=w2400",
      "price": 1600,
      "time": "3 hours",
      "chip": "Arduino Uno",
      "type": "ard",
      "applications": [
        "Educational demonstration of control flow",
        "Model railroad/city automation",
        "Basic state machine implementation"
      ],
      "advantages": [
        "Implementing time-based state machines and control logic.",
        "Handling push-button interrupts or polling for pedestrian requests.",
        "Direct control of multiple LED outputs (digital I/O)."
      ],
      "features": [
        "Customizable timing sequence",
        "Pedestrian request button",
        "Clear LED indicators"
      ],
      "requirements": [
        "Arduino Uno board",
        "RGB LEDs or separate colored LEDs (Red, Yellow, Green)",
        "Push button",
        "Resistors",
        "Breadboard and Jumper Wires"
      ],
      "sensorsUsed": [
        "Push Button (Pedestrian request)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-6",
      "aiSummary": "This classic project is excellent for learning **sequential logic and state machine programming**. You will focus on creating reliable, timed sequences and managing an external input (the push button) to alter the flow."
    },
    {
      "id": "ard7",
      "name": "Voice Controlled Appliances",
      "theme": "Wireless Control & Human-Machine Interface",
      "aim": "To enable the control of household appliances using spoken commands routed through a smartphone and Bluetooth module.",
      "description": "Control room lights using voice commands via Bluetooth.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOH-zP6-T444_fQvGh8IL5InzAb0kuCtiost4BKcLdSdbGUjFAKkn_wzY3nLPrbpQcrgYqTL-EggP8SoDed0mMfwbEiibAj6ItXXF9_1x0NFgDW_pV8=w2400",
      "price": 3200,
      "time": "3.5 hours",
      "chip": "Arduino + HC-05",
      "type": "ard",
      "applications": [
        "Accessibility control systems",
        "Home automation (hands-free)",
        "Voice command decoding"
      ],
      "advantages": [
        "Integrating voice recognition software on a host device (smartphone).",
        "Reliable UART communication between Arduino and HC-05.",
        "Implementing safety protocols for AC appliance control (Relay)."
      ],
      "features": [
        "Voice command processing on smartphone app",
        "Controls up to 4 appliances",
        "Uses Bluetooth for communication"
      ],
      "requirements": [
        "Arduino Uno board",
        "HC-05 Bluetooth module",
        "4-channel Relay module",
        "Smartphone with voice recognition app",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "HC-05 Bluetooth Module (Receiver)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-7",
      "aiSummary": "Focuses on **wireless command parsing and human interface**. You learn to receive voice commands as simple strings via Bluetooth and trigger corresponding physical actions using relays."
    },
    {
      "id": "ard8",
      "name": "Laser Security System",
      "theme": "Intrusion Detection & Optics",
      "aim": "To build a simple, cost-effective perimeter security system using a laser tripwire and light-dependent resistor (LDR).",
      "description": "Create a laser tripwire security system with buzzer alarm.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczO9QWf-BNMVt8nPeSMNbHWXYSwD2Ong80c4rMxPsxwFV46v82rY91uzs3oxELaMqyDpX7EPaf1ijCmiRedxJ8ZpFqvO13EAEEoPyYwrH6-0MVHiwDon=w2400",
      "price": 1800,
      "time": "2 hours",
      "chip": "Arduino Uno",
      "type": "ard",
      "applications": [
        "DIY perimeter alarms",
        "Educational optics experiments",
        "Simple room monitoring"
      ],
      "advantages": [
        "Understanding how an LDR sensor works with varying light levels.",
        "Implementing adjustable threshold logic for 'beam broken' detection.",
        "Simple digital/analog input and output control."
      ],
      "features": [
        "Tripwire alarm logic",
        "Audible buzzer alert",
        "Adjustable sensitivity"
      ],
      "requirements": [
        "Arduino Uno board",
        "Laser Module",
        "LDR (Light Dependent Resistor) sensor",
        "Buzzer or LED",
        "Breadboard and Jumper Wires"
      ],
      "sensorsUsed": [
        "LDR (Light Dependent Resistor)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-8",
      "aiSummary": "A quick, introductory project on **light-based sensing and threshold setting**. The key is using the LDR to detect the presence or absence of the laser beam and triggering a simple alarm based on the light change."
    },
    {
      "id": "ard9",
      "name": "Obstacle Avoiding Robot",
      "theme": "Robotics & Autonomous Navigation",
      "aim": "To build an autonomous vehicle that can navigate an environment by sensing and avoiding physical obstacles in its path.",
      "description": "Build an autonomous vehicle that navigates around obstacles.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczPL836iWZCL6eReOPTAlj9IdrxBu7SsEbe_w_311P0GlHRgYGIddd6gVGOJ0_AGbEgLdX8lKtS4oSX_NCm6Lp74e22-hB16Ke7-vvmcDBGrd0zdkI8=w2400",
      "price": 4500,
      "time": "5 hours",
      "chip": "Arduino Nano",
      "type": "ard",
      "applications": [
        "Autonomous vacuum cleaners (simplified)",
        "Educational robot contests",
        "Introduction to navigation algorithms"
      ],
      "advantages": [
        "Combining sensor input (Ultrasonic) with actuator control (DC Motors).",
        "Implementing basic pathfinding algorithms (Sense, Decide, Act).",
        "Hands-on mechanical assembly of a mobile robot."
      ],
      "features": [
        "Autonomous navigation",
        "Uses ultrasonic sensor for obstacle detection",
        "Simple mechanical chassis"
      ],
      "requirements": [
        "Arduino Nano board",
        "HC-SR04 Ultrasonic sensor",
        "L298N motor driver",
        "DC motors (2)",
        "Wheels and Chassis kit",
        "Battery pack"
      ],
      "sensorsUsed": [
        "HC-SR04 Ultrasonic Sensor"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-9",
      "aiSummary": "The definitive **beginner robotics project**. You will integrate distance sensing and motor control to create a functional autonomous system, learning the fundamental 'Sense-Decide-Act' loop of robotics."
    },
    {
      "id": "ard10",
      "name": "GPS Tracker & Data Logger",
      "theme": "Geospatial Technology & Data Logging",
      "aim": "To create a portable device that logs its precise geographical coordinates and records the data for later analysis.",
      "description": "Location tracking device with data logging to SD card.",
      "image": "https://images.unsplash.com/photo-1581091226033-d5c48150dbaa?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
      "price": 4300,
      "time": "4 hours",
      "chip": "Arduino Mega",
      "type": "ard",
      "applications": [
        "Asset tracking",
        "Geocaching/hiking route logging",
        "Small drone telemetry"
      ],
      "advantages": [
        "Interfacing with a dedicated GPS module (NEO-6M) via UART.",
        "Parsing NMEA sentences to extract Lat/Lon data.",
        "Writing and managing data on an SD card file system."
      ],
      "features": [
        "Real-time latitude/longitude data",
        "Data logged to SD card for later analysis",
        "High accuracy GPS module"
      ],
      "requirements": [
        "Arduino Mega (recommended for extra UART ports)",
        "GPS Module (e.g., NEO-6M)",
        "SD Card module (and Micro SD card)",
        "Battery and power management",
        "Antenna (if separate)"
      ],
      "sensorsUsed": [
        "GPS Module (Location data)",
        "SD Card Module (Storage)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-10",
      "aiSummary": "This advanced project focuses on **geospatial data acquisition and non-volatile storage**. You will learn to communicate with a GPS module and reliably log the complex location data onto an SD card."
    },
    
    {
      "id": "cse1",
      "name": "Online Book Store E-commerce Platform",
      "theme": "Full-Stack Web Development",
      "aim": "To develop a comprehensive, secure e-commerce website capable of handling user authentication, product catalog management, and payment processing.",
      "description": "A web-based bookstore with user authentication and payment integration.",
      "image": "https://placehold.co/400x300/1e3a8a/ffffff?text=Web+Store",
      "price": 3500,
      "time": "20 hours",
      "chip": "Web Development",
      "type": "cse",
      "applications": [
        "E-commerce websites",
        "Subscription services",
        "Inventory management platforms"
      ],
      "advantages": [
        "Full-stack development experience (Front-end, Back-end, Database).",
        "Implementing secure user authentication (JWT/Sessions).",
        "Integration with third-party APIs (Payment Gateways)."
      ],
      "features": [
        "User registration and login",
        "Book catalog with search filters",
        "Shopping cart functionality",
        "Secure payment gateway"
      ],
      "requirements": [
        "HTML, CSS, JavaScript (Front-end)",
        "React or Node.js (Back-end framework)",
        "Database (e.g., Firebase, MongoDB)",
        "Code Editor (VS Code recommended)",
        "Basic knowledge of REST APIs"
      ],
      "sensorsUsed": [
        "None (Software focus)"
      ],
      "buyLink": "https://forms.gle/buy-cse-kit-1",
      "aiSummary": "A robust **full-stack development** project that simulates a real-world e-commerce platform. The key learning is integrating multiple technologies (DB, Backend, Frontend) to manage product state and handle financial transactions securely."
    },
    {
      "id": "cse2",
      "name": "Image Recognition Application",
      "theme": "Machine Learning & Computer Vision",
      "aim": "To create a Python application that uses a pre-trained machine learning model to classify and identify objects within an uploaded image.",
      "description": "A Python-based app that identifies objects in an image using a pre-trained model.",
      "image": "https://placehold.co/400x300/065f46/ffffff?text=AI+Recognition",
      "price": 4000,
      "time": "15 hours",
      "chip": "Machine Learning",
      "type": "cse",
      "applications": [
        "Automated image tagging",
        "Quality control in manufacturing",
        "Search engine optimization"
      ],
      "advantages": [
        "Loading and using a pre-trained Deep Learning model (e.g., ResNet).",
        "Image preprocessing techniques (resizing, normalization).",
        "Exposing ML models via a web service (Flask)."
      ],
      "features": [
        "Upload and analyze images",
        "Provides a list of recognized objects and confidence scores",
        "Simple and intuitive UI"
      ],
      "requirements": [
        "Python 3.x",
        "TensorFlow or PyTorch framework",
        "Flask or Django (for web interface)",
        "Relevant image data set for testing",
        "Code Editor and Command Line interface"
      ],
      "sensorsUsed": [
        "None (Software focus)"
      ],
      "buyLink": "https://forms.gle/buy-cse-kit-2",
      "aiSummary": "This project is an excellent introduction to **applied Machine Learning**. You will learn how to integrate powerful computer vision models into a practical Python application to recognize and classify real-world objects."
    },
    {
      "id": "cse3",
      "name": "Real-time Chat Application",
      "theme": "Network Programming & Real-time Communication",
      "aim": "To build a multi-user communication platform that supports instant message delivery and real-time user presence updates.",
      "description": "A multi-user chat application with real-time messaging and user presence.",
      "image": "https://placehold.co/400x300/4a044e/ffffff?text=Realtime+Chat",
      "price": 18000,
      "time": "18 hours",
      "chip": "WebSockets",
      "type": "cse",
      "applications": [
        "Instant messaging services",
        "Multiplayer game lobbies",
        "Live stock market tickers"
      ],
      "advantages": [
        "Mastering WebSocket protocol for persistent, bidirectional communication.",
        "Managing multiple concurrent user connections on the server.",
        "Implementing message broadcasting and user presence logic."
      ],
      "features": [
        "Instant messaging",
        "User online/offline status",
        "Message history",
        "User authentication"
      ],
      "requirements": [
        "Node.js and Express.js (Back-end)",
        "Socket.io library (for WebSockets)",
        "HTML/CSS/JS (Front-end)",
        "Basic database (for history)",
        "Code Editor"
      ],
      "sensorsUsed": [
        "None (Software focus)"
      ],
      "buyLink": "https://forms.gle/buy-cse-kit-3",
      "aiSummary": "A crucial **network programming project**. The focus is on implementing the WebSocket protocol using Socket.io to achieve true low-latency, real-time interactivity essential for modern web applications."
    }
  ];
            // --- END Consolidated Project Data ---

            
            function renderProjects(filter = 'all') {
                projectsGrid.innerHTML = '';
                const allProjects = projectsList;
                let filteredProjects;
                if (filter === 'iot') {
                    filteredProjects = allProjects.filter(p => p.type === 'iot');
                } else if (filter === 'arduino') {
                    filteredProjects = allProjects.filter(p => p.type === 'arduino');
                } else if (filter === 'cse') {
                    filteredProjects = allProjects.filter(p => p.type === 'cse');
                } else {
                    filteredProjects = allProjects;
                }

                filteredProjects.forEach(p => {
                    const projectType = p.type;
                    const tagClass = projectType === 'iot' ? 'bg-secondary' : (projectType === 'arduino' ? 'bg-accent' : 'bg-green-500');
                    const tagText = projectType === 'iot' ? 'IoT' : (projectType === 'arduino' ? 'Arduino' : 'CSE');

                    // NOTE: Project card must contain the project ID to track completion (mock project IDs used for simplicity)
                    const conceptId = p.id;
                    const completedClass = userProgress[conceptId] ? 'border-green-500 ring-2 ring-green-500' : 'border-secondary/50';

                    projectsGrid.innerHTML += `
                        <div class="project-card card-3d glassmorphism p-6 rounded-lg overflow-hidden neon-border cursor-pointer relative ${completedClass}" 
                             data-project-type="${projectType}" 
                             data-id="${p.id}" 
                             data-price="${p.price}" 
                             data-name="${p.name}" 
                             data-image="${p.image}"
                             data-description="${p.description}"
                             data-time="${p.time}"
                             data-chip="${p.chip}"
                             data-concept-id="${conceptId}"
                             data-theme="${p.theme}"
                             data-aim="${p.aim}"
                             data-features='${JSON.stringify(p.features)}'
                             data-applications='${JSON.stringify(p.applications)}'
                             data-advantages='${JSON.stringify(p.advantages)}'
                             data-requirements='${JSON.stringify(p.requirements)}'
                             data-sensors='${JSON.stringify(p.sensorsUsed)}'
                             data-buy-link="${p.buyLink}"
                             data-ai-summary="${p.aiSummary || 'No intelligent summary available for this project yet.'}">
                            <div class="absolute top-3 right-3 ${tagClass} text-white text-xs font-bold px-3 py-1 rounded-lg z-10">${tagText}</div>
                            <img src="${p.image}" alt="${p.name}" class="rounded-lg w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
                            <div class="mt-4">
                                <h3 class="font-orbitron text-2xl font-bold text-white">${p.name}</h3>
                                <p class="text-gray-400 mt-2 text-sm">${p.description.substring(0, 100)}...</p>
                                <div class="text-2xl font-bold font-orbitron text-accent mt-4">â‚¹${p.price}</div>
                                <button class="add-to-cart-btn btn-3d btn-primary-action btn-box mt-4">Add to Cart</button>
                                
                                <div class="project-meta flex justify-between text-sm text-gray-400 mt-4 border-t border-border-color pt-2">
                                    <span><i class="fas fa-clock text-secondary mr-1"></i> ${p.time}</span>
                                    <span><i class="fas fa-microchip text-secondary mr-1"></i> ${p.chip}</span>
                                </div>
                            </div>
                        </div>`;
                });
                
                document.querySelectorAll('.project-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        // Check if the click was on the cart button, if so, do nothing here
                        if (e.target.classList.contains('add-to-cart-btn')) {
                            return;
                        }
                        const data = card.dataset;
                        const defaultError = '<li>Data not specified.</li>';
                        
                        // Set the current project ID for TechWhiz button
                        askTechwhizDetailBtn.dataset.projectId = data.id;
                        askTechwhizDetailBtnTab.dataset.projectId = data.id;


                        // --- CRITICAL FIX: AGGRESSIVELY FORCE-CLOSE ALL OTHER MODALS AND CLEAR DISPLAY STATE ---
                        // Ensure all modals are closed before opening the project detail modal
                        if (profileModal) profileModal.style.display = 'none';
                        if (authModal) authModal.style.display = 'none';
                        if (cartModal) cartModal.classList.remove('open');
                        if (componentDetailModal) componentDetailModal.style.display = 'none';
                        if (orderHistoryModal) orderHistoryModal.style.display = 'none';
                        if (techwhizModal) techwhizModal.style.display = 'none';
                        // --- END FIX ---

                        // Clear previous content and hide sections
                        projectDetailFeatures.innerHTML = '';
                        projectDetailComponents.innerHTML = '';
                        projectDetailApplications.innerHTML = '';
                        projectDetailAdvantages.innerHTML = '';
                        projectDetailAim.textContent = 'N/A'; // Clear Aim
                        projectDetailThemeValue.textContent = 'N/A'; // Clear Theme
                        projectDetailSensorsUsed.innerHTML = '';
                        projectSensorView.classList.add('hidden'); 
                        
                        // Reset AI Summary view
                        aiSummaryContainer.classList.add('hidden'); 
                        aiSummaryText.textContent = 'Click the button above for an intelligent summary...'; 
                        aiSummaryBtn.dataset.summaryText = data.aiSummary;
                        
                        // Set Core Details
                        projectDetailTitle.textContent = data.name;
                        projectDetailImage.src = data.image;
                        projectDetailDescription.textContent = data.description;
                        projectDetailTime.innerHTML = `<i class="fas fa-clock text-secondary"></i> ${data.time}`;
                        projectDetailChip.innerHTML = `<i class="fas fa-microchip text-secondary"></i> ${data.chip}`;
                        projectDetailAim.textContent = data.aim || 'Project aim not explicitly defined.'; // NEW AIM
                        projectDetailThemeValue.textContent = data.theme || 'General'; // NEW THEME

                        
                        // --- FIX: ROBUST JSON PARSING FOR PROJECT LISTS ---
                        const listSections = {
                            applications: projectDetailApplications,
                            advantages: projectDetailAdvantages,
                            features: projectDetailFeatures,
                            requirements: projectDetailComponents,
                            sensors: projectDetailSensorsUsed 
                        };

                        for (const key in listSections) {
                            try {
                                const listData = data[key] ? JSON.parse(data[key]) : [];
                                
                                // Check if listData is an array and has content
                                if (Array.isArray(listData) && listData.length > 0) {
                                    // If it's the sensors list, use the special tag formatting
                                    if (key === 'sensors') {
                                         // The sensor rendering logic is slightly different (pills, not list items)
                                         listSections[key].innerHTML = listData.map(s => 
                                            `<li class="bg-accent/20 text-accent font-semibold px-3 py-1 rounded-full text-sm flex items-center">
                                                <i class="fas fa-cube mr-2"></i> ${s}
                                             </li>`
                                        ).join('');
                                    } else {
                                        // Standard list item formatting
                                        listSections[key].innerHTML = listData.map(item => `<li>${item}</li>`).join('');
                                    }
                                } else {
                                    // Handle cases where the array is empty or null
                                    listSections[key].innerHTML = defaultError;
                                }
                            } catch (error) {
                                // This catches JSON parsing errors and outputs to console
                                console.error(`E-TECH DATA ERROR: Failed to parse project data for key: ${key}`, error);
                                // Display a clear error message on the UI element
                                listSections[key].innerHTML = '<li>Error: Failed to load list data.</li>';
                            }
                        }
                        
                        // Special handling for sensors visibility
                        const sensorsList = JSON.parse(data.sensors);
                        if (sensorsList && sensorsList.length > 0 && sensorsList[0] !== 'None (Actuator focus)') {
                            projectSensorView.classList.remove('hidden');
                        } else {
                            projectSensorView.classList.add('hidden');
                        }
                        // --- END FIX ---
                        
                        // Set data for action buttons
                        addToCartFromDetailBtn.dataset.id = data.id;
                        addToCartFromDetailBtn.dataset.name = data.name;
                        addToCartFromDetailBtn.dataset.price = data.price;
                        addToCartFromDetailBtn.dataset.image = data.image;
                        
                        // Set Buy Now Link
                        buyNowFromDetailBtn.href = data.buyLink;
                        
                        // Reset to the first tab (Details & Aim)
                        activateProjectDetailTab(document.querySelector('.project-detail-tabs button[data-tab-target="#tab-details"]'));

                        // Show the modal immediately (FIX: This is the critical line to show the modal)
                        projectDetailModal.style.display = 'flex';
                    });
                });
                
                document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const card = e.target.closest('.project-card');
                        const price = parseFloat(card.dataset.price);
                        addToCart(card.dataset.id, card.dataset.name, price, card.dataset.image);
                        e.stopPropagation();
                    });
                });
                
                // Re-render KaTeX after injecting new HTML content
                if (window.renderMathInElement) {
                    renderMathInElement(projectsGrid);
                }
            }
            
            // NEW: Project Detail Tab Logic
            function activateProjectDetailTab(clickedButton) {
                // Deactivate all buttons and hide all content
                projectDetailTabBtns.forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('[data-tab-content]').forEach(content => content.classList.add('hidden'));
                
                // Activate the clicked button
                clickedButton.classList.add('active');
                
                // Show the target content
                const targetId = clickedButton.dataset.tabTarget;
                const targetContent = document.querySelector(targetId);
                if (targetContent) {
                    targetContent.classList.remove('hidden');
                }
            }

            projectDetailTabBtns.forEach(button => {
                button.addEventListener('click', () => activateProjectDetailTab(button));
            });

            // NEW: AI Summary Button Handler
            aiSummaryBtn.addEventListener('click', () => {
                const summaryText = aiSummaryBtn.dataset.summaryText;
                
                if (summaryText) {
                    // Simulate loading state
                    aiSummaryText.textContent = "Generating intelligent summary... one moment...";
                    aiSummaryContainer.classList.remove('hidden');

                    // Simulate API response delay (using setTimeout instead of actual API call for demo speed)
                    setTimeout(() => {
                        aiSummaryText.textContent = summaryText;
                    }, 800); 

                } else {
                    aiSummaryText.textContent = "No detailed AI summary available for this project.";
                    aiSummaryContainer.classList.remove('hidden');
                }
            });
            
            // NEW: Ask TechWhiz button handler inside the Project Detail Modal
            const askTechwhizProjectHandler = (e) => {
                const projectId = e.currentTarget.dataset.projectId;
                const project = projectsList.find(p => p.id === projectId);
                
                if (!project) return;
                
                const prompt = `Tell me more about the project, "${project.name}", specifically focusing on its main theme, purpose (aim), and unique features. Assume I am a student ready to start building it.`;
                
                // Close project modal and open TechWhiz modal
                projectDetailModal.style.display = 'none';
                techwhizModal.style.display = 'flex';
                
                // Inject prompt into chat input and trigger submission
                techwhizInput.value = prompt;
                sendBtn.click();
            };

            askTechwhizDetailBtn.addEventListener('click', askTechwhizProjectHandler);
            askTechwhizDetailBtnTab.addEventListener('click', askTechwhizProjectHandler); // Tab bar click should also trigger this
            
            // FIX: Close Modal Functionality (Ensuring this still works)
            closeProjectDetailBtn.addEventListener('click', () => {
                projectDetailModal.style.display = 'none';
            });
            
            // Close modal when clicking outside of the content area
            projectDetailModal.addEventListener('click', (e) => {
                // Only close if the click target is the modal overlay itself
                if (e.target === projectDetailModal) {
                    projectDetailModal.style.display = 'none';
                }
            });


            // --- Consolidated Function to Apply Filter and Update UI (Addressing User's Filter Issue) ---
            function applyProjectFilter(filter) {
                // 1. Update Active State UI for buttons
                document.querySelectorAll('.filter-btn').forEach(b => {
                    b.classList.remove('bg-secondary', 'hover:bg-accent');
                    // Ensure the default look is applied before checking for active state
                    b.classList.add('bg-gray-800', 'hover:bg-secondary'); 

                    if (b.dataset.filter === filter) {
                        // Apply active styling
                        b.classList.add('bg-secondary', 'hover:bg-accent');
                        b.classList.remove('bg-gray-800', 'hover:bg-secondary');
                    }
                });

                // 2. Render the filtered projects
                renderProjects(filter);
            }
            
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    applyProjectFilter(btn.dataset.filter);
                });
            });
            // --- END NEW: Consolidated Filter Function ---


            // --- Cart Logic Implementation (Unchanged) ---
            async function addToCart(id, name, price, image) {
                // Check Inventory (Mock Firestore check)
                try {
                    const inventoryRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('inventory').doc(id);
                    const doc = await inventoryRef.get();
                    let currentStock = 10; // Default mock stock
                    
                    if (doc.exists) {
                        currentStock = doc.data().stock;
                    } 
                    // To simulate low/zero stock for testing:
                    if (id === 'iot2') { currentStock = 0; } // Mock Sold Out for Weather Station

                    const existingItem = cart.find(item => item.id === id);
                    const quantityInCart = existingItem ? existingItem.quantity : 0;
                    
                    if (quantityInCart >= currentStock && currentStock > 0) {
                         showToast(`${name} is low stock! Max ${currentStock} allowed.`, 'accent');
                         return;
                    }
                    
                    if (currentStock <= 0) {
                         showToast(`${name} is currently Sold Out.`, 'accent');
                         return;
                    }

                    if (existingItem) {
                        existingItem.quantity++;
                    } else {
                        cart.push({ id, name, price, image, quantity: 1, maxStock: currentStock });
                    }
                    updateCart();
                    showToast(`${name} added to cart!`);

                } catch (error) {
                    console.error("Error checking inventory: ", error);
                    showToast(`Inventory check failed. Adding to cart anyway.`, 'secondary');
                    
                    // Fallback to adding without inventory check
                    const existingItem = cart.find(item => item.id === id);
                    if (existingItem) {
                        existingItem.quantity++;
                    } else {
                        cart.push({ id, name, price, image, quantity: 1 });
                    }
                    updateCart();
                }
            }
            
            function changeCartQuantity(id, change) {
                const item = cart.find(item => item.id === id);
                if (item) {
                    const newQuantity = item.quantity + change;
                    
                    if (newQuantity <= 0) {
                        removeFromCart(id);
                        return;
                    }
                    
                    // Check max stock if available
                    if (item.maxStock !== undefined && newQuantity > item.maxStock) {
                        showToast(`Max stock reached for ${item.name}!`, 'accent');
                        return;
                    }
                    
                    item.quantity = newQuantity;
                    updateCart();
                }
            }

            function removeFromCart(id) {
                const itemIndex = cart.findIndex(item => item.id === id);
                if (itemIndex > -1) {
                    cart.splice(itemIndex, 1);
                    showToast(`Item removed from cart.`, 'accent');
                }
                updateCart();
            }

            function updateCart() {
                cartModalItemsContainer.innerHTML = '';
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                
                cartCountElement.textContent = totalItems;
                cartItemCountHeader.textContent = totalItems;

                if (cart.length === 0) {
                    cartModalItemsContainer.innerHTML = '<p class="cart-empty-msg text-gray-400 text-center p-8">Your cart is currently empty. Start exploring projects!</p>';
                    cartCheckoutBtn.disabled = true;
                    cartCheckoutBtn.classList.remove('btn-primary-action', 'hover:bg-secondary'); // Use new classes
                    cartCheckoutBtn.classList.add('bg-gray-700', 'cursor-not-allowed');
                } else {
                    cartCheckoutBtn.disabled = false;
                    cartCheckoutBtn.classList.add('btn-primary-action', 'hover:bg-secondary'); // Use new classes
                    cartCheckoutBtn.classList.remove('bg-gray-700', 'cursor-not-allowed');

                    cart.forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.classList.add('cart-modal-item');
                        itemElement.innerHTML = `
                            <img src="${item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded-lg mr-4 border border-secondary/50">
                            <div class="flex-1">
                                <h4 class="font-bold text-white">${item.name}</h4>
                                <div class="flex items-center space-x-2 mt-1">
                                    <span class="text-sm text-gray-400">Qty:</span>
                                    <div class="cart-controls flex items-center">
                                        <button class="qty-minus" data-id="${item.id}" data-change="-1">-</button>
                                        <span class="px-2 text-white">${item.quantity}</span>
                                        <button class="qty-plus" data-id="${item.id}" data-change="1">+</button>
                                    </div>
                                </div>
                            </div>
                            <div class="text-lg font-orbitron text-accent mr-4">â‚¹${(item.price * item.quantity).toFixed(0)}</div>
                            <button class="cart-item-remove text-gray-500 hover:text-accent text-xl transition-colors" data-id="${item.id}">&times;</button>
                        `;
                        itemElement.querySelector('.cart-item-remove').addEventListener('click', (e) => removeFromCart(e.target.dataset.id));
                        itemElement.querySelector('.qty-minus').addEventListener('click', (e) => changeCartQuantity(e.target.dataset.id, -1));
                        itemElement.querySelector('.qty-plus').addEventListener('click', (e) => changeCartQuantity(e.target.dataset.id, 1));
                        cartModalItemsContainer.appendChild(itemElement);
                    });
                }
                const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
                cartTotalPriceElement.textContent = `â‚¹${total}`;
            }
            
            function showToast(message, color = 'secondary') {
                const toast = document.createElement('div');
                toast.textContent = message;
                toast.style.cssText = `
                    position: fixed; 
                    top: 20px; 
                    left: 50%; 
                    transform: translateX(-50%); 
                    background: var(--${color}); 
                    color: white; 
                    padding: 10px 20px; 
                    border-radius: 8px; 
                    z-index: 9999; 
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
                    font-family: 'Orbitron', sans-serif;
                    opacity: 0;
                    transition: opacity 0.5s ease-in-out;
                `;
                document.body.appendChild(toast);
                setTimeout(() => { toast.style.opacity = 1; }, 10);
                setTimeout(() => { toast.style.opacity = 0; }, 2500);
                setTimeout(() => toast.remove(), 3000);
            }

            cartFab.addEventListener('click', () => cartModal.classList.toggle('open'));
            closeCartBtn.addEventListener('click', () => cartModal.classList.remove('open'));

            addToCartFromDetailBtn.addEventListener('click', () => {
                const id = addToCartFromDetailBtn.dataset.id;
                const name = addToCartFromDetailBtn.dataset.name;
                const price = parseFloat(addToCartFromDetailBtn.dataset.price);
                const image = addToCartFromDetailBtn.dataset.image;
                addToCart(id, name, price, image);
                projectDetailModal.style.display = 'none';
            });
            
            // NOTE: The 'Buy Kit Now' button uses the `buyLink` data attribute
            // and opens it in a new tab for an immediate purchase flow.
            buyNowFromDetailBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const link = buyNowFromDetailBtn.getAttribute('href');
                if (link) {
                    window.open(link, '_blank');
                } else {
                    showToast("No direct purchase link available for this project yet.", 'accent');
                }
            });


            cartCheckoutBtn.addEventListener('click', () => {
                const totalAmount = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
                if (totalAmount === 0) {
                    showToast("Your cart is empty!", 'accent');
                    return;
                }
                if (!auth.currentUser) {
                    showToast("Please login to proceed to checkout.", 'accent');
                    authModal.style.display = 'flex'; // Use flex to match modal-overlay-center
                    return;
                }
                const options = {
                    key: "rzp_live_4cpkH5xviXonf3",
                    amount: totalAmount * 100,
                    currency: "INR",
                    name: "E-TECH SOLUTIONS",
                    description: "Project Purchase",
                    image: "https://lh3.googleusercontent.com/pw/AP1GczMFGvwVU32NSsKv5V5pVdolG2i9-eEUBOupJmE6wvE5hKb08fmmPauG62OnGUmD0esm9pa-d285g6XBzAxuULCghMe8Obxi1mUTI3LcaMuGB0IJz-5-=w2400",
                    handler: (response) => {
                        const orderData = {
                            userId: auth.currentUser.uid,
                            orderId: response.razorpay_payment_id,
                            items: JSON.stringify(cart),
                            totalAmount: totalAmount,
                            timestamp: firebase.firestore.FieldValue.serverTimestamp()
                        };
                        
                        const userId = auth.currentUser?.uid || crypto.randomUUID();
                        db.collection(`artifacts/${appId}/users/${userId}/orders`).add(orderData)
                            .then(() => {
                                showToast(`Payment Successful! Order ID: ${response.razorpay_payment_id}`, 'secondary');
                                cart = [];
                                updateCart();
                                cartModal.classList.remove('open');
                            })
                            .catch((error) => {
                                console.error("Error adding document: ", error);
                                showToast("Error saving order details.", 'accent');
                            });
                    },
                    prefill: { name: auth.currentUser.displayName, email: auth.currentUser.email },
                    theme: { color: "#00e5ff" }
                };
                const rzp = new Razorpay(options);
                rzp.on('payment.failed', (response) => {
                    showToast(`Payment Failed: ${response.error.description}`, 'accent');
                });
                rzp.open();
            });

            // --- Order History Logic (Unchanged) ---
            orderHistoryBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (auth.currentUser) {
                    fetchOrderHistory(auth.currentUser.uid);
                } else {
                    authModal.style.display = 'flex';
                }
            });

            closeHistoryBtn.addEventListener('click', () => {
                orderHistoryModal.style.display = 'none';
            });

            async function fetchOrderHistory(currentUserId) {
                orderHistoryList.innerHTML = '<p class="text-center text-gray-500">Loading order history...</p>';
                orderHistoryModal.style.display = 'flex';
                try {
                    const querySnapshot = await db.collection(`artifacts/${appId}/users/${currentUserId}/orders`)
                        .orderBy("timestamp", "desc")
                        .get();
                    
                    if (querySnapshot.empty) {
                        orderHistoryList.innerHTML = '<p class="text-center text-gray-400">You have no past orders.</p>';
                        return;
                    }

                    let ordersHtml = '';
                    querySnapshot.forEach(doc => {
                        const order = doc.data();
                        const orderDate = order.timestamp ? new Date(order.timestamp.seconds * 1000).toLocaleString() : 'Date not available';
                        
                        let itemsHtml = '<ul class="list-disc ml-6 text-gray-400 text-sm">';
                        const items = JSON.parse(order.items);
                        items.forEach(item => {
                            itemsHtml += `<li>${item.name} (x${item.quantity}) - â‚¹${item.price}</li>`;
                        });
                        itemsHtml += '</ul>';

                        ordersHtml += `
                            <div class="glassmorphism p-4 rounded-lg neon-border mb-4 border-secondary/50">
                                <div class="flex justify-between items-center text-sm mb-2 text-gray-500">
                                    <span>${orderDate}</span>
                                    <span class="truncate ml-2">ID: ${order.orderId.substring(0, 10)}...</span>
                                </div>
                                ${itemsHtml}
                                <div class="text-right font-bold mt-2 text-secondary">
                                    Total: â‚¹${order.totalAmount}
                                </div>
                            </div>
                        `;
                    });
                    orderHistoryList.innerHTML = ordersHtml;

                } catch (error) {
                    console.error("Error fetching order history: ", error);
                    orderHistoryList.innerHTML = '<p class="text-center text-accent">Could not load order history. Please try again later.</p>';
                }
            }


            // --- Parallax Scrolling Effect (Unchanged) ---
            const sections = document.querySelectorAll('.section');
            window.addEventListener('scroll', () => {
                const scrollTop = window.pageYOffset;
                sections.forEach(section => {
                    const rect = section.getBoundingClientRect();
                    const offset = rect.top + scrollTop;
                    const parallaxFactor = (scrollTop - offset) * 0.05;
                    section.style.transform = `translateY(${parallaxFactor}px)`;
                });
            });
            
            // --- NEW: Scroll-to-Hide Header Logic ---
            let lastScrollTop = 0;
            const scrollThreshold = 50; 
            
            window.addEventListener('scroll', () => {
                const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                // Only hide/show if the scroll movement is significant and the mobile menu is closed
                if (window.innerWidth <= 768 && !navMenu.classList.contains('active')) {
                    if (currentScrollTop > lastScrollTop && currentScrollTop > scrollThreshold) {
                        // Scrolling down
                        mainHeader.classList.add('header-hidden');
                    } else if (currentScrollTop < lastScrollTop) {
                        // Scrolling up
                        mainHeader.classList.remove('header-hidden');
                    }
                } else if (window.innerWidth > 768) {
                    // Always show header on desktop
                    mainHeader.classList.remove('header-hidden');
                }
                
                lastScrollTop = currentScrollTop <= 0 ? 0 : currentScrollTop; // For Mobile or negative scrolling
            });

            // --- Mobile Menu Toggle and Auto-Hide Logic (Modified) ---
            mobileToggle.addEventListener('click', () => navMenu.classList.toggle('active'));

            // Auto-hide when a link is clicked (on mobile only)
            mobileNavLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 768) {
                        navMenu.classList.remove('active');
                        // Ensure header becomes visible if navigation is used
                        mainHeader.classList.remove('header-hidden'); 
                    }
                });
            });

            // --- Auth Modal Logic (Unchanged) ---
            // NOTE: Changing classList.remove/add('hidden') to element.style.display for centering consistency
            loginBtnNav.addEventListener('click', (e) => { e.preventDefault(); authModal.style.display = 'flex'; });
            closeAuthBtn.addEventListener('click', () => authModal.style.display = 'none');
            window.addEventListener('click', (e) => { if (e.target == authModal) authModal.style.display = 'none'; });
            authTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    authTabs.forEach(item => item.classList.remove('active', 'text-secondary'));
                    tab.classList.add('active', 'text-secondary');
                    authForms.forEach(form => form.classList.add('hidden'));
                    document.getElementById(tab.dataset.tab + '-form').classList.remove('hidden');
                });
            });
            
            // --- FIX: Google Sign-In Function using signInWithRedirect (Unchanged) ---
            googleLoginBtn.addEventListener('click', async (e) => {
                e.preventDefault();
                const provider = new firebase.auth.GoogleAuthProvider();
                try {
                    // Use signInWithRedirect instead of signInWithPopup to avoid environment security restrictions
                    await auth.signInWithRedirect(provider); 
                    // Note: Execution stops here as the page redirects.
                } catch (error) {
                    console.error("Google Sign-In Error (Pre-Redirect):", error);
                    showToast(`Google Sign-In Failed: ${error.message.split(' (')[0]}`, 'accent');
                }
            });
            // --- END FIX: Google Sign-In Function ---

            // --- Firebase Auth Listener & Profile Setup (Unchanged) ---
            auth.onAuthStateChanged(user => {
                if (user) {
                    userId = user.uid;
                    loginBtnNav.classList.add('hidden');
                    userStatus.classList.remove('hidden');
                    userName.textContent = user.displayName || user.email;
                    userAvatar.textContent = (user.displayName || user.email).charAt(0).toUpperCase();
                    
                    // Set up Firestore listener for the current user's progress
                    setupProgressListener(user.uid);
                    // document.getElementById('skill-tree-status').textContent = "Double-click a node to mark as complete/incomplete!";
                    // suggestionsSidebar.classList.remove('opacity-50', 'pointer-events-none');
                } else {
                    userId = null;
                    loginBtnNav.classList.remove('hidden');
                    userStatus.classList.add('hidden');
                    setupProgressListener(null); // Stop listener and clear progress
                    // document.getElementById('skill-tree-status').textContent = "Log in to view your personalized progress.";
                    // suggestionsSidebar.classList.add('opacity-50', 'pointer-events-none');
                }
            });
            
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                auth.signInWithEmailAndPassword(loginForm['login-email'].value, loginForm['login-password'].value)
                    .then(() => { 
                        authModal.style.display = 'none'; 
                    })
                    .catch(error => console.error(error.message));
            });

            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                auth.createUserWithEmailAndPassword(registerForm['register-email'].value, registerForm['register-password'].value)
                    .then(cred => cred.user.updateProfile({ displayName: registerForm['register-name'].value }))
                    .then(() => { 
                        authModal.style.display = 'none'; 
                    })
                    .catch(error => console.error(error.message));
            });
            
            // Update the general logout button and add profile modal logic
            logoutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                auth.signOut().then(() => {
                    profileModal.style.display = 'none';
                    showToast("Signed out successfully.");
                });
            });
            profileLogoutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                auth.signOut().then(() => {
                    profileModal.style.display = 'none';
                    showToast("Signed out successfully.");
                });
            });

            // --- Profile Modal Logic (Unchanged) ---
            userAvatar.addEventListener('click', () => {
                const user = auth.currentUser;
                if (!user) return;
                
                profileDisplayName.textContent = user.displayName || 'N/A';
                profileEmail.textContent = user.email || 'N/A';
                profileUserId.textContent = user.uid;
                
                profileModal.style.display = 'flex';
            });

            closeProfileBtn.addEventListener('click', () => profileModal.style.display = 'none');

            editProfileBtn.addEventListener('click', () => {
                 const newName = prompt("Enter your new display name:");
                 if (newName && newName.trim()) {
                     auth.currentUser.updateProfile({ displayName: newName.trim() })
                        .then(() => {
                            showToast("Display name updated!", 'secondary');
                            profileDisplayName.textContent = newName.trim();
                            userName.textContent = newName.trim();
                            userAvatar.textContent = newName.trim().charAt(0).toUpperCase();
                        })
                        .catch(error => showToast(`Error updating name: ${error.message}`, 'accent'));
                 }
            });

            // --- START: Component Data Source (Expanded Content) ---
            const componentsData = {
                resistor: { 
                    title: "Resistor", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczM5DWsnmgZvpw6xGHEEEktIuWpG_2IgRAkg3UqDhJhLkhTGR-qN4sKz5KJGk59I7DljumSSSTUMvkmU1TBUu0ZcFo8Px9_2-Lbc3U5aFi3EHs1lw4w=w2400", 
                    definition: "A resistor is a passive two-terminal electrical component that implements electrical resistance as a circuit element. It opposes the flow of electric current.", 
                    symbol: "American-style: zigzag line (\\text{âš}), International Standard: rectangular box (\\text{â–¡}).", 
                    characteristics: ["Opposes the flow of electric current", "Measured in Ohms (\\Omega)", "Power rating determines how much heat it can dissipate", "Available in fixed and variable (potentiometer) types"], 
                    applications: "Used to reduce current flow, adjust signal levels, divide voltages, and terminate transmission lines." 
                },
                capacitor: { 
                    title: "Capacitor", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPIFWmSYlWVRR-_NyU_lEwCq2w6eiT4qLNVR0t6j_u3RJsQZ6gsJrlvSoMxB40_CnLlRBGS3lqfD2bFnKJYJAGAjpgmhxUOsyJHt9IEEeBaY3VSJ3M=w2400", 
                    definition: "A capacitor is a device that stores electrical energy in an electric field by accumulating electric charges on two closely spaced surfaces that are insulated from each other.", 
                    symbol: "Two parallel lines (\\text{||}).", 
                    characteristics: ["Stores electrical energy", "Measured in Farads (F)", "Voltage rating", "Equivalent series resistance (ESR)", "Polarity (for electrolytic capacitors)"], 
                    applications: "Energy storage, power conditioning, signal coupling, noise filtering, and timing circuits." 
                },
                inductor: {
                    title: "Inductor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOKm6h3B8Y1XzU1Qo5FjM2Yd7D2H2w2Qh7v4e2Z2Zl9v0h2W2F6H2o0Z_v9w_20e4o2k5A1H8j1o7e8k-5y5y5o2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "An inductor, also known as a coil or choke, is a passive two-terminal electrical component that stores energy in a magnetic field when electric current flows through it.",
                    symbol: "Series of curved lines (\\text{âˆ¿})",
                    characteristics: ["Stores energy in a magnetic field", "Measured in Henries (H)", "Opposes changes in current"],
                    applications: "Used in AC power supplies, filters, transformers, and resonant circuits."
                },
                diode: { 
                    title: "Diode", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPIGgW9jnLCV_xkerbMAlFm4i22hiFNcMnGwhHzJhlOkd47lhbaSlq3AMgDvUFJ-JebDt2yAabU__TTkfLRHcJgUjDNO4iAhQMgPjOfKvCuYjHWniA=w2400", 
                    definition: "A diode is a semiconductor device that essentially acts as a one-way switch for current. It allows current to flow easily in one direction but severely restricts it in the opposite direction.", 
                    symbol: "A triangle pointing towards a vertical line (\\text{âž¡ï¸|}).", 
                    characteristics: ["Allows current to flow in one direction only", "Forward voltage drop (typically 0.7V for silicon diodes)", "Reverse breakdown voltage"], 
                    applications: "Rectification (converting AC to DC), voltage regulation (Zener diodes), signal demodulation, over-voltage protection, and light emission (LEDs)." 
                },
                transistor: { 
                    title: "Transistor", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOmfnJTs0Ee3i2ff3Sgp1_z5Egi40fXXU_ROMRHsj2U-TW8rJMg4VPMTmjk6_2UXYLotzUnwz-9FWZd0fXazbzeaRKIywkFrNYH11AmsmLdikoPzUA=w2400", 
                    definition: "A transistor is a semiconductor device used to amplify or switch electronic signals and electrical power.", 
                    symbol: "For NPN: Arrow pointing out from the base, for PNP: Arrow pointing toward the base.", 
                    characteristics: ["Three terminals: emitter, base, and collector", "Current gain (\\beta)", "Maximum voltage and current ratings", "Switching speed"], 
                    applications: "Amplifiers, electronic switches, digital logic gates, voltage regulators, and oscillators." 
                },
                ic: {
                    title: "Integrated Circuit (IC)",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczODx-Vv2K4k5h7v-M_5r3l4p9Q4p5-p5f4a7j1Q1d5f3j1o8f5k-e8t-d6f7l2-k7p8p9t3f3t6a7r4s5o2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "An integrated circuit (IC) is a miniaturized electronic circuit consisting of semiconductor devices, passive components, and wiring, all on a single chip.",
                    symbol: "Usually a rectangle with pins and a functional block diagram inside.",
                    characteristics: ["High density of components", "Small size and weight", "Performs complex functions", "Can be analog, digital, or mixed-signal"],
                    applications: "Microprocessors, memory chips, amplifiers, timers, and logic circuits."
                },
                'arduino-uno': {
                    title: "Arduino Uno",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPj2b8n_p2_d_d8r3t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "The Arduino Uno is a microcontroller board based on the ATmega328P. It's the most popular and versatile board for beginners due to its simplicity and extensive documentation.",
                    symbol: "A drawing of the Arduino Uno board.",
                    characteristics: ["Microcontroller: ATmega328P", "Digital I/O Pins: 14 (6 with PWM)", "Analog Inputs: 6", "Clock Speed: 16 MHz", "Memory: 32 KB Flash, 2 KB SRAM"],
                    applications: "Introductory projects, educational kits, simple robotics, and home automation."
                },
                'arduino-nano': {
                    title: "Arduino Nano",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczMxDJ1DYRkYFc8XHzRXvRxWvtAxdtZKdSKIgwEaQKvaE1ta6iS3ArcMxN1A_oID7ZwX2NFgLe_ZlARx5cteynnTuRrmwbkG_WY3em8GK2KF5B9M6vE=w2400",
                    definition: "The Arduino Nano is a small, complete, and breadboard-friendly board based on the ATmega328P. It's ideal for projects where space is a concern.",
                    symbol: "A drawing of the Arduino Nano board.",
                    characteristics: ["Microcontroller: ATmega328P", "Digital I/O Pins: 14 (6 with PWM)", "Analog Inputs: 8", "Clock Speed: 16 MHz", "Memory: 32 KB Flash, 2 KB SRAM"],
                    applications: "Compact projects, wearable electronics, small robots, and DIY gadgets."
                },
                'arduino-mega': {
                    title: "Arduino Mega",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczMmkQtt_r5x6efheqMEzQSETivFrbS7uwLexrsAqTUyihi7SgPYaqbafao3anY1RooXH5jEc9Pr3zswdPusbrZ83K0ZshkZOm2KANi5ih_T0HTEl-k=w2400",
                    definition: "The Arduino Mega 2560 is a microcontroller board based on the ATmega2560. It is designed for more complex projects that require more I/O pins, memory, and communication ports.",
                    symbol: "A drawing of the Arduino Mega board.",
                    characteristics: ["Microcontroller: ATmega2560", "Digital I/O Pins: 54 (15 with PWM)", "Analog Inputs: 16", "Clock Speed: 16 MHz", "Memory: 256 KB Flash, 8 KB SRAM"],
                    applications: "3D printers, complex robotics, data loggers, and projects with multiple sensors and actuators."
                },
                esp32: {
                    title: "ESP32",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczMxDJ1DYRkYFc8XHzRXvRxWvtAxdtZKdSKIgwEaQKvaE1ta6iS3ArcMxN1A_oID7ZwX2NFgLe_ZlARx5cteynnTuRrmwbkG_WY3em8GK2KF5B9M6vE=w2400",
                    definition: "The ESP32 is a series of low-cost, low-power system on a chip microcontrollers with integrated Wi-Fi and dual-mode Bluetooth.",
                    symbol: "A chip with an antenna.",
                    characteristics: ["Integrated Wi-Fi and Bluetooth", "Dual-core processor", "Low-power consumption", "High number of GPIO pins"],
                    applications: "Internet of Things (IoT) projects, smart home devices, wearable electronics, and mesh network applications."
                },
                raspberrypi: {
                    title: "Raspberry Pi Pico",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPHWYIWyDHIoI8jrNslElD9kybYvRDS8gEVGb1uZk2Hohh-V9klz8cATkS8vGcw0E7UOuMVb56ltuUOpPdy-U0Lak2WUIcCX12X4i3VEKcbGtjDbZg=w2400",
                    definition: "The Raspberry Pi Pico is a powerful, low-cost microcontroller board from the Raspberry Pi Foundation, featuring their own RP2040 chip.",
                    symbol: "A drawing of the Raspberry Pi Pico board.",
                    characteristics: ["Dual-core ARM Cortex-M0+ processor", "High-performance and low-power", "Flexible I/O with Programmable I/O (PIO)", "Supports MicroPython and C/C++ programming"],
                    applications: "Robotics, digital art projects, embedded machine learning, and hardware interfacing."
                },
                stm32: {
                    title: "STM32",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPj2b8n_p2_d_d8r3t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "STM32 is a family of 32-bit microcontroller integrated circuits by STMicroelectronics, based on the ARM Cortex-M processor.",
                    symbol: "A series of chips.",
                    characteristics: ["High processing power", "Wide variety of peripherals", "Low-power modes", "Used in professional and industrial applications"],
                    applications: "Industrial control, motor control, medical devices, consumer electronics, and automotive systems."
                },
                avr: {
                    title: "AVR",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOh7-k6R4p4m7g0j-m4p5j9y3s2f7h1e1p8w8x3g7l9d4u1q1c5a7p5y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "AVR is a family of microcontrollers developed by Atmel (now part of Microchip Technology) and are known for their simplicity and efficiency.",
                    symbol: "A chip.",
                    characteristics: ["8-bit and 32-bit architectures", "RISC instruction set", "On-chip Flash memory and SRAM", "Used in Arduino boards"],
                    applications: "Hobby electronics, educational kits, embedded systems, and consumer appliances."
                },
                pic: {
                    title: "PIC",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczM_5g_3p8_d1q9p4n7j9t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "PIC (Peripheral Interface Controller) is a family of microcontrollers by Microchip Technology, known for their simple architecture and wide availability.",
                    symbol: "A chip.",
                    characteristics: ["Low-power consumption", "RISC architecture", "Extensive peripheral support", "Used in a wide range of applications"],
                    applications: "Consumer electronics, automotive systems, industrial control, and embedded systems."
                },
                ultrasonic: { 
                    title: "Ultrasonic Sensor", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczMr6sKqBE4JXSzECuWVL8JAn7xYFqihazO-x5Re1IOGe-1eFwimuW-ASLWk1_NBAqo5nc8YUJJWuybEiRdhy_rRc0oiB85hiZs-cVutP8x361z3tDg=w2400", 
                    definition: "An ultrasonic sensor is an electronic device that measures the distance to an object by emitting and receiving high-frequency sound waves.", 
                    symbol: "Typically represented with a speaker and microphone symbols.", 
                    characteristics: ["Operating frequency: 40 kHz", "Measures distance to objects", "Requires trigger and echo pins", "Reliable in various lighting conditions"], 
                    applications: "Obstacle detection, liquid level measurement, robotics, and parking assistance." 
                },
                pir: {
                    title: "PIR Motion Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOCqXW3n6d-t_y5K8y2T8s0r8W0w2E6q2n8v3a0g4w5g6s8x1d6l8f9y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "A Passive Infrared (PIR) sensor is an electronic sensor that measures infrared (IR) light radiating from objects in its field of view, detecting motion.",
                    symbol: "Typically represented as a semi-circle with lines radiating outward.",
                    characteristics: ["Detects motion by sensing heat changes", "Passive sensor (does not emit energy)", "Adjustable sensitivity and delay time", "Commonly used in security systems"],
                    applications: "Security alarms, automatic lighting systems, motion-activated cameras, and smart home devices."
                },
                temperature: {
                    title: "Temperature Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPg1wW7-p9g_T4Z3y8s7h9q7l2a3b4c5d6e7f8g9h0i1j1k1l1m4o4q1r2s3t3u3v3w3x3y3z3a2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "A temperature sensor is a device, typically a thermocouple or thermistor, that measures temperature and converts it into an electrical signal.",
                    symbol: "A circle with a thermometer-like symbol inside.",
                    characteristics: ["Measures temperature in Celsius, Fahrenheit, or Kelvin", "Can be analog or digital", "Varying degrees of accuracy"],
                    applications: "Weather stations, thermostats, smart home devices, and industrial process control."
                },
                humidity: {
                    title: "Humidity Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczO2gVb_j1l2o6o4h5t8i0x1n2p7q9r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1-R-1n2p7Q3E=w2400",
                    definition: "A humidity sensor, also known as a hygrometer, is a device that detects and measures the amount of water vapor in the air.",
                    symbol: "A circle with a water drop symbol inside.",
                    characteristics: ["Measures relative humidity (RH)", "Can be combined with a temperature sensor (e.g., DHT11)", "Crucial for indoor climate control and agriculture"],
                    applications: "Weather stations, smart greenhouses, humidifiers, and HVAC systems."
                },
                light: {
                    title: "Light Sensor (LDR)",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOaQc-e1i5k3e2h3i4j5k6l7m8n9o0p1q1r2s3t3u4v5w5x3y2z1a2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "A Light-Dependent Resistor (LDR) or photoresistor is a component whose resistance decreases with increasing incident light intensity.",
                    symbol: "A resistor symbol with a circle around it and arrows pointing in.",
                    characteristics: ["Resistance changes with light intensity", "Simple and inexpensive", "Used in analog light-sensing circuits"],
                    applications: "Automatic street lights, light-activated alarms, and camera light meters."
                },
                gas: {
                    title: "Gas Sensor (MQ series)",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczO4wUaCNA1YtgMGIXYfHBkPdXIqv-Nhm_jU-060QjUuy9Q1U75Pa6ci1l1qujYxvj_5dAwSEQIrGfvpzaYh1UnLwHCroOo=w2400",
                    definition: "Gas sensors, like the MQ series, are electronic devices used to detect the presence and concentration of various gases in the air.",
                    symbol: "A rectangle with a gas-like symbol inside.",
                    characteristics: ["Detects gases like CO, LPG, smoke, alcohol", "Output is an analog signal that varies with gas concentration", "Requires a pre-heating period to operate"],
                    applications: "Gas leak detection, air quality monitoring, fire alarms, and breathalyzers."
                },
                soilmoisture: {
                    title: "Soil Moisture Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPSn8S_b2V4h3T9c8d6i5j7k_2L1V7d3w8x3g7h5i1j1k1l1m4o4q1r2s3t3u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1-R-1n2p7Q3E=w2400",
                    definition: "A soil moisture sensor measures the volumetric water content in the soil. It works by measuring the dielectric permittivity of the soil.",
                    symbol: "A fork-like symbol with a water drop.",
                    characteristics: ["Measures water content in soil", "Analog or digital output", "Can be sensitive to corrosion"],
                    applications: "Smart agriculture, automated plant watering systems, and gardening."
                },
                rfid: {
                    title: "RFID Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPj2b8n_p2_d_d8r3t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "RFID (Radio-Frequency Identification) uses radio waves to wirelessly transfer data from an RFID tag to a reader.",
                    symbol: "A circle with radio waves emanating from it.",
                    characteristics: ["Non-contact identification", "Can read multiple tags simultaneously", "Different operating frequencies (low, high, ultra-high)", "Tags can be active or passive"],
                    applications: "Access control systems, asset tracking, inventory management, and contactless payments."
                },
                accelerometer: {
                    title: "Accelerometer",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOHx-Vv2K4k5h7v-M_5r3l4p9Q4p5-p5f4a7j1Q1d5f3j1o8f5k-e8t-d6f7l2-k7p8p9t3f3t6a7r4s5o2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "An accelerometer is a device that measures proper acceleration, a three-axis vector quantity.",
                    symbol: "A circle with a gear-like symbol inside.",
                    characteristics: ["Measures acceleration, tilt, and vibration", "Can detect static and dynamic forces", "Used in conjunction with a gyroscope for orientation"],
                    applications: "Motion-activated games, drones, self-balancing robots, and wearables."
                },
                sound: {
                    title: "Sound Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPg1wW7-p9g_T4Z3y8s7h9q7l2a3b4c5d6e7f8g9h0i1j1k1l1m4o4q1r2s3t3u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1-R-1n2p7Q3E=w2400",
                    definition: "A sound sensor, also known as a sound detector or microphone module, is a device that detects sound waves and converts them into electrical signals.",
                    symbol: "A circle with a microphone symbol inside.",
                    characteristics: ["Detects sound levels and frequency", "Can be analog or digital", "Sensitivity can often be adjusted"],
                    applications: "Sound-activated switches, voice-controlled systems, and noise monitoring."
                },
                heartbeat: {
                    title: "Heartbeat Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczN_Vv-o4s_t-x-y-z-1u-2v-3w-4x-5g-8w-9f-8d-8g-8h-9j9k8l8m7n7o5p4q3r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1-R-1n2p7Q3E=w2400",
                    definition: "A heartbeat sensor is a device that measures the rate of heartbeat. It works on the principle of photoplethysmography (PPG) to detect changes in blood volume in the fingertip.",
                    symbol: "A heart with a pulse line.",
                    characteristics: ["Measures heart rate in BPM", "Non-invasive", "Requires a finger to be placed on the sensor pad"],
                    applications: "Health monitoring devices, fitness trackers, and stress level indicators."
                },
                gesture: {
                    title: "Gesture Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPj2b8n_p2_d_d8r3t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "A gesture sensor is an electronic device that can recognize and interpret human gestures, such as hand movements. It uses infrared light to detect proximity and motion.",
                    symbol: "A hand icon with motion lines.",
                    characteristics: ["Detects gestures like wave, swipe, and scroll", "Works with infrared light", "Provides non-contact control"],
                    applications: "Human-computer interaction (HCI), touchless switches, and robotics control."
                }
                // ... (other components truncated for brevity)
              
            };
            // --- END: Component Data Source (Expanded Content) ---


            // FIX: Component Data Display Logic
            componentCards.forEach(card => {
                card.addEventListener('click', () => {
                    const componentType = card.dataset.component;
                    const compData = componentsData[componentType];
                    
                    // Close other modals before opening component modal
                    if (projectDetailModal) projectDetailModal.style.display = 'none';
                    
                    stopSensorVisualization(); // Stop any existing visualization

                    if (compData) {
                        detailTitle.textContent = compData.title;
                        detailImg.src = compData.img;
                        detailDefinition.textContent = compData.definition;
                        
                        // Show/Hide Sensor Visualization Area
                        if (compData.isSensor) {
                            sensorVizArea.classList.remove('hidden');
                            if (compData.sensorType === 'ultrasonic') {
                                // Only start the complex mock for the specified Ultrasonic Sensor
                                startSensorVisualization('ultrasonic');
                            } else {
                                sensorDataReadout.textContent = `Live Mock unavailable for ${compData.title}.`;
                            }
                        } else {
                            sensorVizArea.classList.add('hidden'); // Ensure it's hidden for non-sensors
                        }
                        
                        try {
                            const tempDiv = document.createElement('div');
                            const latexString = compData.symbol.replace(/\\text\{/g, '\\text{').replace(/}/g, '}');
                            
                            if (latexString.includes('\\Omega') || latexString.includes('\\text{') || latexString.includes('}')) {
                                katex.render(latexString, detailSymbol, { displayMode: false, throwOnError: true });
                            } else {
                                detailSymbol.textContent = compData.symbol;
                            }
                        } catch (e) {
                             console.error("KaTeX rendering failed:", e);
                             detailSymbol.textContent = compData.symbol; 
                        }

                        detailCharacteristics.innerHTML = compData.characteristics.map(char => `<li>${char}</li>`).join('');
                        
                        detailCharacteristics.querySelectorAll('li').forEach(li => {
                            if (window.renderMathInElement) {
                                renderMathInElement(li);
                            }
                        });
                        
                        detailApplications.textContent = compData.applications;
                        
                        askTechwhizComponentBtn.dataset.componentName = compData.title;

                        componentDetailModal.style.display = 'flex'; // This line ensures immediate display
                    } else {
                        // Fallback if data is missing
                        detailTitle.textContent = "Data Unavailable";
                        detailImg.src = "https://via.placeholder.com/400x300/333333/ffffff?text=No+Image";
                        detailDefinition.textContent = "Detailed information for this component is currently under construction.";
                        detailSymbol.textContent = "N/A";
                        detailCharacteristics.innerHTML = '<li>Check back soon!</li>';
                        detailApplications.textContent = "N/A";
                        askTechwhizComponentBtn.dataset.componentName = componentType;
                        componentDetailModal.style.display = 'flex'; // This line ensures immediate display
                    }
                });
            });

            closeDetailBtn.addEventListener('click', () => { 
                componentDetailModal.style.display = 'none'; 
                stopSensorVisualization(); // Stop visualization when closing
            });
            
            // Close component modal if clicking outside
            componentDetailModal.addEventListener('click', (e) => {
                if (e.target === componentDetailModal) {
                    componentDetailModal.style.display = 'none';
                    stopSensorVisualization(); // Stop visualization when closing
                }
            });

            // NEW: Contextual AI button handler (Unchanged)
            askTechwhizComponentBtn.addEventListener('click', () => {
                const componentName = askTechwhizComponentBtn.dataset.componentName || 'this component';
                const prompt = `Explain the key function and most common applications of the ${componentName} for a beginner in electronics.`;
                
                // Close component modal and open TechWhiz modal
                componentDetailModal.style.display = 'none';
                stopSensorVisualization(); // Stop visualization before moving
                techwhizModal.style.display = 'flex';
                
                // Inject prompt into chat input and trigger submission
                techwhizInput.value = prompt;
                sendBtn.click();
            });

            // --- TechWhiz Assistant Logic (Updated for full functionality) ---
            let recognition;
            let isListening = false;
            const synth = window.speechSynthesis;
            let currentUtterance = null;
            const geminiApiKey = "AIzaSyCODRIZL8mNqWpUf0HdWcoCedimZM_0G5E"; // Using empty string for auto-injection

            techwhizFab.addEventListener('click', () => techwhizModal.style.display = 'flex');
            closeTechwhizModalBtn.addEventListener('click', () => {
                techwhizModal.style.display = 'none';
                if (synth.speaking) synth.cancel();
                if (isListening) recognition.stop();
            });

            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';

                recognition.onstart = () => {
                    isListening = true;
                    micBtn.classList.add('speech-active');
                    listeningStatus.classList.remove('hidden');
                };
                
                recognition.onresult = (event) => { 
                    const transcript = event.results[0][0].transcript;
                    techwhizInput.value = transcript;
                    // Automatically process the command once transcribed
                    processCommand(transcript);
                };

                recognition.onerror = (event) => {
                    console.error('Speech Recognition Error:', event.error);
                    showToast(`Voice command error: ${event.error}`, 'accent');
                    isListening = false;
                    micBtn.classList.remove('speech-active');
                    listeningStatus.classList.add('hidden');
                    techwhizInput.disabled = false;
                    sendBtn.disabled = false;
                    micBtn.disabled = false;
                    thinkingStatus.classList.add('hidden');
                };

                recognition.onend = () => {
                    // Only perform cleanup if recognition stops naturally or by error, 
                    // but not if it stops because a command was successfully processed (which calls processCommand)
                    if (isListening) { 
                        isListening = false;
                        micBtn.classList.remove('speech-active');
                        listeningStatus.classList.add('hidden');
                        // No need to re-enable mic/input here as processCommand's finally block handles it.
                    }
                };
            } else {
                micBtn.disabled = true;
                showToast("Speech recognition not supported in this browser.", 'accent');
            }

            micBtn.addEventListener('click', () => { 
                if (isListening) { 
                    recognition.stop(); 
                } else { 
                    techwhizInput.value = ''; 
                    recognition.start(); 
                } 
            });

            sendBtn.addEventListener('click', () => { 
                if (isListening) {
                    recognition.stop();
                } 
                const command = techwhizInput.value.trim(); 
                if (command) processCommand(command); 
            });
            
            techwhizInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendBtn.click(); });
            stopSpeechBtn.addEventListener('click', () => { if (synth.speaking) synth.cancel(); });

            function appendMessage(message, sender) { 
                const msgDiv = document.createElement('div'); 
                msgDiv.className = `chat-message p-3 rounded-lg max-w-[85%] w-fit ${sender === 'user' ? 'bg-secondary text-white rounded-br-none self-end ml-auto' : 'bg-gray-800 text-white rounded-bl-none self-start mr-auto'}`; 
                msgDiv.textContent = message; 
                chatHistory.prepend(msgDiv);
                if(chatHistory.childElementCount > 10) {
                  chatHistory.removeChild(chatHistory.lastChild);
                }
            }

            function readAloud(text) { 
                if (synth.speaking) synth.cancel(); 
                currentUtterance = new SpeechSynthesisUtterance(text); 
                currentUtterance.onend = () => currentUtterance = null; 
                synth.speak(currentUtterance); 
            }

            // --- NEW: Handle UI and Predefined Commands
            function handleUICommand(lowerCommand) {
                let action = { executed: false, response: '' };

                // 1. Greetings / Simple Predefined Responses
                if (lowerCommand.includes('hello') || lowerCommand.includes('hi') || lowerCommand.includes('what up')) {
                    action.executed = true;
                    action.response = "Hello! I am TechWhiz, your electronics and CSE assistant. How can I assist you with your learning today?";
                } else if (lowerCommand.includes('your name') || lowerCommand.includes('who are you')) {
                    action.executed = true;
                    action.response = "I am TECHWHIZ, a helpful assistant powered by Google's Gemini API, designed to assist you with electronics and computer science projects.";
                } else if (lowerCommand.includes('what can you do') || lowerCommand.includes('your capabilities')) {
                    action.executed = true;
                    action.response = "I can help you with electronics and computer science concepts, suggest projects, provide career advice, and even help with debugging and code explanation. Just ask!";
                } else if (lowerCommand.includes('about this website') || lowerCommand.includes('about this html file')) {
                    action.executed = true;
                    action.response = "This is the E-TECH SOLUTIONS dynamic e-learning portal. It offers various courses in electronics and computer science, features user authentication, tracks course progress, and integrates payment options.";
                }

               else if (lowerCommand.includes('what can you do') || lowerCommand.includes('your capabilities')) {
                       action.executed = true;
                     action.response = "I can assist you with course information, generate quizzes, suggest projects, provide career advice, troubleshoot issues, explain code, suggest components, help draft lab reports, and much more related to electronics and IoT learning!";
} else if (lowerCommand.includes('help') || lowerCommand.includes('support')) {
    action.executed = true;
    action.response = "Sure! You can ask me about course details, generate quizzes, suggest project ideas, get career advice, troubleshoot problems, explain code snippets, suggest electronic components, and assist with lab report drafting. How can I assist you today?";
} else if (lowerCommand.includes('about this website') || lowerCommand.includes('about this html file')) {
    action.executed = true;
    action.response = "This is the E-TECH SOLUTIONS dynamic e-learning portal. It offers various courses in electronics and IoT, features user authentication, tracks course progress, and integrates payment options.";
} else if (lowerCommand.includes('generate a quiz') || lowerCommand.includes('make a quiz')) {
    action.executed = true;
    action.response = "To generate a quiz, please specify the course name or topic you'd like the quiz to be about.";
} else if (lowerCommand.includes('suggest a project') || lowerCommand.includes('project idea')) {
    action.executed = true;
    action.response = "To suggest a project idea, please provide the course name or specific area of interest within electronics or IoT.";
} else if (lowerCommand.includes('career advice') || lowerCommand.includes('career path')) {
    action.executed = true;
    action.response = "For career advice, please specify your area of interest or the course you are pursuing, and I can provide tailored suggestions.";
} else if (lowerCommand.includes('what is arduino') || lowerCommand.includes('define arduino')) {
    action.executed = true;
    action.response = "Arduino is an open-source electronics platform that makes it easy to create a wide variety of interactive electronic objects and projects. It consists of two main parts: a physical programmable circuit board, known as a microcontroller, and a piece of software, or IDE (Integrated Development Environment), that runs on your computer. You use the IDE to write and upload code to the physical board.";
} else if (lowerCommand.includes('what is a resistor') || lowerCommand.includes('resistor')) {
    action.executed = true;
    action.response = "A resistor is a passive two-terminal electrical component that implements electrical resistance as a circuit element. In electronic circuits, resistors are used to reduce current flow, adjust signal levels, to divide voltages, bias active elements, and terminate transmission lines, among other uses.";
} else if (lowerCommand.includes('what is a capacitor') || lowerCommand.includes('capacitor')) {
    action.executed = true;
    action.response = "A capacitor is a passive two-terminal electrical component that stores electrical energy in an electric field. The effect of a capacitor is known as capacitance. While some capacitance exists between any two electrical conductors in proximity in a circuit, a capacitor is a component designed to add capacitance to a circuit.";
} else if (lowerCommand.includes('what is an inductor') || lowerCommand.includes('inductor')) {
    action.executed = true;
    action.response = "An inductor, also called a choke, is a passive two-terminal electrical component that stores energy in a magnetic field when electric current flows through it. An inductor typically consists of a conductor such as a wire, usually wound into a coil.";
} else if (lowerCommand.includes('what is a diode') || lowerCommand.includes('diode')) {
    action.executed = true;
    action.response = "A diode is a two-terminal electronic component that conducts current primarily in one direction; it has low (ideally zero) resistance in one direction, and high (ideally infinite) resistance in the other. It's often used for rectification, converting AC to DC.";
} else if (lowerCommand.includes('what is a transistor') || lowerCommand.includes('transistor')) {
    action.executed = true;
    action.response = "A transistor is a semiconductor device used to amplify or switch electronic signals and electrical power. It is one of the basic building blocks of modern electronics and is essential in digital circuits like microprocessors, and analog circuits like audio amplifiers.";
} else if (lowerCommand.includes('what is an LED') || lowerCommand.includes('LED')) {
    action.executed = true;
    action.response = "An LED (Light Emitting Diode) is a semiconductor light source that emits light when current flows through it. Electrons in the semiconductor recombine with electron holes, releasing energy in the form of photons. LEDs are very energy-efficient and have a long lifespan.";
} else if (lowerCommand.includes('what is a breadboard') || lowerCommand.includes('breadboard')) {
    action.executed = true;
    action.response = "A breadboard is a solderless construction base used for prototyping of electronics. It allows you to quickly build temporary circuits and experiment with different component arrangements without having to solder anything.";
} else if (lowerCommand.includes('what is Ohm\'s law') || lowerCommand.includes('ohms law') || lowerCommand.includes('define ohms law')) {
    action.executed = true;
    action.response = "Ohm's Law states that the current through a conductor between two points is directly proportional to the voltage across the two points. Mathematically, it's expressed as V = I * R, where V is voltage, I is current, and R is resistance.";
} else if (lowerCommand.includes('what is current') || lowerCommand.includes('define current')) {
    action.executed = true;
    action.response = "Electric current is the rate of flow of electric charge past a point or region. A common analogy is the flow of water in a pipe, where current is the amount of water flowing per unit time.";
} else if (lowerCommand.includes('what is voltage') || lowerCommand.includes('define voltage')) {
    action.executed = true;
    action.response = "Voltage, also known as electric potential difference, is the difference in electric potential energy between two points per unit electric charge. It represents the 'push' or 'force' that drives electric current.";
} else if (lowerCommand.includes('what is resistance') || lowerCommand.includes('define resistance')) {
    action.executed = true;
    action.response = "Electrical resistance is a measure of the opposition to the flow of electric current in an electrical circuit. It's measured in ohms (Î©). Materials with high resistance are insulators, and those with low resistance are conductors.";
} else if (lowerCommand.includes('what is an integrated circuit') || lowerCommand.includes('what is an IC') || lowerCommand.includes('IC')) {
    action.executed = true;
    action.response = "An Integrated Circuit (IC), sometimes called a microchip, is a set of electronic circuits on one small flat piece (or 'chip') of semiconductor material, usually silicon. ICs are used in virtually all electronic equipment today.";
} else if (lowerCommand.includes('what is a sensor') || lowerCommand.includes('define sensor')) {
    action.executed = true;
    action.response = "A sensor is a device, module, machine, or subsystem whose purpose is to detect events or changes in its environment and send the information to other electronics, frequently a computer processor. It's a key component in gathering data from the physical world.";
} else if (lowerCommand.includes('what is a microcontroller') || lowerCommand.includes('microcontroller')) {
    action.executed = true;
    action.response = "A microcontroller is a small computer on a single metal-oxide-semiconductor (MOS) integrated circuit chip. It contains one or more CPUs along with memory and programmable input/output peripherals. Microcontrollers are used in automatically controlled products and devices, such as automobile engine control systems, implantable medical devices, remote controls, office machines, appliances, power tools, and toys.";
} else if (lowerCommand.includes('what is a schematic') || lowerCommand.includes('schematic diagram')) {
    action.executed = true;
    action.response = "A schematic diagram is a representation of the elements of a system using abstract, graphic symbols rather than realistic pictures. A schematic diagram of an electronic circuit shows the components of the circuit as simplified shapes, and the power and signal connections between them.";
} else if (lowerCommand.includes('what is current flow direction') || lowerCommand.includes('conventional current')) {
    action.executed = true;
    action.response = "Conventional current is the concept that electric current flows from the positive terminal to the negative terminal, even though electrons (which carry the charge) actually flow in the opposite direction. It's a historical convention still widely used in circuit analysis.";
} else if (lowerCommand.includes('what is a series circuit') || lowerCommand.includes('series circuit')) {
    action.executed = true;
    action.response = "In a series circuit, components are connected end-to-end, forming a single path for the current to flow. The current is the same through each component, but the voltage drops across each component add up to the total voltage.";
} else if (lowerCommand.includes('what is a parallel circuit') || lowerCommand.includes('parallel circuit')) {
    action.executed = true;
    action.response = "In a parallel circuit, components are connected across the same two points, creating multiple paths for the current. The voltage across each component is the same, but the total current is the sum of the currents through each path.";
} else if (lowerCommand.includes('what is a logic gate') || lowerCommand.includes('logic gate')) {
    action.executed = true;
    action.response = "A logic gate is an elementary building block of a digital circuit. Most logic gates have two inputs and one output. At any given moment, every terminal is in one of the two binary conditions, low (0) or high (1).";
} else if (lowerCommand.includes('what is an AND gate') || lowerCommand.includes('AND gate')) {
    action.executed = true;
    action.response = "An AND gate is a digital logic gate that implements logical conjunction. It produces a high output (1) only if all its inputs are high (1). Otherwise, the output is low (0).";
} else if (lowerCommand.includes('what is an OR gate') || lowerCommand.includes('OR gate')) {
    action.executed = true;
    action.response = "An OR gate is a digital logic gate that implements logical disjunction. It produces a high output (1) if any of its inputs are high (1). The output is low (0) only if all inputs are low (0).";
} else if (lowerCommand.includes('what is a NOT gate') || lowerCommand.includes('inverter')) {
    action.executed = true;
    action.response = "A NOT gate, also known as an inverter, is a digital logic gate with one input and one output. It performs logical negation, producing a high output (1) if the input is low (0), and a low output (0) if the input is high (1).";
} else if (lowerCommand.includes('what is an XOR gate') || lowerCommand.includes('XOR gate')) {
    action.executed = true;
    action.response = "An XOR (Exclusive-OR) gate is a digital logic gate that produces a high output (1) if an odd number of its inputs are high (1). If both inputs are the same (both 0 or both 1), the output is low (0).";
} else if (lowerCommand.includes('what is a flip-flop') || lowerCommand.includes('flip flop')) {
    action.executed = true;
    action.response = "A flip-flop is a basic storage element in sequential logic circuits, capable of storing one bit of information. It has two stable states and is used as a fundamental building block of digital memory and sequential logic.";
} else if (lowerCommand.includes('what is combinational logic') || lowerCommand.includes('combinational logic')) {
    action.executed = true;
    action.response = "Combinational logic is a type of digital logic circuit whose output is purely a function of the present inputs. It does not contain memory elements and its output changes immediately when inputs change.";
} else if (lowerCommand.includes('what is sequential logic') || lowerCommand.includes('sequential logic')) {
    action.executed = true;
    action.response = "Sequential logic is a type of digital logic circuit whose output depends not only on the present inputs but also on the sequence of past inputs, due to the presence of memory elements (like flip-flops).";
} else if (lowerCommand.includes('what is a multiplexer') || lowerCommand.includes('mux')) {
    action.executed = true;
    action.response = "A multiplexer (MUX) is a device that selects one of several analog or digital input signals and forwards the selected input into a single output line. It's essentially a multi-input, single-output switch.";
} else if (lowerCommand.includes('what is a demultiplexer') || lowerCommand.includes('demux')) {
    action.executed = true;
    action.response = "A demultiplexer (DEMUX) is a device that takes a single input signal and selects one of many data-output-lines, which is connected to the single input. It's the inverse of a multiplexer, acting as a single-input, multi-output switch.";
} else if (lowerCommand.includes('what is an encoder') || lowerCommand.includes('encoder digital')) {
    action.executed = true;
    action.response = "An encoder is a combinational logic circuit that converts a non-binary input code to a binary output code. For example, it might convert a decimal digit input to a binary-coded decimal (BCD) output.";
} else if (lowerCommand.includes('what is a decoder') || lowerCommand.includes('decoder digital')) {
    action.executed = true;
    action.response = "A decoder is a combinational logic circuit that converts n input lines into $2^n$ output lines. Only one output line is active for a given input combination. It's often used to convert binary codes into human-readable outputs.";
} else if (lowerCommand.includes('what is a counter') || lowerCommand.includes('digital counter')) {
    action.executed = true;
    action.response = "A digital counter is a sequential logic circuit that counts specific events or pulses applied to its input. It can be implemented using flip-flops and can count up, down, or in various sequences.";
} else if (lowerCommand.includes('what is a register') || lowerCommand.includes('digital register')) {
    action.executed = true;
    action.response = "A register is a small amount of fast storage available to the CPU within a microcontroller or processor. It holds data that the CPU is currently working on, significantly speeding up data access.";
} else if (lowerCommand.includes('what is ADC') || lowerCommand.includes('Analog to Digital Converter')) {
    action.executed = true;
    action.response = "An Analog-to-Digital Converter (ADC) is an electronic circuit that converts a continuous analog signal (like temperature or sound) into a discrete digital signal. This allows digital systems to process real-world analog data.";
} else if (lowerCommand.includes('what is DAC') || lowerCommand.includes('Digital to Analog Converter')) {
    action.executed = true;
    action.response = "A Digital-to-Analog Converter (DAC) is an electronic circuit that converts a digital signal (a sequence of binary numbers) into an analog signal (a continuous voltage or current). It's the opposite of an ADC.";
} else if (lowerCommand.includes('what is a buffer') || lowerCommand.includes('digital buffer')) {
    action.executed = true;
    action.response = "In digital electronics, a buffer is a logic gate that simply passes its input to its output without changing its logical state. It's used primarily to provide current amplification (buffering) to drive multiple loads or to isolate circuits.";
} else if (lowerCommand.includes('what is CMOS') || lowerCommand.includes('CMOS logic')) {
    action.executed = true;
    action.response = "CMOS (Complementary Metal-Oxide-Semiconductor) is a technology for constructing integrated circuits. It uses complementary and symmetrical pairs of p-type and n-type MOSFETs for logic functions, known for low power consumption.";
} else if (lowerCommand.includes('what is TTL') || lowerCommand.includes('TTL logic')) {
    action.executed = true;
    action.response = "TTL (Transistor-Transistor Logic) is a class of digital logic circuits constructed from bipolar junction transistors. It was widely used for digital ICs, known for its speed, but typically consumes more power than CMOS.";
} else if (lowerCommand.includes('what is tristate logic') || lowerCommand.includes('tri-state buffer')) {
    action.executed = true;
    action.response = "Tri-state logic refers to a digital output that can be in one of three states: high (1), low (0), or high-impedance (Z). The high-impedance state effectively disconnects the output, allowing multiple devices to share a bus.";
} else if (lowerCommand.includes('what is FPGA') || lowerCommand.includes('Field-Programmable Gate Array')) {
    action.executed = true;
    action.response = "An FPGA (Field-Programmable Gate Array) is an integrated circuit designed to be configured by a customer or a designer after manufacturing. FPGAs are highly flexible and can implement any digital circuit, making them suitable for rapid prototyping and custom hardware acceleration.";
} else if (lowerCommand.includes('what is ASIC') || lowerCommand.includes('Application-Specific Integrated Circuit')) {
    action.executed = true;
    action.response = "An ASIC (Application-Specific Integrated Circuit) is an integrated circuit customized for a particular use, rather than general-purpose use. ASICs are designed for specific tasks, leading to higher performance and lower power consumption for that task, but involve high initial design costs.";
} else if (lowerCommand.includes('what are Kirchhoff\'s Laws') || lowerCommand.includes('KCL') || lowerCommand.includes('KVL')) {
    action.executed = true;
    action.response = "Kirchhoff's Laws are two fundamental laws for circuit analysis. Kirchhoff's Current Law (KCL) states that the algebraic sum of currents entering a node (or a junction) is zero. Kirchhoff's Voltage Law (KVL) states that the algebraic sum of voltages around any closed loop in a circuit is zero.";
} else if (lowerCommand.includes('what is Thevenin\'s Theorem') || lowerCommand.includes('thevenin')) {
    action.executed = true;
    action.response = "Thevenin's Theorem states that any linear electrical network containing only voltage sources, current sources, and resistors can be replaced by an equivalent circuit consisting of a single voltage source (Vth) in series with a single resistor (Rth).";
} else if (lowerCommand.includes('what is Norton\'s Theorem') || lowerCommand.includes('norton')) {
    action.executed = true;
    action.response = "Norton's Theorem states that any linear electrical network can be replaced by an equivalent circuit consisting of a single current source (In) in parallel with a single resistor (Rn).";
} else if (lowerCommand.includes('what is superposition theorem') || lowerCommand.includes('superposition')) {
    action.executed = true;
    action.response = "The Superposition Theorem states that in any linear circuit with multiple independent sources, the total current or voltage for any element is the algebraic sum of the currents or voltages produced by each source acting alone, with all other independent sources turned off (voltage sources shorted, current sources opened).";
} else if (lowerCommand.includes('what is maximum power transfer theorem') || lowerCommand.includes('maximum power transfer')) {
    action.executed = true;
    action.response = "The Maximum Power Transfer Theorem states that to obtain maximum external power from a source with a finite internal resistance, the resistance of the load must be equal to the resistance of the source as viewed from its output terminals.";
} else if (lowerCommand.includes('what is impedance') || lowerCommand.includes('define impedance')) {
    action.executed = true;
    action.response = "Impedance is the measure of the opposition that a circuit presents to a current when a voltage is applied. In AC circuits, impedance is a more general concept than resistance, as it includes both resistance and reactance. It's represented by a complex number.";
} else if (lowerCommand.includes('what is reactance') || lowerCommand.includes('define reactance')) {
    action.executed = true;
    action.response = "Reactance is the opposition to the change of current or voltage in an electrical circuit due to inductance or capacitance. It is a component of impedance and is frequency-dependent. Inductive reactance (XL) increases with frequency, while capacitive reactance (XC) decreases with frequency.";
} else if (lowerCommand.includes('what is admittance') || lowerCommand.includes('define admittance')) {
    action.executed = true;
    action.response = "Admittance is a measure of how easily a circuit or device allows current to flow. It is the reciprocal of impedance, and in AC circuits, it's represented by a complex number. Its real part is conductance, and its imaginary part is susceptance.";
} else if (lowerCommand.includes('what is resonance') || lowerCommand.includes('resonant frequency')) {
    action.executed = true;
    action.response = "Resonance in an electrical circuit occurs when the impedance of the circuit is purely resistive, meaning the inductive and capacitive reactances cancel each other out. This typically happens at a specific resonant frequency, leading to maximum current or voltage response.";
} else if (lowerCommand.includes('what is a low-pass filter') || lowerCommand.includes('low pass filter')) {
    action.executed = true;
    action.response = "A low-pass filter is an electronic filter that passes signals with a frequency lower than a certain cutoff frequency and attenuates signals with frequencies higher than the cutoff frequency. It smooths out rapidly changing signals.";
} else if (lowerCommand.includes('what is a high-pass filter') || lowerCommand.includes('high pass filter')) {
    action.executed = true;
    action.response = "A high-pass filter is an electronic filter that passes signals with a frequency higher than a certain cutoff frequency and attenuates signals with frequencies lower than the cutoff frequency. It blocks DC components and low-frequency noise.";
} else if (lowerCommand.includes('what is a band-pass filter') || lowerCommand.includes('band pass filter')) {
    action.executed = true;
    action.response = "A band-pass filter is an electronic filter that passes signals within a certain frequency range (a 'band') and attenuates signals outside that range. It's used to isolate a specific frequency or range of frequencies.";
} else if (lowerCommand.includes('what is a band-stop filter') || lowerCommand.includes('notch filter')) {
    action.executed = true;
    action.response = "A band-stop filter, also known as a band-rejection filter or notch filter, is an electronic filter that attenuates signals within a certain frequency range and passes signals outside that range. It's often used to remove unwanted specific frequencies, like 60Hz hum.";
} else if (lowerCommand.includes('what is a transfer function') || lowerCommand.includes('transfer function electronics')) {
    action.executed = true;
    action.response = "In electronics and control theory, a transfer function is a mathematical representation of the relationship between the output and input of a linear, time-invariant system. It's typically expressed in the Laplace domain.";
} else if (lowerCommand.includes('what is a bode plot') || lowerCommand.includes('bode plot')) {
    action.executed = true;
    action.response = "A Bode plot is a graph of the frequency response of a system. It typically consists of two plots: one for the magnitude (in decibels) and one for the phase shift (in degrees) of the transfer function, plotted against frequency.";
} else if (lowerCommand.includes('what is the s-plane') || lowerCommand.includes('s plane') || lowerCommand.includes('laplace transform')) {
    action.executed = true;
    action.response = "The s-plane is a complex plane where the horizontal axis represents the real part (sigma) and the vertical axis represents the imaginary part (omega) of the complex variable 's' used in the Laplace transform. It's a fundamental tool for analyzing linear time-invariant systems.";
} else if (lowerCommand.includes('what is transient response') || lowerCommand.includes('transient response circuit')) {
    action.executed = true;
    action.response = "The transient response of a circuit describes its behavior as it changes from one steady state to another, typically immediately after a switch is opened or closed, or a sudden change in input occurs. It's temporary and eventually settles to a steady state.";
} else if (lowerCommand.includes('what is steady-state response') || lowerCommand.includes('steady state response circuit')) {
    action.executed = true;
    action.response = "The steady-state response of a circuit is the behavior of the circuit after all transient effects have died out. For DC circuits, this is a constant value; for AC circuits, it's a sinusoidal response at the input frequency.";
} else if (lowerCommand.includes('what is quality factor') || lowerCommand.includes('Q factor')) {
    action.executed = true;
    action.response = "The Quality Factor (Q factor) is a dimensionless parameter that describes how underdamped an oscillator or resonator is. In resonant circuits, a higher Q factor indicates lower energy loss and a narrower bandwidth.";
} else if (lowerCommand.includes('what is an operational amplifier') || lowerCommand.includes('op-amp')) {
    action.executed = true;
    action.response = "An operational amplifier (op-amp) is a DC-coupled high-gain electronic voltage amplifier with a differential input and, usually, a single-ended output. It's a versatile building block for many analog circuits, used for amplification, filtering, summing, and more.";
} else if (lowerCommand.includes('what is negative feedback') || lowerCommand.includes('negative feedback op-amp')) {
    action.executed = true;
    action.response = "Negative feedback is a method of controlling a system by feeding a portion of its output back into its input in an opposing phase. In op-amps, it stabilizes gain, reduces distortion, and improves bandwidth.";
} else if (lowerCommand.includes('what is positive feedback') || lowerCommand.includes('positive feedback op-amp')) {
    action.executed = true;
    action.response = "Positive feedback is a process in which a portion of the output signal is fed back to the input in phase with the input signal. Unlike negative feedback, it tends to increase gain, making it useful in oscillators and regenerative circuits, but can also lead to instability.";
} else if (lowerCommand.includes('what is a voltage regulator') || lowerCommand.includes('voltage regulator')) {
    action.executed = true;
    action.response = "A voltage regulator is an electronic circuit that maintains a constant output voltage regardless of changes in the input voltage or load current. They are essential for providing stable power to sensitive electronic components.";
} else if (lowerCommand.includes('what is a rectifier') || lowerCommand.includes('rectifier circuit')) {
    action.executed = true;
    action.response = "A rectifier is an electrical device that converts alternating current (AC) to direct current (DC). It typically uses diodes to allow current flow in only one direction. Common types include half-wave and full-wave rectifiers.";
} else if (lowerCommand.includes('what is an oscillator') || lowerCommand.includes('oscillator circuit')) {
    action.executed = true;
    action.response = "An oscillator is an electronic circuit that produces a repetitive, oscillating electronic signal, often a sine wave or a square wave. They are fundamental in clock generation, radio transmitters, and signal generators.";
} else if (lowerCommand.includes('what is common-emitter configuration') || lowerCommand.includes('common emitter')) {
    action.executed = true;
    action.response = "The common-emitter configuration is a type of BJT amplifier where the emitter terminal is common to both the input and output. It provides both voltage and current gain and is widely used for amplification.";
} else if (lowerCommand.includes('what is common-collector configuration') || lowerCommand.includes('emitter follower')) {
    action.executed = true;
    action.response = "The common-collector configuration, also known as an emitter follower, is a type of BJT amplifier where the collector terminal is common. It provides high current gain and voltage buffering, useful for impedance matching.";
} else if (lowerCommand.includes('what is common-base configuration') || lowerCommand.includes('common base')) {
    action.executed = true;
    action.response = "The common-base configuration is a type of BJT amplifier where the base terminal is common. It provides good voltage gain but no current gain, primarily used in high-frequency applications.";
} else if (lowerCommand.includes('what is a PN junction') || lowerCommand.includes('PN junction diode')) {
    action.executed = true;
    action.response = "A PN junction is the boundary or interface between two types of semiconductor materials, p-type and n-type, inside a single crystal of semiconductor. It forms the basis of all semiconductor devices like diodes, transistors, and solar cells.";
} else if (lowerCommand.includes('what is doping') || lowerCommand.includes('semiconductor doping')) {
    action.executed = true;
    action.response = "Doping is the process of intentionally introducing impurities into an intrinsic semiconductor for the purpose of modulating its electrical properties, such as its electron and hole concentrations. This creates p-type or n-type semiconductors.";
} else if (lowerCommand.includes('what is a Zener diode') || lowerCommand.includes('zener diode')) {
    action.executed = true;
    action.response = "A Zener diode is a special type of diode designed to reliably allow current to flow in the reverse direction when a certain reverse voltage, known as the Zener voltage, is reached. It's primarily used for voltage regulation.";
} else if (lowerCommand.includes('what is a BJT') || lowerCommand.includes('Bipolar Junction Transistor')) {
    action.executed = true;
    action.response = "A BJT (Bipolar Junction Transistor) is a type of transistor that uses both electron and hole charge carriers. It's a current-controlled device and comes in NPN and PNP types, used for amplification and switching.";
} else if (lowerCommand.includes('what is an FET') || lowerCommand.includes('Field-Effect Transistor')) {
    action.executed = true;
    action.response = "An FET (Field-Effect Transistor) is a type of transistor that uses an electric field to control the flow of current. Unlike BJTs, FETs are voltage-controlled devices and have high input impedance, coming in JFET and MOSFET variations.";
} else if (lowerCommand.includes('what is a MOSFET') || lowerCommand.includes('MOSFET transistor')) {
    action.executed = true;
    action.response = "A MOSFET (Metal-Oxide-Semiconductor Field-Effect Transistor) is the most common type of FET. It's a voltage-controlled device known for high input impedance and is crucial in digital circuits, power electronics, and integrated circuits due to its scalability and low power consumption.";
} else if (lowerCommand.includes('what is an SCR') || lowerCommand.includes('Silicon Controlled Rectifier')) {
    action.executed = true;
    action.response = "An SCR (Silicon Controlled Rectifier) is a four-layer solid-state device that controls current flow. It acts as a switch, remaining off until a small current is applied to its gate terminal, after which it conducts heavily until the main current is interrupted.";
} else if (lowerCommand.includes('what is a photodiode') || lowerCommand.includes('photodiode')) {
    action.executed = true;
    action.response = "A photodiode is a semiconductor device that converts light into an electrical current. When light strikes the photodiode, it creates electron-hole pairs, generating a current proportional to the light intensity.";
} else if (lowerCommand.includes('what is a phototransistor') || lowerCommand.includes('phototransistor')) {
    action.executed = true;
    action.response = "A phototransistor is a light-sensitive transistor, similar to a photodiode but with internal gain. When light strikes its base junction, it generates a much larger output current compared to a photodiode, making it more sensitive to light.";
} else if (lowerCommand.includes('what is a thermistor') || lowerCommand.includes('thermistor')) {
    action.executed = true;
    action.response = "A thermistor is a type of resistor whose resistance is strongly dependent on temperature. It's widely used as a temperature sensor, with its resistance typically decreasing significantly as temperature increases (NTC thermistor).";
} else if (lowerCommand.includes('what is an LDR') || lowerCommand.includes('Light Dependent Resistor')) {
    action.executed = true;
    action.response = "An LDR (Light Dependent Resistor), also known as a photoresistor, is a passive component whose resistance decreases with increasing incident light intensity. It's often used in light-sensing applications.";
} else if (lowerCommand.includes('what is a temperature sensor')) {
    action.executed = true;
    action.response = "A temperature sensor is a device that measures temperature. Common types include thermistors, RTDs (Resistance Temperature Detectors), thermocouples, and semiconductor-based IC sensors.";
} else if (lowerCommand.includes('what is a pressure sensor')) {
    action.executed = true;
    action.response = "A pressure sensor is a device that measures pressure, typically of gases or liquids. Pressure is an expression of the force required to stop a fluid from expanding, and pressure sensors convert this force into an electrical signal.";
} else if (lowerCommand.includes('what is an ultrasonic sensor')) {
    action.executed = true;
    action.response = "An ultrasonic sensor measures distance by emitting ultrasonic waves and listening for the echo. By calculating the time taken for the sound to return, it determines the distance to an object. It's common in robotics and object detection.";
} else if (lowerCommand.includes('what is an infrared sensor') || lowerCommand.includes('IR sensor')) {
    action.executed = true;
    action.response = "An infrared (IR) sensor is an electronic device that measures or detects infrared radiation in its environment. It can be used for motion detection, proximity sensing, object detection, and even thermal imaging.";
} else if (lowerCommand.includes('what is a motion sensor') || lowerCommand.includes('PIR sensor')) {
    action.executed = true;
    action.response = "A motion sensor, often a PIR (Passive Infrared) sensor, detects movement by measuring changes in infrared radiation levels in its field of view. It's commonly used in security systems and automatic lighting.";
} else if (lowerCommand.includes('what is a humidity sensor')) {
    action.executed = true;
    action.response = "A humidity sensor (or hygrometer) detects and measures the amount of water vapor in the air. These sensors are crucial for environmental monitoring, HVAC systems, and weather stations.";
} else if (lowerCommand.includes('what is an accelerometer')) {
    action.executed = true;
    action.response = "An accelerometer is a device that measures proper acceleration. This is the acceleration (or rate of change of velocity) of a body in its own rest frame. It's used to detect tilt, vibration, and orientation changes.";
} else if (lowerCommand.includes('what is a gyroscope') || lowerCommand.includes('gyroscope sensor')) {
    action.executed = true;
    action.response = "A gyroscope is a device that measures or maintains orientation and angular velocity. It detects rotation around an axis and is often paired with accelerometers in IMUs (Inertial Measurement Units) for more complete motion sensing.";
} else if (lowerCommand.includes('what is a magnetomter') || lowerCommand.includes('magnetometer')) {
    action.executed = true;
    action.response = "A magnetometer is an instrument that measures magnetic field strength or direction. In electronics, they are used in compasses, navigation systems, and metal detectors.";
} else if (lowerCommand.includes('what is a proximity sensor')) {
    action.executed = true;
    action.response = "A proximity sensor is a non-contact sensor that detects the presence of nearby objects without any physical contact. They work by emitting an electromagnetic field or a beam of radiation and looking for changes in the return signal.";
} else if (lowerCommand.includes('what is a force sensor') || lowerCommand.includes('load cell')) {
    action.executed = true;
    action.response = "A force sensor, often called a load cell, is a transducer that converts a force into an electrical signal. The electrical signal output is proportional to the applied force. They are used in scales, robotic grippers, and industrial measurement.";
} else if (lowerCommand.includes('what is a flex sensor')) {
    action.executed = true;
    action.response = "A flex sensor is a sensor that measures the amount of bend or deflection. As the sensor is bent, the resistance across it increases. They are commonly used in robotics, gaming, and virtual reality gloves.";
} else if (lowerCommand.includes('what is a gas sensor')) {
    action.executed = true;
    action.response = "A gas sensor is an electronic device that detects the presence and concentration of different types of gases in an area. They are used to detect combustible, flammable, and toxic gases, as well as oxygen depletion, in various environments.";
} else if (lowerCommand.includes('what is a pH sensor')) {
    action.executed = true;
    action.response = "A pH sensor measures the acidity or alkalinity of a liquid. It typically consists of a glass electrode that generates a voltage proportional to the hydrogen ion concentration in the solution. Important for water quality, chemical processes, and agriculture.";
} else if (lowerCommand.includes('what is a motor') || lowerCommand.includes('electric motor')) {
    action.executed = true;
    action.response = "An electric motor is an electrical machine that converts electrical energy into mechanical energy. Most electric motors operate through the interaction between the motor's magnetic field and electric current in a wire winding to generate force in the form of torque.";
} else if (lowerCommand.includes('what is a servo motor')) {
    action.executed = true;
    action.response = "A servo motor is a rotary actuator that allows for precise control of angular position, velocity, and acceleration. It consists of a motor, a feedback sensor (often an encoder), and a control circuit. Commonly used in robotics and RC applications.";
} else if (lowerCommand.includes('what is a stepper motor')) {
    action.executed = true;
    action.response = "A stepper motor is a brushless DC electric motor that divides a full rotation into a number of equal steps. It can be commanded to move and hold at any of these steps without a feedback sensor (open-loop control), making it ideal for precise positioning.";
} else if (lowerCommand.includes('what is an actuator') || lowerCommand.includes('define actuator')) {
    action.executed = true;
    action.response = "An actuator is a component of a machine that is responsible for moving and controlling a mechanism or system. It converts electrical, hydraulic, or pneumatic energy into mechanical motion. Motors, solenoids, and relays are common actuators.";
} else if (lowerCommand.includes('what is a solenoid')) {
    action.executed = true;
    action.response = "A solenoid is a type of electromagnet, the purpose of which is to generate a controlled magnetic field. When current passes through its coil, it creates a magnetic field that can be used to pull or push a plunger, converting electrical energy into linear mechanical motion.";
} else if (lowerCommand.includes('what is a relay')) {
    action.executed = true;
    action.response = "A relay is an electrically operated switch. It uses an electromagnet to mechanically operate a switch, either opening or closing a circuit. Relays are used to control a high-power circuit using a low-power signal, or to control multiple circuits with one signal.";
} else if (lowerCommand.includes('what are arduino shields') || lowerCommand.includes('arduino shield')) {
    action.executed = true;
    action.response = "Arduino shields are pre-assembled circuit boards that can be easily plugged on top of an Arduino board, extending its capabilities. They provide additional functionality like Ethernet connectivity, motor control, or wireless communication, without requiring complex wiring.";
} else if (lowerCommand.includes('what is the arduino IDE') || lowerCommand.includes('arduino IDE')) {
    action.executed = true;
    action.response = "The Arduino IDE (Integrated Development Environment) is a cross-platform application written in Java, designed to write, compile, and upload code to Arduino compatible boards. It provides a simple environment for programming microcontrollers.";
} else if (lowerCommand.includes('what is GPIO') || lowerCommand.includes('General Purpose Input/Output')) {
    action.executed = true;
    action.response = "GPIO stands for General Purpose Input/Output. These are generic pins on a microcontroller that can be configured by software to either input or output digital signals (high or low voltage). They are fundamental for interacting with sensors, LEDs, buttons, and other external components.";
} else if (lowerCommand.includes('what is UART') || lowerCommand.includes('Universal Asynchronous Receiver/Transmitter')) {
    action.executed = true;
    action.response = "UART (Universal Asynchronous Receiver/Transmitter) is a hardware communication protocol that transmits and receives serial data asynchronously. It's a common method for communication between microcontrollers and other devices like computers (via USB-to-serial converters).";
} else if (lowerCommand.includes('what is SPI') || lowerCommand.includes('Serial Peripheral Interface')) {
    action.executed = true;
    action.response = "SPI (Serial Peripheral Interface) is a synchronous serial communication interface specification used for short-distance communication, primarily in embedded systems. It operates in full duplex mode and typically uses four wires: MOSI, MISO, SCK, and SS.";
} else if (lowerCommand.includes('what is I2C') || lowerCommand.includes('IIC') || lowerCommand.includes('Inter-Integrated Circuit')) {
    action.executed = true;
    action.response = "I2C (Inter-Integrated Circuit), also known as IIC, is a multi-master, multi-slave serial communication bus used for connecting low-speed peripheral ICs to processors and microcontrollers. It uses only two bidirectional lines, SDA (data) and SCL (clock), making it very efficient.";
} else if (lowerCommand.includes('what are interrupts') || lowerCommand.includes('microcontroller interrupts')) {
    action.executed = true;
    action.response = "Interrupts are signals from hardware or software that indicate an event needs immediate attention from the CPU. When an interrupt occurs, the CPU temporarily suspends its current task, executes a specific 'Interrupt Service Routine' (ISR), and then resumes its previous task.";
} else if (lowerCommand.includes('what is PWM') || lowerCommand.includes('Pulse Width Modulation')) {
    action.executed = true;
    action.response = "PWM (Pulse Width Modulation) is a technique used to control the average power delivered to an electrical device by varying the width of electrical pulses. By changing the duty cycle (on-time vs. off-time), you can effectively control brightness of LEDs, speed of motors, etc.";
} else if (lowerCommand.includes('what is a watchdog timer')) {
    action.executed = true;
    action.response = "A watchdog timer is an electronic timer that is used to detect and recover from malfunctions in embedded systems. If the main program fails to reset the watchdog timer periodically (e.g., due to a software error), the timer will time out and reset the system.";
} else if (lowerCommand.includes('what is a bootloader')) {
    action.executed = true;
    action.response = "A bootloader is a small piece of code that runs when a microcontroller or computer first powers on or resets. Its primary function is to initialize the system and then load a larger program (like your Arduino sketch) into memory and start its execution.";
} else if (lowerCommand.includes('what is firmware') || lowerCommand.includes('define firmware')) {
    action.executed = true;
    action.response = "Firmware is a specific class of computer software that provides low-level control for a device's specific hardware. It's typically stored in non-volatile memory (like Flash ROM) and is responsible for basic functions, allowing higher-level software to interact with the hardware.";
} else if (lowerCommand.includes('what is an RTOS') || lowerCommand.includes('Real-Time Operating System')) {
    action.executed = true;
    action.response = "An RTOS (Real-Time Operating System) is an operating system intended for real-time applications, meaning it guarantees that certain operations will be completed within specific time constraints. RTOSes are crucial in embedded systems where timely responses are critical, such as in industrial control or medical devices.";
} else if (lowerCommand.includes('what is memory in a microcontroller') || lowerCommand.includes('microcontroller memory')) {
    action.executed = true;
    action.response = "Microcontrollers typically have different types of memory: Flash memory (for storing the program code), SRAM (Static RAM, for temporary data and variables), and EEPROM (Electrically Erasable Programmable Read-Only Memory, for small amounts of persistent data).";
} else if (lowerCommand.includes('what is an instruction set') || lowerCommand.includes('instruction set architecture')) {
    action.executed = true;
    action.response = "An instruction set (or Instruction Set Architecture - ISA) is the set of all instructions that a central processing unit (CPU) can understand and execute. It defines the commands that a processor knows, including operations, data types, and memory addressing modes.";
} else if (lowerCommand.includes('what is raspberry pi')) {
    action.executed = true;
    action.response = "The Raspberry Pi is a series of small single-board computers (SBCs) developed in the United Kingdom by the Raspberry Pi Foundation to promote the teaching of basic computer science in schools and developing countries. Unlike Arduino, it's a full-fledged computer capable of running an operating system.";
} else if (lowerCommand.includes('arduino vs raspberry pi') || lowerCommand.includes('difference between arduino and raspberry pi')) {
    action.executed = true;
    action.response = "Arduino is a microcontroller board, ideal for controlling hardware and real-time operations, programmed in a simplified C/C++. Raspberry Pi is a single-board computer, capable of running an OS like Linux, better for complex computing tasks, networking, and software applications.";
} else if (lowerCommand.includes('what is HDL') || lowerCommand.includes('Hardware Description Language')) {
    action.executed = true;
    action.response = "HDL (Hardware Description Language) is a specialized computer language used to describe the structure, design, and operation of electronic circuits. VHDL and Verilog are common HDLs used for designing digital systems, particularly FPGAs and ASICs.";
} else if (lowerCommand.includes('what is a state machine') || lowerCommand.includes('finite state machine')) {
    action.executed = true;
    action.response = "A state machine (or finite state machine, FSM) is a mathematical model of computation used to design sequential logic circuits. It consists of a finite number of states, transitions between those states, and actions that can be performed upon entering a state or taking a transition.";
} else if (lowerCommand.includes('what is DRAM') || lowerCommand.includes('Dynamic Random Access Memory')) {
    action.executed = true;
    action.response = "DRAM (Dynamic Random Access Memory) is a type of random-access memory that stores each bit of data in a separate capacitor within an integrated circuit. It requires periodic refreshing of its charge to maintain the stored data, hence the term 'dynamic'.";
} else if (lowerCommand.includes('what is SRAM') || lowerCommand.includes('Static Random Access Memory')) {
    action.executed = true;
    action.response = "SRAM (Static Random Access Memory) is a type of random-access memory that uses latching circuitry (flip-flops) to store each bit. Unlike DRAM, it does not need to be refreshed periodically, making it faster but more expensive and less dense.";
} else if (lowerCommand.includes('what is ROM') || lowerCommand.includes('Read Only Memory')) {
    action.executed = true;
    action.response = "ROM (Read-Only Memory) is a type of non-volatile memory used in computers and other electronic devices. Data stored in ROM cannot be electronically modified after the manufacturing of the memory device, or requires significant effort to do so.";
} else if (lowerCommand.includes('what is flash memory') || lowerCommand.includes('flash storage')) {
    action.executed = true;
    action.response = "Flash memory is a non-volatile computer memory that can be electrically erased and reprogrammed. It is a type of EEPROM and is widely used in USB flash drives, solid-state drives (SSDs), digital cameras, and mobile phones for data storage.";
} else if (lowerCommand.includes('what is a shift register')) {
    action.executed = true;
    action.response = "A shift register is a digital circuit that can store and move data by shifting bits sequentially. It's often used for serial-to-parallel conversion, parallel-to-serial conversion, or as a delay element.";
} else if (lowerCommand.includes('what is filter order')) {
    action.executed = true;
    action.response = "The order of a filter refers to the number of reactive components (capacitors and inductors) in its passive implementation, or the highest power of 's' in the denominator of its transfer function for active filters. Higher order filters generally have steeper roll-offs.";
} else if (lowerCommand.includes('what is damping factor') || lowerCommand.includes('damping ratio')) {
    action.executed = true;
    action.response = "The damping factor (or damping ratio, $\zeta$) is a dimensionless measure describing how oscillations in a system decay after a disturbance. A critically damped system ($\zeta=1$) returns to equilibrium as quickly as possible without oscillating.";
} else if (lowerCommand.includes('what is phase margin')) {
    action.executed = true;
    action.response = "Phase margin is a measure of the stability of a feedback control system. It is the amount of additional phase lag that can be added to the system at the gain crossover frequency before it becomes unstable.";
} else if (lowerCommand.includes('what is gain margin')) {
    action.executed = true;
    action.response = "Gain margin is a measure of the stability of a feedback control system. It is the amount of gain (in dB) that can be added to the system at the phase crossover frequency before it becomes unstable.";
} else if (lowerCommand.includes('what is an equivalent circuit')) {
    action.executed = true;
    action.response = "An equivalent circuit is a simplified circuit that behaves identically to a more complex circuit, at least with respect to its terminals. Thevenin and Norton equivalent circuits are common examples used to simplify analysis.";
} else if (lowerCommand.includes('what is an inverter op-amp') || lowerCommand.includes('inverting amplifier')) {
    action.executed = true;
    action.response = "An inverting amplifier is an op-amp configuration where the output signal is out of phase by 180 degrees with respect to the input signal, and its gain is determined by the ratio of two resistors.";
} else if (lowerCommand.includes('what is a non-inverting amplifier') || lowerCommand.includes('non inverting amplifier')) {
    action.executed = true;
    action.response = "A non-inverting amplifier is an op-amp configuration where the output signal is in phase with the input signal, and its gain is determined by the ratio of two resistors plus one.";
} else if (lowerCommand.includes('what is a voltage follower') || lowerCommand.includes('unity gain buffer')) {
    action.executed = true;
    action.response = "A voltage follower, or unity gain buffer, is an op-amp configuration that provides a gain of 1. Its primary use is for impedance matching, preventing a source from being loaded by a low-impedance load.";
} else if (lowerCommand.includes('what is an instrumentation amplifier')) {
    action.executed = true;
    action.response = "An instrumentation amplifier is a type of differential amplifier that is highly precise and stable, commonly used for amplifying very small differential signals in noisy environments. It typically has high input impedance and high common-mode rejection ratio.";
} else if (lowerCommand.includes('what is a comparator') || lowerCommand.includes('comparator circuit')) {
    action.executed = true;
    action.response = "A comparator is an electronic circuit that compares two input voltages or currents and outputs a digital signal indicating which is larger. It's often implemented using an op-amp in an open-loop configuration.";
} else if (lowerCommand.includes('what is hysteresis') || lowerCommand.includes('hysteresis electronic')) {
    action.executed = true;
    action.response = "Hysteresis in electronics refers to the dependence of a system's output on its past inputs as well as its present input. In circuits like Schmitt triggers, it prevents rapid, unwanted switching due to noise around the threshold.";
} else if (lowerCommand.includes('what is a voltage controlled oscillator') || lowerCommand.includes('VCO')) {
    action.executed = true;
    action.response = "A VCO (Voltage Controlled Oscillator) is an electronic oscillator whose oscillation frequency is controlled by a voltage input. The applied input voltage determines the instantaneous oscillation frequency.";
} else if (lowerCommand.includes('what is a phase-locked loop') || lowerCommand.includes('PLL')) {
    action.executed = true;
    action.response = "A PLL (Phase-Locked Loop) is a control system that generates an output signal whose phase is related to the phase of an input 'reference' signal. It's used for frequency synthesis, demodulation, and clock recovery in communication systems.";
} else if (lowerCommand.includes('what is total harmonic distortion') || lowerCommand.includes('THD')) {
    action.executed = true;
    action.response = "THD (Total Harmonic Distortion) is a measurement of the harmonic distortion present in a signal. It's defined as the ratio of the sum of the powers of all harmonic components to the power of the fundamental frequency, indicating signal purity.";
} else if (lowerCommand.includes('what is slew rate') || lowerCommand.includes('op-amp slew rate')) {
    action.executed = true;
    action.response = "Slew rate is the maximum rate of change of output voltage per unit of time, typically measured in volts per microsecond (V/Î¼s). It limits the speed at which an op-amp's output can change, affecting its performance at higher frequencies.";
} else if (lowerCommand.includes('what is offset voltage') || lowerCommand.includes('op-amp offset voltage')) {
    action.executed = true;
    action.response = "Input offset voltage is the differential DC voltage required between the two input terminals of an op-amp to make the output zero. It's an imperfection that can cause a small DC voltage at the output even with zero input.";
} else if (lowerCommand.includes('what is a Schottky diode') || lowerCommand.includes('schottky diode')) {
    action.executed = true;
    action.response = "A Schottky diode is a semiconductor diode with a very low forward voltage drop and a very fast switching action. It's formed by a metal-semiconductor junction, rather than a p-n junction, making it useful in high-speed switching and RF applications.";
} else if (lowerCommand.includes('what is a TRIAC') || lowerCommand.includes('triac')) {
    action.executed = true;
    action.response = "A TRIAC (Triode for Alternating Current) is a three-terminal electronic component that conducts current in either direction when triggered by a gate signal. It's commonly used in AC power control applications like light dimmers and motor speed controls.";
} else if (lowerCommand.includes('what is a DIAC') || lowerCommand.includes('diac')) {
    action.executed = true;
    action.response = "A DIAC (Diode for Alternating Current) is a two-terminal, three-layer semiconductor device that conducts electrical current only after its breakdown voltage has been reached. It's often used to trigger TRIACs.";
} else if (lowerCommand.includes('what is an IGBT') || lowerCommand.includes('Insulated Gate Bipolar Transistor')) {
    action.executed = true;
    action.response = "An IGBT (Insulated Gate Bipolar Transistor) is a three-terminal power semiconductor device primarily used as an electronic switch. It combines the high input impedance of a MOSFET with the low on-state voltage drop and high current handling capability of a BJT.";
} else if (lowerCommand.includes('what is a varactor diode') || lowerCommand.includes('varicap diode')) {
    action.executed = true;
    action.response = "A varactor diode (or varicap diode) is a type of diode whose capacitance varies with the reverse voltage applied across its terminals. This property makes them useful in voltage-controlled oscillators, frequency multipliers, and tunable filters.";
} else if (lowerCommand.includes('what is an optocoupler') || lowerCommand.includes('opt-isolator')) {
    action.executed = true;
    action.response = "An optocoupler (or opto-isolator) is an electronic component that transfers electrical signals between two isolated circuits by using light. It prevents high voltages or rapid voltage transients in one part of a system from affecting the other, providing electrical isolation.";
} else if (lowerCommand.includes('what is an RTD') || lowerCommand.includes('Resistance Temperature Detector')) {
    action.executed = true;
    action.response = "An RTD (Resistance Temperature Detector) is a temperature sensor that changes its resistance with temperature. It's known for high accuracy and stability, often made of platinum, copper, or nickel.";
} else if (lowerCommand.includes('what is a thermocouple')) {
    action.executed = true;
    action.response = "A thermocouple is a temperature sensor consisting of two dissimilar electrical conductors forming electrical junctions at differing temperatures. It produces a temperature-dependent voltage as a result of the Seebeck effect, allowing for temperature measurement over wide ranges.";
} else if (lowerCommand.includes('what is a photoelectric sensor')) {
    action.executed = true;
    action.response = "A photoelectric sensor detects the presence or absence of an object by emitting a light beam (usually infrared) and detecting whether the light is returned. They are widely used in automation and industrial applications.";
} else if (lowerCommand.includes('what is an encoder sensor') || lowerCommand.includes('rotary encoder')) {
    action.executed = true;
    action.response = "An encoder sensor converts linear or rotary motion into digital signals. Rotary encoders, for example, detect angular position or motion and are commonly used for precise control in robotics and industrial machinery.";
} else if (lowerCommand.includes('what is an IMU') || lowerCommand.includes('Inertial Measurement Unit')) {
    action.executed = true;
    action.response = "An IMU (Inertial Measurement Unit) is an electronic device that measures and reports a body's specific force, angular rate, and sometimes the magnetic field surrounding the body, using a combination of accelerometers, gyroscopes, and often magnetometers.";
} else if (lowerCommand.includes('what is a haptic actuator') || lowerCommand.includes('haptic feedback')) {
    action.executed = true;
    action.response = "A haptic actuator is a device that creates a sense of touch by applying forces, vibrations, or motions to the user. It's used in touchscreens, gaming controllers, and virtual reality to provide haptic feedback.";
} else if (lowerCommand.includes('what is an embedded system')) {
    action.executed = true;
    action.response = "An embedded system is a computer systemâ€”a combination of a computer processor, computer memory, and input/output peripheral devicesâ€”that has a dedicated function within a larger mechanical or electrical system. It's designed to perform a specific task, often with real-time computing constraints.";
} else if (lowerCommand.includes('what is cross-compilation') || lowerCommand.includes('cross compilation')) {
    action.executed = true;
    action.response = "Cross-compilation is the process of compiling code on one computer architecture (the host) for execution on a different computer architecture (the target). This is common in embedded systems development, where code for a microcontroller is compiled on a desktop PC.";
} else if (lowerCommand.includes('what is an IDE') || lowerCommand.includes('Integrated Development Environment')) {
    action.executed = true;
    action.response = "An IDE (Integrated Development Environment) is a software application that provides comprehensive facilities to computer programmers for software development. It typically consists of a source code editor, build automation tools, and a debugger.";
} else if (lowerCommand.includes('what is a debugger') || lowerCommand.includes('debugger electronics')) {
    action.executed = true;
    action.response = "A debugger is a computer program that is used to test and debug other programs (the 'target' program). It allows a programmer to step through code, inspect variables, and set breakpoints to find and fix errors.";
} else if (lowerCommand.includes('what is an SDK') || lowerCommand.includes('Software Development Kit')) {
    action.executed = true;
    action.response = "An SDK (Software Development Kit) is a collection of software development tools in one installable package. It typically includes libraries, documentation, code samples, processes, and guides that developers can use to create applications for a specific platform.";
} else if (lowerCommand.includes('what is IoT') || lowerCommand.includes('Internet of Things') || lowerCommand.includes('define IoT')) {
    action.executed = true;
    action.response = "IoT (Internet of Things) refers to the network of physical objects embedded with sensors, software, and other technologies for the purpose of connecting and exchanging data with other devices and systems over the internet. It enables objects to 'talk' to each other and the cloud.";
} else if (lowerCommand.includes('what is an IoT device')) {
    action.executed = true;
    action.response = "An IoT device is any physical object that contains embedded technology allowing it to connect to the internet and interact with other devices. This can range from smart home appliances and wearable tech to industrial sensors.";
} else if (lowerCommand.includes('what is an IoT gateway')) {
    action.executed = true;
    action.response = "An IoT gateway is a physical device or a software program that serves as a connection point between the cloud and controllers, sensors, and intelligent devices. It acts as a bridge, aggregating, filtering, and transmitting data securely.";
} else if (lowerCommand.includes('what is edge computing') || lowerCommand.includes('edge computing IoT')) {
    action.executed = true;
    action.response = "Edge computing in IoT involves processing data closer to where it's generated, rather than sending it all to a centralized cloud. This reduces latency, saves bandwidth, and can improve security and real-time decision-making.";
} else if (lowerCommand.includes('what is cloud computing') || lowerCommand.includes('cloud computing IoT')) {
    action.executed = true;
    action.response = "Cloud computing in IoT refers to using remote servers, storage, databases, networking, software, analytics, and intelligence over the Internet ('the cloud') to process and store data from IoT devices. It provides scalable resources for large-scale IoT deployments.";
} else if (lowerCommand.includes('what is an IoT platform')) {
    action.executed = true;
    action.response = "An IoT platform is a multi-layered technology that connects physical devices to the cloud and other applications. It provides tools for device management, data acquisition, processing, analytics, and application development for IoT solutions.";
} else if (lowerCommand.includes('what is MQTT') || lowerCommand.includes('MQTT protocol')) {
    action.executed = true;
    action.response = "MQTT (Message Queuing Telemetry Transport) is a lightweight, publish-subscribe network protocol that transports messages between devices. It's designed for constrained devices and low-bandwidth, high-latency, or unreliable networks, making it popular for IoT applications.";
} else if (lowerCommand.includes('what is CoAP') || lowerCommand.includes('CoAP protocol')) {
    action.executed = true;
    action.response = "CoAP (Constrained Application Protocol) is a specialized web transfer protocol for use with constrained nodes and constrained networks in the Internet of Things. It's designed for use by small, low-power sensors, switches, and other devices.";
} else if (lowerCommand.includes('what is LoRaWAN') || lowerCommand.includes('LoRaWAN protocol')) {
    action.executed = true;
    action.response = "LoRaWAN is a Low Power Wide Area Network (LPWAN) specification for wireless, battery-operated IoT devices. It defines the communication protocol and system architecture for the network, offering long-range and low-power connectivity.";
} else if (lowerCommand.includes('what is Zigbee') || lowerCommand.includes('Zigbee protocol')) {
    action.executed = true;
    action.response = "Zigbee is a wireless technology standard that operates on IEEE 802.15.4, designed for low-power, low-data-rate, short-range wireless networking. It's commonly used in smart homes, building automation, and industrial control systems.";
} else if (lowerCommand.includes('what is Bluetooth Low Energy') || lowerCommand.includes('BLE')) {
    action.executed = true;
    action.response = "Bluetooth Low Energy (BLE) is a wireless personal area network technology designed and marketed by the Bluetooth Special Interest Group. It's optimized for very low power consumption, making it ideal for small, battery-powered IoT devices and wearables.";
} else if (lowerCommand.includes('what is smart home') || lowerCommand.includes('smart home technology')) {
    action.executed = true;
    action.response = "A smart home is a residence that uses internet-connected devices to enable the remote monitoring and management of appliances and systems, such as lighting, heating, and security. It aims to enhance comfort, convenience, energy efficiency, and security.";
} else if (lowerCommand.includes('what is industrial IoT') || lowerCommand.includes('IIoT')) {
    action.executed = true;
    action.response = "Industrial IoT (IIoT) refers to the application of IoT technologies in industrial settings, such as manufacturing, energy management, and supply chain logistics. It focuses on improving operational efficiency, predictive maintenance, and overall productivity.";
} else if (lowerCommand.includes('what is a digital twin') || lowerCommand.includes('digital twin IoT')) {
    action.executed = true;
    action.response = "A digital twin is a virtual representation of a physical object, system, or process. In IoT, digital twins use real-time data from sensors to create an accurate virtual model, enabling monitoring, simulation, and analysis to optimize performance and predict issues.";
} else if (lowerCommand.includes('what is fog computing') || lowerCommand.includes('fog computing IoT')) {
    action.executed = true;
    action.response = "Fog computing extends cloud computing to the edge of the network, placing data, compute, storage, and application services closer to end-devices and users. It bridges the gap between edge devices and the cloud, offering faster processing for certain IoT applications.";
} else if (lowerCommand.includes('what is M2M communication') || lowerCommand.includes('Machine to Machine communication')) {
    action.executed = true;
    action.response = "M2M (Machine-to-Machine) communication refers to the direct communication between devices using any communication channel, including wired and wireless. It's a foundational concept for IoT, enabling devices to exchange data and act without human intervention.";
} else if (lowerCommand.includes('what is LPWAN') || lowerCommand.includes('Low Power Wide Area Network')) {
    action.executed = true;
    action.response = "LPWAN (Low Power Wide Area Network) is a type of wireless telecommunication network designed to allow long-range communications at a low bit rate among things (connected objects) that are battery-powered, for a period of months or years.";
} else if (lowerCommand.includes('what is NB-IoT') || lowerCommand.includes('Narrowband IoT')) {
    action.executed = true;
    action.response = "NB-IoT (Narrowband IoT) is a low-power wide-area (LPWA) technology standard published by 3GPP for cellular devices and services. It's designed to enable a wide range of new IoT devices and services, offering extended battery life and deep coverage.";
} else if (lowerCommand.includes('what is modulation') || lowerCommand.includes('define modulation')) {
    action.executed = true;
    action.response = "Modulation is the process of varying one or more properties of a carrier wave with a modulating signal that contains information. This allows the information to be transmitted over long distances or different mediums.";
} else if (lowerCommand.includes('what is AM') || lowerCommand.includes('amplitude modulation')) {
    action.executed = true;
    action.response = "AM stands for Amplitude Modulation. It's a modulation technique used in electronic communication, most commonly for transmitting information via a radio carrier wave. In AM, the amplitude (signal strength) of the carrier wave is varied in proportion to that of the message signal.";
} else if (lowerCommand.includes('what is FM') || lowerCommand.includes('frequency modulation')) {
    action.executed = true;
    action.response = "FM stands for Frequency Modulation. It's a modulation technique in which the frequency of the carrier wave is varied in proportion to that of the message signal, while its amplitude remains constant. FM is less susceptible to noise than AM.";
} else if (lowerCommand.includes('what is PM') || lowerCommand.includes('Phase Modulation')) {
    action.executed = true;
    action.response = "PM stands for Phase Modulation. It's a modulation technique where the phase of the carrier wave is varied in proportion to the message signal. PM is closely related to FM and is often used in digital communication.";
} else if (lowerCommand.includes('what is sampling') || lowerCommand.includes('define sampling in communication')) {
    action.executed = true;
    action.response = "In digital communication, sampling is the process of converting a continuous-time analog signal into a discrete-time signal by taking a series of measurements (samples) at regular intervals. The sampling rate must be at least twice the highest frequency in the signal (Nyquist-Shannon theorem).";
} else if (lowerCommand.includes('what is quantization') || lowerCommand.includes('define quantization')) {
    action.executed = true;
    action.response = "Quantization is the process of converting a continuous range of values (like sampled amplitudes) into a finite number of discrete steps or levels. In digital communication, after sampling, the amplitude of each sample is rounded to the nearest allowed discrete value.";
} else if (lowerCommand.includes('what is encoding') || lowerCommand.includes('encoding digital communication')) {
    action.executed = true;
    action.response = "In digital communication, encoding is the process of assigning a unique binary code (a sequence of bits) to each quantized sample or symbol. This allows the digital representation of the information to be transmitted.";
} else if (lowerCommand.includes('what is PCM') || lowerCommand.includes('Pulse Code Modulation')) {
    action.executed = true;
    action.response = "PCM (Pulse Code Modulation) is a method used to digitally represent sampled analog signals. It's the standard form of digital audio in computers and other digital communication systems. PCM involves three main steps: sampling, quantization, and encoding.";
} else if (lowerCommand.includes('what is ASK') || lowerCommand.includes('Amplitude Shift Keying')) {
    action.executed = true;
    action.response = "ASK (Amplitude Shift Keying) is a digital modulation technique where the amplitude of a carrier wave is varied to represent binary data (0s and 1s). It's simple but susceptible to noise.";
} else if (lowerCommand.includes('what is FSK') || lowerCommand.includes('Frequency Shift Keying')) {
    action.executed = true;
    action.response = "FSK (Frequency Shift Keying) is a digital modulation technique where the frequency of the carrier wave is shifted between different values to represent binary data. It's more robust to noise than ASK.";
} else if (lowerCommand.includes('what is PSK') || lowerCommand.includes('Phase Shift Keying')) {
    action.executed = true;
    action.response = "PSK (Phase Shift Keying) is a digital modulation technique where the phase of the carrier wave is varied to represent binary data. Different phase shifts correspond to different symbols (e.g., 0 and 1).";
} else if (lowerCommand.includes('what is QAM') || lowerCommand.includes('Quadrature Amplitude Modulation')) {
    action.executed = true;
    action.response = "QAM (Quadrature Amplitude Modulation) is a digital modulation scheme that conveys data by changing (modulating) the amplitude of two carrier waves. These two waves are out of phase with each other by 90 degrees (quadrature). It's efficient for high data rates.";
} else if (lowerCommand.includes('what is multiplexing') || lowerCommand.includes('define multiplexing')) {
    action.executed = true;
    action.response = "Multiplexing is a method by which multiple analog or digital signals are combined into one signal over a shared medium. The aim is to share a costly resource (e.g., a transmission medium) among multiple independent users.";
} else if (lowerCommand.includes('what is TDM') || lowerCommand.includes('Time Division Multiplexing')) {
    action.executed = true;
    action.response = "TDM (Time Division Multiplexing) is a technique where different signals are transmitted over a single communication channel by dividing the channel's time into slots. Each signal gets a brief turn to use the channel.";
} else if (lowerCommand.includes('what is FDM') || lowerCommand.includes('Frequency Division Multiplexing')) {
    action.executed = true;
    action.response = "FDM (Frequency Division Multiplexing) is a technique where multiple signals are transmitted simultaneously over a single communication channel by assigning each signal a different frequency band. This is common in radio broadcasting.";
} else if (lowerCommand.includes('what is WDM') || lowerCommand.includes('Wavelength Division Multiplexing')) {
    action.executed = true;
    action.response = "WDM (Wavelength Division Multiplexing) is a technology that multiplexes multiple optical carrier signals onto a single optical fiber by using different wavelengths (colors) of laser light. It greatly increases the capacity of optical fiber communication systems.";
} else if (lowerCommand.includes('what is noise in communication') || lowerCommand.includes('communication noise')) {
    action.executed = true;
    action.response = "Noise in communication systems refers to unwanted random disturbances that interfere with the desired signal. It can degrade the quality and intelligibility of transmitted information, making it harder to recover the original message.";
} else if (lowerCommand.includes('what is an antenna') || lowerCommand.includes('define antenna')) {
    action.executed = true;
    action.response = "An antenna is a transducer designed to transmit or receive electromagnetic waves. It converts electrical signals into electromagnetic waves for transmission, and vice versa for reception. Antennas come in various shapes and sizes depending on their application.";
} else if (lowerCommand.includes('what is bandwidth') || lowerCommand.includes('define bandwidth')) {
    action.executed = true;
    action.response = "Bandwidth in communication refers to the range of frequencies occupied by a signal, or the capacity of a transmission medium to carry data. A larger bandwidth generally means more data can be transmitted in a given time.";
} else if (lowerCommand.includes('what is data rate') || lowerCommand.includes('define data rate')) {
    action.executed = true;
    action.response = "Data rate, or bit rate, is the number of bits that are conveyed or processed per unit of time. It's typically measured in bits per second (bps) and represents the speed at which digital information is transferred.";
} else if (lowerCommand.includes('what is channel capacity')) {
    action.executed = true;
    action.response = "Channel capacity is the maximum rate at which information can be transmitted over a communication channel with arbitrarily small error probability. It's often defined by the Shannon-Hartley theorem, which relates it to bandwidth and signal-to-noise ratio.";
} else if (lowerCommand.includes('what is signal to noise ratio') || lowerCommand.includes('SNR')) {
    action.executed = true;
    action.response = "Signal-to-Noise Ratio (SNR) is a measure used in science and engineering that compares the level of a desired signal to the level of background noise. A higher SNR indicates a clearer signal with less contamination from noise.";
} else if (lowerCommand.includes('what is a transmission line')) {
    action.executed = true;
    action.response = "A transmission line is a specialized cable or other structure designed to carry alternating current of radio frequency, as well as data or power, with minimal signal loss. Examples include coaxial cables and waveguides.";
} else if (lowerCommand.includes('what is impedance matching')) {
    action.executed = true;
    action.response = "Impedance matching is the practice of designing the input impedance of an electrical load or the output impedance of its corresponding signal source to maximize power transfer or minimize signal reflection. It's crucial in RF and audio systems.";
} else if (lowerCommand.includes('what is reflection coefficient')) {
    action.executed = true;
    action.response = "The reflection coefficient ($\Gamma$) in a transmission line describes the proportion of an electromagnetic wave that is reflected by an impedance discontinuity in the transmission medium. It's a complex number ranging from -1 to 1.";
} else if (lowerCommand.includes('what is VSWR') || lowerCommand.includes('Voltage Standing Wave Ratio')) {
    action.executed = true;
    action.response = "VSWR (Voltage Standing Wave Ratio) is a measure of impedance mismatch in a transmission line. It's the ratio of the maximum to minimum voltage in a standing wave pattern, indicating how much power is reflected back toward the source.";
} else if (lowerCommand.includes('what is spread spectrum') || lowerCommand.includes('spread spectrum communication')) {
    action.executed = true;
    action.response = "Spread spectrum is a technique in telecommunication in which a signal is deliberately spread in the frequency domain, resulting in a wider bandwidth than the information content, for the purpose of making it more robust to interference and jamming.";
} else if (lowerCommand.includes('what is OFDM') || lowerCommand.includes('Orthogonal Frequency Division Multiplexing')) {
    action.executed = true;
    action.response = "OFDM (Orthogonal Frequency Division Multiplexing) is a method of encoding digital data on multiple carrier frequencies. It's a robust modulation technique used in modern high-speed communication systems like Wi-Fi, 4G/5G, and DSL.";
} else if (lowerCommand.includes('what is MIMO') || lowerCommand.includes('Multiple-Input Multiple-Output')) {
    action.executed = true;
    action.response = "MIMO (Multiple-Input Multiple-Output) is an antenna technology for wireless communications in which multiple antennas are used at both the transmitter and receiver. It enhances data throughput and link range without requiring additional bandwidth or transmit power.";
} else if (lowerCommand.includes('what is CDMA') || lowerCommand.includes('Code Division Multiple Access')) {
    action.executed = true;
    action.response = "CDMA (Code Division Multiple Access) is a channel access method used by various radio communication technologies. It allows multiple users to share a common channel simultaneously by assigning a unique code to each user, differentiating their signals.";
} else if (lowerCommand.includes('what is a DC-DC converter') || lowerCommand.includes('DC to DC converter')) {
    action.executed = true;
    action.response = "A DC-DC converter is an electronic circuit that converts a source of direct current (DC) from one voltage level to another. They are essential in portable electronic devices and renewable energy systems.";
} else if (lowerCommand.includes('what is a buck converter')) {
    action.executed = true;
    action.response = "A buck converter (step-down converter) is a type of DC-DC converter that converts a higher input DC voltage to a lower output DC voltage. It's widely used in power supplies.";
} else if (lowerCommand.includes('what is a boost converter')) {
    action.executed = true;
    action.response = "A boost converter (step-up converter) is a type of DC-DC converter that converts a lower input DC voltage to a higher output DC voltage. It's used in applications requiring a higher voltage than the available source.";
} else if (lowerCommand.includes('what is a buck-boost converter') || lowerCommand.includes('buck boost converter')) {
    action.executed = true;
    action.response = "A buck-boost converter is a type of DC-DC converter that can produce an output voltage magnitude that is either greater than or less than the input voltage magnitude. The output voltage is of opposite polarity to the input.";
} else if (lowerCommand.includes('what is an inverter') || lowerCommand.includes('power inverter')) {
    action.executed = true;
    action.response = "An inverter is an electronic device that converts direct current (DC) to alternating current (AC). It's crucial for applications like solar power systems, UPS (Uninterruptible Power Supplies), and variable frequency drives for AC motors.";
} else if (lowerCommand.includes('what is a switch mode power supply') || lowerCommand.includes('SMPS')) {
    action.executed = true;
    action.response = "An SMPS (Switch-Mode Power Supply) is an electronic power supply that incorporates a switching regulator to convert electrical power efficiently. It rapidly switches a power device between ON and OFF states to regulate the output voltage, offering high efficiency compared to linear power supplies.";
} else if (lowerCommand.includes('what is power factor') || lowerCommand.includes('power factor electronics')) {
    action.executed = true;
    action.response = "Power factor is a dimensionless quantity in AC circuits, defined as the ratio of real power flowing to the load to the apparent power in the circuit. It indicates how effectively electrical power is being used. A power factor closer to 1 (unity) is desirable.";
} else if (lowerCommand.includes('what is a transformer') || lowerCommand.includes('transformer electronics')) {
    action.executed = true;
    action.response = "A transformer is a passive electrical device that transfers electrical energy from one electrical circuit to another, or multiple circuits. A varying current in one coil of the transformer produces a varying magnetic flux in the transformer's core, which in turn induces a varying electromotive force across a second coil.";
} else if (lowerCommand.includes('what is a UPS') || lowerCommand.includes('Uninterruptible Power Supply')) {
    action.executed = true;
    action.response = "A UPS (Uninterruptible Power Supply) is an electrical apparatus that provides emergency power to a load when the input power source or mains power fails. It typically contains a battery and an inverter, ensuring continuous power to critical equipment.";
} else if (lowerCommand.includes('what is an oscilloscope')) {
    action.executed = true;
    action.response = "An oscilloscope is an electronic test instrument that graphically displays varying signal voltages, usually as a two-dimensional plot of one or more signals as a function of time. It's indispensable for observing and analyzing waveforms.";
} else if (lowerCommand.includes('what is a multimeter')) {
    action.executed = true;
    action.response = "A multimeter is an electronic measuring instrument that combines several measurement functions in one unit. A typical multimeter can measure voltage, current, and resistance, and some can also measure capacitance, frequency, and temperature.";
} else if (lowerCommand.includes('what is a function generator')) {
    action.executed = true;
    action.response = "A function generator is a piece of electronic test equipment used to generate various types of electrical waveforms over a wide range of frequencies. Common waveforms include sine, square, triangle, and sawtooth waves.";
} else if (lowerCommand.includes('what is a logic analyzer')) {
    action.executed = true;
    action.response = "A logic analyzer is an electronic instrument that captures and displays multiple digital signals from a digital system or circuit. Unlike an oscilloscope, which displays analog waveforms, a logic analyzer focuses on the timing and logic states (high/low) of digital signals.";
} else if (lowerCommand.includes('what is a spectrum analyzer')) {
    action.executed = true;
    action.response = "A spectrum analyzer is an electronic instrument that measures the magnitude of an input signal versus frequency within the full frequency range of the instrument. Its primary use is to measure the power of the spectrum of known and unknown signals.";
} else if (lowerCommand.includes('what is a signal generator')) {
    action.executed = true;
    action.response = "A signal generator is an electronic device that generates repeating or non-repeating electronic signals (waveforms) in either the analog or digital domain. These are used as stimuli for testing electronic designs, for example, to test the frequency response of an amplifier.";
} else if (lowerCommand.includes('what is an LCR meter')) {
    action.executed = true;
    action.response = "An LCR meter is a piece of electronic test equipment used to measure the inductance (L), capacitance (C), and resistance (R) of an electronic component. It can also measure other derived parameters like Q factor and dissipation factor.";
} else if (lowerCommand.includes('what is a power supply') || lowerCommand.includes('lab power supply')) {
    action.executed = true;
    action.response = "A power supply is an electrical device that supplies electric power to an electrical load. It's typically used to convert one form of electrical energy to another, regulating the output voltage and current to provide stable power for testing and operating circuits.";
} else if (lowerCommand.includes('what is calibration') || lowerCommand.includes('instrument calibration')) {
    action.executed = true;
    action.response = "Calibration is the process of configuring an instrument to provide a result for a sample within an acceptable range. It involves comparing the readings of a measurement device against a known standard to ensure accuracy.";
} else if (lowerCommand.includes('what is a PCB') || lowerCommand.includes('Printed Circuit Board')) {
    action.executed = true;
    action.response = "A PCB (Printed Circuit Board) is a board used to mechanically support and electrically connect electronic components using conductive pathways, tracks, or signal traces etched from copper sheets laminated onto a non-conductive substrate. It's the foundation of almost all electronic devices.";
} else if (lowerCommand.includes('what is soldering') || lowerCommand.includes('soldering electronics')) {
    action.executed = true;
    action.response = "Soldering is a process in which two or more items are joined together by melting and putting a filler metal (solder) into the joint, with the filler metal having a lower melting point than the adjoining metal. It's a common method for making electrical connections.";
} else if (lowerCommand.includes('what is surface mount technology') || lowerCommand.includes('SMT')) {
    action.executed = true;
    action.response = "SMT (Surface-Mount Technology) is a method for producing electronic circuits in which the components are mounted directly onto the surface of printed circuit boards (PCBs). This contrasts with through-hole technology, where components have leads that are inserted into holes.";
} else if (lowerCommand.includes('what is through-hole technology') || lowerCommand.includes('THT')) {
    action.executed = true;
    action.response = "Through-Hole Technology (THT) is a method for constructing electronic circuits by inserting components' leads through holes in printed circuit boards (PCBs) and soldering them on the opposite side. It's a traditional method, often more robust than SMT for certain components.";
} else if (lowerCommand.includes('what is a semiconductor') || lowerCommand.includes('semiconductor material')) {
    action.executed = true;
    action.response = "A semiconductor is a material that has electrical conductivity between that of a conductor (like copper) and an insulator (like glass). Their conductivity can be controlled, making them fundamental to modern electronics.";
} else if (lowerCommand.includes('what is silicon') || lowerCommand.includes('silicon electronics')) {
    action.executed = true;
    action.response = "Silicon (Si) is a chemical element that is the most common semiconductor material used in electronic devices. Its unique atomic structure allows it to be easily doped, forming the basis for integrated circuits, transistors, and solar cells.";
} else if (lowerCommand.includes('what is gallium nitride') || lowerCommand.includes('GaN electronics')) {
    action.executed = true;
    action.response = "Gallium Nitride (GaN) is a wide-bandgap semiconductor material that is becoming increasingly important in power electronics and RF applications. It offers higher efficiency, faster switching speeds, and smaller form factors compared to traditional silicon devices.";
} else if (lowerCommand.includes('what is a control system')) {
    action.executed = true;
    action.response = "A control system is a device or set of devices that manages, commands, directs, or regulates the behavior of other devices or systems. It's designed to achieve a desired output by controlling various inputs.";
} else if (lowerCommand.includes('what is open-loop control') || lowerCommand.includes('open loop control')) {
    action.executed = true;
    action.response = "An open-loop control system is a type of control system where the control action is independent of the output. The system does not use feedback to determine if the desired output has been achieved, making it simpler but less accurate.";
} else if (lowerCommand.includes('what is closed-loop control') || lowerCommand.includes('feedback control')) {
    action.executed = true;
    action.response = "A closed-loop control system, or feedback control system, is a type of control system where the control action is dependent on the output. It uses feedback from the output to adjust its control action, aiming to achieve and maintain a desired setpoint.";
} else if (lowerCommand.includes('what is PID control') || lowerCommand.includes('PID controller')) {
    action.executed = true;
    action.response = "PID (Proportional-Integral-Derivative) control is a widely used feedback control loop mechanism in industrial control systems and other applications requiring continuously modulated control. It continuously calculates an error value and applies a correction based on proportional, integral, and derivative terms.";
} else if (lowerCommand.includes('what is a setpoint') || lowerCommand.includes('setpoint control')) {
    action.executed = true;
    action.response = "In a control system, the setpoint is the desired or target value for the controlled variable. The controller's goal is to manipulate inputs to bring the system's actual output as close as possible to the setpoint.";
} else if (lowerCommand.includes('what is stability in control systems') || lowerCommand.includes('control system stability')) {
    action.executed = true;
    action.response = "Stability in control systems refers to the ability of a system to return to its equilibrium state or desired operating point after being disturbed. An unstable system will exhibit unbounded oscillations or diverge from its operating point.";
} else if (lowerCommand.includes('what is c pro') || lowerCommand.includes('what is c programming') || lowerCommand.includes('c programming')) {
    action.executed = true;
    action.response = "C programming (often referred to as 'C Pro' in a general sense for professional application) is a powerful, general-purpose programming language widely used for system programming, embedded systems, and applications where performance is critical. It's a foundational language for many other languages.";
} else if (lowerCommand.includes('what is matlab')) {
    action.executed = true;
    action.response = "MATLAB (Matrix Laboratory) is a proprietary multi-paradigm programming language and numerical computing environment developed by MathWorks. It's primarily used for numerical computation, visualization, and programming, especially in engineering and scientific fields.";
} else if (lowerCommand.includes('what is arduino language') || lowerCommand.includes('arduino programming language')) {
    action.executed = true;
    action.response = "The Arduino programming language is a simplified version of C/C++. It consists of two main functions: 'setup()' for initialization and 'loop()' for the main program logic, and uses a set of specific functions and libraries designed to easily interact with the Arduino hardware.";
} else if (lowerCommand.includes('what is python for electronics') || lowerCommand.includes('python electronics')) {
    action.executed = true;
    action.response = "Python is a high-level, interpreted programming language widely used in electronics for data analysis, automation (e.g., controlling test equipment), scripting for Raspberry Pi and other SBCs, and developing user interfaces for embedded systems. Its simplicity and extensive libraries make it very versatile.";
} else if (lowerCommand.includes('what is assembly language') || lowerCommand.includes('assembly language electronics')) {
    action.executed = true;
    action.response = "Assembly language is a low-level programming language that is very close to machine code. Each instruction in assembly language typically corresponds to a single machine instruction. It's used for highly optimized code in embedded systems where direct hardware control and performance are critical.";
} else if (lowerCommand.includes('what is a NAND gate')) {
    action.executed = true;
    action.response = "A NAND gate is a digital logic gate that produces a low output (0) only if all its inputs are high (1). If any input is low (0), the output is high (1). It's considered a universal gate because any other logic gate can be implemented using only NAND gates.";
} else if (lowerCommand.includes('what is a NOR gate')) {
    action.executed = true;
    action.response = "A NOR gate is a digital logic gate that produces a high output (1) only if all its inputs are low (0). If any input is high (1), the output is low (0). It's also a universal gate.";
} else if (lowerCommand.includes('what is an XNOR gate')) {
    action.executed = true;
    action.response = "An XNOR (Exclusive-NOR) gate is a digital logic gate that produces a high output (1) if both of its inputs are the same (both 0 or both 1). If the inputs are different, the output is low (0). It's the complement of an XOR gate.";
} else if (lowerCommand.includes('what is a D flip-flop') || lowerCommand.includes('D flip flop')) {
    action.executed = true;
    action.response = "A D (Data) flip-flop is a basic storage element that stores the value present on its data input (D) when the clock signal transitions. It's used for storing a single bit of data and is fundamental in registers and memory.";
} else if (lowerCommand.includes('what is a JK flip-flop') || lowerCommand.includes('JK flip flop')) {
    action.executed = true;
    action.response = "A JK flip-flop is a versatile type of flip-flop with two inputs, J (set) and K (reset), which can cause the output to toggle, set, or reset depending on the input combination and clock signal. It can behave as a SR flip-flop or a T flip-flop.";
} else if (lowerCommand.includes('what is a counter type') || lowerCommand.includes('ripple counter')) {
    action.executed = true;
    action.response = "A ripple counter (or asynchronous counter) is a sequential logic circuit where the flip-flop output of one stage serves as the clock input for the next stage. The clock signal 'ripples' through the stages, leading to a propagation delay.";
} else if (lowerCommand.includes('what is a synchronous counter')) {
    action.executed = true;
    action.response = "A synchronous counter is a sequential logic circuit where all flip-flops are clocked simultaneously by a common clock signal. This eliminates the propagation delay issues seen in ripple counters, allowing for higher operating speeds.";
} else if (lowerCommand.includes('what is EEPROM') || lowerCommand.includes('Electrically Erasable Programmable Read-Only Memory')) {
    action.executed = true;
    action.response = "EEPROM (Electrically Erasable Programmable Read-Only Memory) is a type of non-volatile memory that can be erased and reprogrammed electrically, usually a byte at a time. It's commonly used for storing small amounts of configuration data in microcontrollers and other devices.";
} else if (lowerCommand.includes('what is a microprocessor')) {
    action.executed = true;
    action.response = "A microprocessor (MPU) is a computer processor on a single integrated circuit. It contains the central processing unit (CPU) but typically requires external memory and peripheral components to form a complete system. It's more powerful than a microcontroller for general-purpose computing.";
} else if (lowerCommand.includes('what is mesh analysis')) {
    action.executed = true;
    action.response = "Mesh analysis is a circuit analysis technique used to solve for unknown currents in a circuit. It applies Kirchhoff's Voltage Law (KVL) to each closed loop (mesh) in the circuit, resulting in a set of simultaneous equations.";
} else if (lowerCommand.includes('what is nodal analysis')) {
    action.executed = true;
    action.response = "Nodal analysis is a circuit analysis technique used to solve for unknown node voltages in a circuit. It applies Kirchhoff's Current Law (KCL) to each non-reference node, resulting in a set of simultaneous equations.";
} else if (lowerCommand.includes('what are phasors') || lowerCommand.includes('phasor diagram')) {
    action.executed = true;
    action.response = "Phasors are complex numbers that represent sinusoidal waveforms in AC circuit analysis. They simplify the representation and analysis of AC circuits by converting time-domain sine waves into frequency-domain vectors.";
} else if (lowerCommand.includes('what is complex power')) {
    action.executed = true;
    action.response = "Complex power (S) in an AC circuit is the sum of real power (P, in Watts) and reactive power (Q, in VARs). It's a complex number where the real part is real power and the imaginary part is reactive power. It's used to analyze power flow in AC systems.";
} else if (lowerCommand.includes('what is power factor correction')) {
    action.executed = true;
    action.response = "Power factor correction is the technique of improving the power factor of an AC electrical power system. This is typically achieved by adding capacitors to the circuit to compensate for the reactive power caused by inductive loads, reducing energy waste.";
} else if (lowerCommand.includes('what is a linear circuit')) {
    action.executed = true;
    action.response = "A linear circuit is an electrical circuit whose output is directly proportional to its input. It obeys the principles of superposition and homogeneity (scaling), meaning that its behavior can be described by linear differential equations.";
} else if (lowerCommand.includes('what is a nonlinear circuit')) {
    action.executed = true;
    action.response = "A nonlinear circuit is an electrical circuit that contains at least one nonlinear component (e.g., diodes, transistors in certain operating regions) whose output is not directly proportional to its input. These circuits do not obey superposition and are harder to analyze.";
} else if (lowerCommand.includes('what is a differential amplifier')) {
    action.executed = true;
    action.response = "A differential amplifier is a type of electronic amplifier that amplifies the difference between two input signals while rejecting any common-mode signals. It's a fundamental building block for op-amps and instrumentation amplifiers.";
} else if (lowerCommand.includes('what is a power amplifier')) {
    action.executed = true;
    action.response = "A power amplifier is an electronic amplifier that amplifies low-power electronic audio or radio signals to a level strong enough for driving loudspeakers, radio transmitters, or other output devices. Its main goal is to deliver significant power to a load.";
} else if (lowerCommand.includes('what is a preamplifier') || lowerCommand.includes('preamp')) {
    action.executed = true;
    action.response = "A preamplifier (preamp) is an electronic amplifier that converts a weak electrical signal into an output signal strong enough to be noise-tolerant and transmitted to a main amplifier or further processing. It's typically used to boost signals from sensors or microphones.";
} else if (lowerCommand.includes('what is a filter type') || lowerCommand.includes('active filter')) {
    action.executed = true;
    action.response = "An active filter is a type of electronic filter that uses active components like op-amps or transistors in addition to passive components (resistors, capacitors). Active filters can achieve higher gain, steeper roll-offs, and do not require inductors, making them more suitable for low-frequency applications.";
} else if (lowerCommand.includes('what is a passive filter')) {
    action.executed = true;
    action.response = "A passive filter is a type of electronic filter that is composed only of passive components such as resistors, capacitors, and inductors. They are generally simpler and less expensive than active filters but offer less flexibility in terms of gain and Q factor.";
} else if (lowerCommand.includes('what is a Butterworth filter')) {
    action.executed = true;
    action.response = "A Butterworth filter is a type of signal processing filter designed to have a frequency response that is as flat as possible in the passband. It's known for its maximally flat magnitude response, without ripples in the passband or stopband.";
} else if (lowerCommand.includes('what is a Chebyshev filter')) {
    action.executed = true;
    action.response = "A Chebyshev filter is a type of electronic filter that has a steeper roll-off and more ripple in the passband (Type I) or stopband (Type II) than a Butterworth filter. It achieves a faster transition from passband to stopband at the expense of ripple.";
} else if (lowerCommand.includes('what is a laser diode')) {
    action.executed = true;
    action.response = "A laser diode is a semiconductor device that emits coherent light through a process called stimulated emission. It's similar to an LED but produces a highly directional, monochromatic, and coherent light beam, used in fiber optics, barcode scanners, and laser pointers.";
} else if (lowerCommand.includes('what is an LED type') || lowerCommand.includes('OLED') || lowerCommand.includes('organic light emitting diode')) {
    action.executed = true;
    action.response = "An OLED (Organic Light-Emitting Diode) is a type of LED that uses an organic compound as the electroluminescent material. OLED displays are known for their high contrast, deep blacks, wide viewing angles, and faster response times compared to traditional LCDs.";
} else if (lowerCommand.includes('what is a unijunction transistor') || lowerCommand.includes('UJT')) {
    action.executed = true;
    action.response = "A UJT (Unijunction Transistor) is a three-terminal semiconductor device that has only one PN junction. It's primarily used as an electronically controlled switch or for triggering other devices like SCRs and TRIACs in timing and oscillator circuits.";
} else if (lowerCommand.includes('what is a programmable unijunction transistor') || lowerCommand.includes('PUT')) {
    action.executed = true;
    action.response = "A PUT (Programmable Unijunction Transistor) is a type of thyristor that acts like a UJT but its firing voltage can be set by an external voltage divider. It's useful in precision timer circuits and oscillators.";
} else if (lowerCommand.includes('what is IC packaging') || lowerCommand.includes('integrated circuit packaging')) {
    action.executed = true;
    action.response = "IC packaging refers to the housing or enclosure for an integrated circuit (IC) chip. It protects the chip from physical damage and corrosion, and provides electrical connections for power and signals. Common packages include DIP, SOP, QFN, and BGA.";
} else if (lowerCommand.includes('what is a flow sensor')) {
    action.executed = true;
    action.response = "A flow sensor is a device that measures the rate of fluid or gas movement. It's critical in industrial processes, water management, and HVAC systems for monitoring and control.";
} else if (lowerCommand.includes('what is a level sensor')) {
    action.executed = true;
    action.response = "A level sensor is a device that detects the level of liquids, solids, or granular materials within a container or in open air. They are used in tanks, bins, and silos to monitor fill levels and prevent overfilling or running dry.";
} else if (lowerCommand.includes('what is a strain gauge')) {
    action.executed = true;
    action.response = "A strain gauge is a sensor whose resistance varies with applied force. It converts force, pressure, tension, and weight into an electrical signal that can be measured. They are fundamental in load cells and structural health monitoring.";
} else if (lowerCommand.includes('what is a hall effect sensor')) {
    action.executed = true;
    action.response = "A Hall effect sensor is a transducer that varies its output voltage in response to a magnetic field. It can be used for proximity sensing, positioning, speed detection, and current sensing.";
} else if (lowerCommand.includes('what is a lidar sensor') || lowerCommand.includes('lidar')) {
    action.executed = true;
    action.response = "Lidar (Light Detection and Ranging) is a remote sensing method that uses pulsed laser light to measure ranges (variable distances) to the Earth. It creates 3D point clouds and is used in autonomous vehicles, robotics, and mapping.";
} else if (lowerCommand.includes('what is a radar sensor') || lowerCommand.includes('radar')) {
    action.executed = true;
    action.response = "Radar (Radio Detection and Ranging) is a detection system that uses radio waves to determine the range, angle, or velocity of objects. It's used in automotive safety, weather forecasting, and air traffic control.";
} else if (lowerCommand.includes('what is a MEMS sensor') || lowerCommand.includes('MEMS')) {
    action.executed = true;
    action.response = "MEMS (Micro-Electro-Mechanical Systems) sensors are miniature devices that combine electrical and mechanical components on a microscopic scale. They are widely used in accelerometers, gyroscopes, pressure sensors, and microphones found in smartphones and wearables.";
} else if (lowerCommand.includes('what is CAN bus') || lowerCommand.includes('CAN protocol')) {
    action.executed = true;
    action.response = "CAN (Controller Area Network) bus is a robust vehicle bus standard designed to allow microcontrollers and devices to communicate with each other in applications without a host computer. It's widely used in automotive and industrial automation.";
} else if (lowerCommand.includes('what is Ethernet for embedded systems') || lowerCommand.includes('embedded ethernet')) {
    action.executed = true;
    action.response = "Ethernet in embedded systems allows devices to connect to local area networks (LANs) and the internet using standard Ethernet protocols. This enables high-speed data transfer, remote monitoring, and integration with existing network infrastructure.";
} else if (lowerCommand.includes('what is USB for embedded systems') || lowerCommand.includes('embedded USB')) {
    action.executed = true;
    action.response = "USB (Universal Serial Bus) in embedded systems provides a common interface for connecting peripheral devices like sensors, displays, and storage to microcontrollers. It supports various data rates and power delivery, simplifying connectivity.";
} else if (lowerCommand.includes('what is memory organization in microcontroller') || lowerCommand.includes('microcontroller memory organization')) {
    action.executed = true;
    action.response = "Memory organization in a microcontroller refers to how different types of memory (Flash, SRAM, EEPROM) are structured and addressed by the CPU. Understanding this is crucial for efficient programming and resource management.";
} else if (lowerCommand.includes('what is pipelining in CPU') || lowerCommand.includes('CPU pipelining')) {
    action.executed = true;
    action.response = "Pipelining is a technique used in microprocessor design where multiple instructions are executed concurrently in different stages of the CPU pipeline. This increases instruction throughput and overall processor performance.";
} else if (lowerCommand.includes('what is latency in embedded systems') || lowerCommand.includes('embedded system latency')) {
    action.executed = true;
    action.response = "Latency in embedded systems refers to the delay between when an event occurs (e.g., a sensor reading) and when the system reacts to it. Low latency is critical for real-time applications.";
} else if (lowerCommand.includes('what is jitter in embedded systems') || lowerCommand.includes('embedded system jitter')) {
    action.executed = true;
    action.response = "Jitter in embedded systems refers to the variation in latency or the deviation from true periodicity of a signal or event. Excessive jitter can degrade the performance of real-time control systems and communication links.";
} else if (lowerCommand.includes('what is OPC UA') || lowerCommand.includes('OPC Unified Architecture')) {
    action.executed = true;
    action.response = "OPC UA (Open Platform Communications Unified Architecture) is an industrial interoperability standard that enables the secure and reliable exchange of data between industrial equipment and systems from different vendors. It's crucial for IIoT communication.";
} else if (lowerCommand.includes('what is a message broker') || lowerCommand.includes('IoT message broker')) {
    action.executed = true;
    action.response = "An IoT message broker is a server that handles message routing and queuing between IoT devices and applications. It facilitates communication in publish-subscribe models, ensuring messages are delivered reliably and efficiently, even with many connected devices.";
} else if (lowerCommand.includes('what is simplex communication') || lowerCommand.includes('simplex mode')) {
    action.executed = true;
    action.response = "Simplex communication is a communication mode where data can flow in only one direction, from the transmitter to the receiver. Examples include traditional radio broadcasting or a security camera streaming video.";
} else if (lowerCommand.includes('what is half-duplex communication') || lowerCommand.includes('half duplex mode')) {
    action.executed = true;
    action.response = "Half-duplex communication is a communication mode where data can flow in both directions, but not simultaneously. Devices must take turns transmitting and receiving, like a walkie-talkie.";
} else if (lowerCommand.includes('what is full-duplex communication') || lowerCommand.includes('full duplex mode')) {
    action.executed = true;
    action.response = "Full-duplex communication is a communication mode where data can flow in both directions simultaneously. This allows for continuous two-way communication, such as in a telephone conversation or Ethernet network.";
} else if (lowerCommand.includes('what is error detection and correction') || lowerCommand.includes('error correction communication')) {
    action.executed = true;
    action.response = "Error detection and correction techniques are methods used in digital communication to identify and fix errors that may occur during data transmission due to noise or interference. Common methods include parity checks, checksums, and Hamming codes.";
} else if (lowerCommand.includes('what is a waveguide') || lowerCommand.includes('waveguide RF')) {
    action.executed = true;
    action.response = "A waveguide is a structure that guides waves, such as electromagnetic waves or sound waves. In RF and microwave applications, it's typically a hollow metal pipe used to transmit high-frequency electromagnetic waves with low loss.";
} else if (lowerCommand.includes('what are S-parameters') || lowerCommand.includes('S parameters')) {
    action.executed = true;
    action.response = "S-parameters (scattering parameters) are a mathematical construct used in electrical engineering to describe the electrical behavior of linear electrical networks when undergoing various steady state stimuli by electrical signals. They are particularly useful for characterizing high-frequency components and transmission lines.";
} else if (lowerCommand.includes('what is an impedance matching network') || lowerCommand.includes('matching network')) {
    action.executed = true;
    action.response = "An impedance matching network is an electrical network designed to transform the impedance of a source to match the impedance of a load. This maximizes power transfer and minimizes signal reflections in RF and microwave circuits.";
} else if (lowerCommand.includes('what is satellite communication')) {
    action.executed = true;
    action.response = "Satellite communication is a method of communication that uses artificial satellites to relay radio signals between Earth stations. It allows for global coverage and is used for television broadcasting, internet access, and mobile communication.";
} else if (lowerCommand.includes('what is cellular communication') || lowerCommand.includes('cellular network')) {
    action.executed = true;
    action.response = "Cellular communication is a type of wireless communication where the service area is divided into smaller geographical areas called 'cells,' each served by a base station. This allows for efficient use of spectrum and high user capacity, as seen in mobile phone networks.";
} else if (lowerCommand.includes('what is fiber optic communication') || lowerCommand.includes('fiber optics')) {
    action.executed = true;
    action.response = "Fiber optic communication is a method of transmitting information from one place to another by sending pulses of light through an optical fiber. It offers high bandwidth, long-distance transmission, and immunity to electromagnetic interference.";
} else if (lowerCommand.includes('what is a modem')) {
    action.executed = true;
    action.response = "A modem (modulator-demodulator) is a network hardware device that modulates one or more carrier wave signals to encode digital information for transmission and demodulates signals to decode the transmitted information. It's used to connect computers to the internet over telephone lines, cable, or fiber.";
} else if (lowerCommand.includes('what is a full-wave rectifier') || lowerCommand.includes('full wave rectifier')) {
    action.executed = true;
    action.response = "A full-wave rectifier is an electrical circuit that converts both halves of an alternating current (AC) input into a pulsating direct current (DC) output. This makes it more efficient than a half-wave rectifier, providing a smoother DC output after filtering.";
} else if (lowerCommand.includes('what is a bridge rectifier')) {
    action.executed = true;
    action.response = "A bridge rectifier is a type of full-wave rectifier circuit that uses four diodes to provide an efficient conversion of alternating current (AC) input to direct current (DC) output. It's commonly used in power supplies for its simplicity and effectiveness.";
} else if (lowerCommand.includes('what is a linear power supply')) {
    action.executed = true;
    action.response = "A linear power supply is a power supply that uses a linear regulator to maintain a constant output voltage. It achieves regulation by dissipating excess voltage as heat, making it less efficient but often resulting in lower noise and ripple compared to SMPS.";
} else if (lowerCommand.includes('what is active power') || lowerCommand.includes('real power')) {
    action.executed = true;
    action.response = "Active power (also known as real power) is the actual power consumed by the load in an AC circuit. It is the component of power that results in the dissipation of energy, such as heat, light, or mechanical work, measured in Watts (W).";
} else if (lowerCommand.includes('what is reactive power')) {
    action.executed = true;
    action.response = "Reactive power is the power that oscillates between the source and the reactive components (inductors and capacitors) in an AC circuit. It does not perform any useful work but is necessary for the operation of inductive loads. It is measured in Volt-Ampere Reactive (VAR).";
} else if (lowerCommand.includes('what is a data logger')) {
    action.executed = true;
    action.response = "A data logger is an electronic device that records data over time or in relation to location either with a built-in instrument or sensor or via external instruments and sensors. They are used for long-term monitoring of environmental conditions, process parameters, and more.";
} else if (lowerCommand.includes('what is an arbitrary waveform generator') || lowerCommand.includes('AWG')) {
    action.executed = true;
    action.response = "An Arbitrary Waveform Generator (AWG) is an electronic test equipment that can generate any desired waveform, unlike a standard function generator which produces only predefined waveforms (sine, square, etc.). AWGs are highly versatile for complex signal generation.";
} else if (lowerCommand.includes('what is ground in electronics') || lowerCommand.includes('ground electronics')) {
    action.executed = true;
    action.response = "Ground in electronics is the reference point in an electrical circuit from which voltages are measured. It also serves as a common return path for electric current and can provide a safety path for fault currents.";
} else if (lowerCommand.includes('what is a short circuit')) {
    action.executed = true;
    action.response = "A short circuit is an electrical circuit that allows current to travel along an unintended path with very low electrical impedance. This can cause excessive current flow, leading to overheating, damage to components, or fire.";
} else if (lowerCommand.includes('what is an open circuit')) {
    action.executed = true;
    action.response = "An open circuit is an electrical circuit in which the continuity has been broken, so that current cannot flow. This results in infinite resistance and zero current flow through the open part of the circuit.";
} else if (lowerCommand.includes('what is germanium') || lowerCommand.includes('germanium electronics')) {
    action.executed = true;
    action.response = "Germanium (Ge) is a chemical element that is also a semiconductor, historically used before silicon became dominant. It has a lower bandgap than silicon, making it useful in certain high-frequency and infrared applications, though less common today.";
} else if (lowerCommand.includes('what is a substrate') || lowerCommand.includes('substrate electronics')) {
    action.executed = true;
    action.response = "In electronics, a substrate is the base material on which components are fabricated or assembled. For PCBs, it's typically fiberglass; for ICs, it's a thin wafer of semiconductor material like silicon.";
} else if (lowerCommand.includes('what is etching') || lowerCommand.includes('etching PCB')) {
    action.executed = true;
    action.response = "Etching in PCB fabrication is the process of chemically removing unwanted copper from the board, leaving behind the desired conductive traces and pads. This is a key step in creating the circuit pattern.";
} else if (lowerCommand.includes('what is reflow soldering')) {
    action.executed = true;
    action.response = "Reflow soldering is a process in which solder paste (a mixture of powdered solder and flux) is used to temporarily attach surface-mount components to their contact pads, after which the entire assembly is subjected to controlled heat to melt the solder and form permanent electrical connections.";
} else if (lowerCommand.includes('what is a control loop')) {
    action.executed = true;
    action.response = "A control loop is a feedback mechanism in a control system where the output of the system is measured, compared to a desired setpoint, and the difference (error) is used to adjust the input to bring the output closer to the setpoint.";
} else if (lowerCommand.includes('what is a sensor in control systems') || lowerCommand.includes('control system sensor')) {
    action.executed = true;
    action.response = "In a control system, a sensor measures the actual value of the controlled variable (the output) and converts it into a signal that can be used by the controller. This feedback is essential for closed-loop control.";
} else if (lowerCommand.includes('what is a controller') || lowerCommand.includes('controller control system')) {
    action.executed = true;
    action.response = "In a control system, the controller is the component that receives the error signal (difference between setpoint and actual output) and generates an appropriate control action (input) to reduce that error and drive the system towards the setpoint.";
} else if (lowerCommand.includes('what is an actuator in control systems') || lowerCommand.includes('control system actuator')) {
    action.executed = true;
    action.response = "In a control system, an actuator is the component that converts a control signal from the controller into a physical action that affects the system being controlled. Examples include motors, valves, and heaters.";
} else if (lowerCommand.includes('what is steady-state error') || lowerCommand.includes('steady state error control')) {
    action.executed = true;
    action.response = "Steady-state error in a control system is the difference between the desired output (setpoint) and the actual output of the system after the transient response has settled. It's a measure of the system's accuracy at equilibrium.";
} else if (lowerCommand.includes('what is python programming')) {
    action.executed = true;
    action.response = "Python is a high-level, interpreted programming language known for its readability and versatility. It's widely used in web development, data analysis, artificial intelligence, scientific computing, and automation due to its extensive libraries and supportive community.";
} else if (lowerCommand.includes('what is java programming')) {
    action.executed = true;
    action.response = "Java is a high-level, class-based, object-oriented programming language designed to have as few implementation dependencies as possible. It's widely used for building enterprise-scale applications, Android apps, and web applications due to its portability and robustness.";
} else if (lowerCommand.includes('what is javascript programming')) {
    action.executed = true;
    action.response = "JavaScript is a versatile, high-level programming language primarily used for enhancing the interactivity of web pages. It runs in web browsers and on servers (via Node.js), enabling dynamic content, user interfaces, and full-stack development.";
} else if (lowerCommand.includes('what is c++ programming')) {
    action.executed = true;
    action.response = "C++ is a powerful, high-performance programming language that extends the C programming language with object-oriented features. It's widely used in system/software development, game development, real-time simulations, and performance-critical applications.";
} else if (lowerCommand.includes('what is embedded c') || lowerCommand.includes('embedded c programming')) {
    action.executed = true;
    action.response = "Embedded C is an extension of the C programming language specifically designed for programming microcontrollers and embedded systems. It includes additional features to handle hardware-specific tasks like direct memory access and peripheral control.";
} else if (lowerCommand.includes('what is VHDL') || lowerCommand.includes('VHDL programming')) {
    action.executed = true;
    action.response = "VHDL (VHSIC Hardware Description Language) is a hardware description language used to model electronic systems at various levels of abstraction. It's commonly used for designing and simulating digital circuits such as FPGAs and ASICs.";
} else if (lowerCommand.includes('what is verilog') || lowerCommand.includes('verilog programming')) {
    action.executed = true;
    action.response = "Verilog is a hardware description language used to model electronic systems. It allows designers to describe the structure and behavior of digital circuits and is widely used for designing FPGAs and ASICs.";
} else if (lowerCommand.includes('who created you') || lowerCommand.includes('who developed you') || lowerCommand.includes('you are developed by') || lowerCommand.includes('your developer') || lowerCommand.includes('your creator') || lowerCommand.includes('you are developed by whom')) {
    action.executed = true;
    action.response = "I was created by Indra, the founder of E-TECH SOLUTIONS.";
} 
 else if (lowerCommand.includes('about indra') || lowerCommand.includes('indra') || lowerCommand.includes('who is indra') || lowerCommand.includes('tell me about indra')) {
    action.executed = true;
    action.response = "INDRA, an electronics engineer and educator with over 3 years of experience. He passionates to make electronics education accessible to everyone through this platform, E-TECH SOLUTIONS.";
}else if (lowerCommand.includes('qualifications') || lowerCommand.includes('experience')) {
    action.executed = true;
    action.response = "INDRA holds a Diploma in Electronics and Communication Engineering, is a Certified IoT Specialist, has over 2 years of industry experience, 1 year of teaching experience, and has published over 20 technical papers.";
}
 else if (lowerCommand.includes('what is nanotechnology') || lowerCommand.includes('nanotech')) {
    action.executed = true;
    action.response = "Nanotechnology is the manipulation of matter at atomic and molecular scales to create new materials and devices with unique properties.";
} else if (lowerCommand.includes('what is digital electronics')) {
    action.executed = true;
    action.response = "Digital electronics deals with circuits that operate using discrete signal levels, often represented as binary values 0 and 1.";
} else if (lowerCommand.includes('what is analog electronics')) {
    action.executed = true;
    action.response = "Analog electronics deals with continuously varying signals and devices such as amplifiers and oscillators.";
} else if (lowerCommand.includes('what is ai') || lowerCommand.includes('artificial intelligence')) {
    action.executed = true;
    action.response = "Artificial Intelligence is the simulation of human intelligence in machines that are programmed to think, learn, and make decisions.";
} else if (lowerCommand.includes('what is machine learning') || lowerCommand.includes('ml')) {
    action.executed = true;
    action.response = "Machine Learning is a branch of AI that enables systems to learn from data and improve performance without explicit programming.";
} else if (lowerCommand.includes('what is robotics')) {
    action.executed = true;
    action.response = "Robotics is the interdisciplinary field involving design, construction, and operation of robots for performing tasks.";
} else if (lowerCommand.includes('what is automation')) {
    action.executed = true;
    action.response = "Automation is the use of technology to perform tasks with minimal human intervention, increasing efficiency and accuracy.";
} else if (lowerCommand.includes('what is electric current')) {
    action.executed = true;
    action.response = "Electric current is the flow of electric charge, usually carried by electrons, through a conductor.";
} else if (lowerCommand.includes('what is electric voltage')) {
    action.executed = true;
    action.response = "Voltage is the electric potential difference between two points, which drives current through a circuit.";
} else if (lowerCommand.includes('what is power electronics')) {
    action.executed = true;
    action.response = "Power electronics deals with the study and application of electronic devices for the control and conversion of electric power.";
} else if (lowerCommand.includes('what is renewable energy')) {
    action.executed = true;
    action.response = "Renewable energy comes from natural sources like sunlight, wind, and water, which are sustainable and naturally replenished.";
} else if (lowerCommand.includes('what is cloud computing')) {
    action.executed = true;
    action.response = "Cloud computing is the delivery of computing services such as storage, processing, and networking over the internet.";
} else if (lowerCommand.includes('what is blockchain')) {
    action.executed = true;
    action.response = "Blockchain is a decentralized digital ledger that records transactions securely across multiple computers.";
} else if (lowerCommand.includes('what is insulator')) {
    action.executed = true;
    action.response = "An insulator is a material that resists the flow of electric current, used to protect circuits and humans from electricity.";
} else if (lowerCommand.includes('what is conductor')) {
    action.executed = true;
    action.response = "A conductor is a material that allows the free flow of electric charge, such as copper and aluminum.";
} else if (lowerCommand.includes('what is superconductor')) {
    action.executed = true;
    action.response = "A superconductor is a material that exhibits zero electrical resistance when cooled below a critical temperature.";
} else if (lowerCommand.includes('what is capacitor bank')) {
    action.executed = true;
    action.response = "A capacitor bank is a group of capacitors connected together to store electrical energy and improve power factor.";
} else if (lowerCommand.includes('what is smps') || lowerCommand.includes('switched mode power supply')) {
    action.executed = true;
    action.response = "SMPS stands for Switched-Mode Power Supply, an electronic power supply that uses switching regulators to convert power efficiently.";
} else if (lowerCommand.includes('what is ups') || lowerCommand.includes('uninterruptible power supply')) {
    action.executed = true;
    action.response = "UPS is an Uninterruptible Power Supply that provides backup power during electrical outages.";
} else if (lowerCommand.includes('what is filter in electronics') || lowerCommand.includes('electronic filter')) {
    action.executed = true;
    action.response = "An electronic filter is a circuit that removes unwanted frequency components from a signal.";
} else if (lowerCommand.includes('what is multivibrator')) {
    action.executed = true;
    action.response = "A multivibrator is an electronic circuit used to implement oscillators, timers, and flip-flops.";
} else if (lowerCommand.includes('what is truth table')) {
    action.executed = true;
    action.response = "A truth table is a table showing all possible input values and the corresponding outputs of a logic circuit.";
} else if (lowerCommand.includes('what is binary number system') || lowerCommand.includes('binary system')) {
    action.executed = true;
    action.response = "The binary number system is a base-2 numeral system using only digits 0 and 1, fundamental to digital electronics.";
} else if (lowerCommand.includes('what is hexadecimal system') || lowerCommand.includes('hexadecimal')) {
    action.executed = true;
    action.response = "The hexadecimal number system is a base-16 system using digits 0-9 and letters A-F.";
} else if (lowerCommand.includes('what is octal system') || lowerCommand.includes('octal')) {
    action.executed = true;
    action.response = "The octal number system is a base-8 numeral system using digits 0 to 7.";
} else if (lowerCommand.includes('what is decimal system')) {
    action.executed = true;
    action.response = "The decimal number system is a base-10 numeral system using digits 0 to 9.";
} else if (lowerCommand.includes('what is half adder')) {
    action.executed = true;
    action.response = "A half adder is a digital circuit that adds two binary digits and outputs a sum and carry.";
} else if (lowerCommand.includes('what is full adder')) {
    action.executed = true;
    action.response = "A full adder is a digital circuit that adds three binary digits (including carry input) and outputs a sum and carry.";
} else if (lowerCommand.includes('what is half subtractor')) {
    action.executed = true;
    action.response = "A half subtractor is a digital circuit that subtracts two binary digits and outputs difference and borrow.";
} else if (lowerCommand.includes('what is full subtractor')) {
    action.executed = true;
    action.response = "A full subtractor is a digital circuit that subtracts three binary inputs (including borrow) and outputs difference and borrow.";
} else if (lowerCommand.includes('what is combinational circuit')) {
    action.executed = true;
    action.response = "A combinational circuit is a digital circuit where the output depends only on the present inputs.";
} 
 else if (lowerCommand.includes('what is sequential circuit')) {
    action.executed = true;
    action.response = "A sequential circuit is a digital circuit where the output depends on present inputs and past states.";
} 
                
                // 2. Open/Close Application (Modals)
                else if (lowerCommand.includes('open cart') || lowerCommand.includes('show cart')) {
                    cartModal.classList.add('open');
                    action.executed = true;
                    action.response = "Opening the shopping cart for you now.";
                } else if (lowerCommand.includes('close cart') || lowerCommand.includes('hide cart')) {
                    cartModal.classList.remove('open');
                    action.executed = true;
                    action.response = "Closing the shopping cart.";
                } else if (lowerCommand.includes('close assistant') || lowerCommand.includes('close chat')) {
                    techwhizModal.style.display = 'none';
                    if (synth.speaking) synth.cancel();
                    action.executed = true;
                    action.response = "Closing the assistant. Click the robot icon if you need me again!";
                } else if (lowerCommand.includes('show login') || lowerCommand.includes('open login')) {
                    authModal.style.display = 'flex';
                    action.executed = true;
                    action.response = "Opening the login/register module for you.";
                }

                // 3. Spontaneous Actions (Navigation within the app)
                else if (lowerCommand.includes('go to projects') || lowerCommand.includes('show me projects')) {
                    document.getElementById('projects').scrollIntoView({ behavior: 'smooth' });
                    action.executed = true;
                    action.response = "Scrolling down to the projects section now.";
                } else if (lowerCommand.includes('go to courses') || lowerCommand.includes('view courses')) {
                    document.getElementById('courses').scrollIntoView({ behavior: 'smooth' });
                    action.executed = true;
                    action.response = "Taking you to the available courses.";
                } else if (lowerCommand.includes('go to basics') || lowerCommand.includes('show basics')) {
                    document.getElementById('basics').scrollIntoView({ behavior: 'smooth' });
                    action.executed = true;
                    action.response = "Navigating to the Electronic Basics section.";
                }
                
                // 4. External Application Launches (New functionality)
                else if (lowerCommand.includes('open google')) {
                    window.open('https://www.google.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Google in a new tab.";
                }
                else if (lowerCommand.includes('open instagram')) {
                    window.open('https://www.instagram.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Instagram in a new tab.";
                } else if (lowerCommand.includes('open facebook')) {
                    window.open('https://www.facebook.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Facebook in a new tab.";
                }
                 else if (lowerCommand.includes('open youtube')) {
                    window.open('https://www.youtube.com', '_blank');
                    action.executed = true;
                    action.response = "Opening YouTube in a new tab.";
                } else if (lowerCommand.includes('open calculator')) {
                    window.open('https://www.google.com/search?q=calculator', '_blank');
                    action.executed = true;
                    action.response = "Opening a calculator in a new tab.";
                } else if (lowerCommand.includes('open whatsapp')) {
                    window.open('https://web.whatsapp.com', '_blank');
                    action.executed = true;
                    action.response = "Opening WhatsApp Web in a new tab.";
                } else if (lowerCommand.includes('open email') || lowerCommand.includes('open gmail')) {
                    window.open('https://mail.google.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Gmail in a new tab.";
                }
               
                else if (lowerCommand.includes('open twitter')) {
                    window.open('https://www.twitter.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Twitter in a new tab.";
                }
                else if (lowerCommand.includes('open linkedin')) {
                    window.open('https://www.linkedin.com', '_blank');
                    action.executed = true;
                    action.response = "Opening LinkedIn in a new tab.";
                }
                // 5. Status Check
                else if (lowerCommand.includes('what is my progress') || lowerCommand.includes('my completion status')) {
                    const completed = Object.keys(userProgress).length;
                    const total = allConcepts.length;
                    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
                    
                    if (!userId) {
                        action.response = "Please log in first to track your personalized learning progress.";
                    } else if (total === 0) {
                        action.response = "The learning path data is currently loading. Please try again in a moment.";
                    } else {
                        action.response = `You have completed ${completed} out of ${total} concepts, which is ${percentage} percent completion! Keep up the great work.`;
                    }
                    action.executed = true;
                }

                return action;
            }
            // --- END: Handle UI and Predefined Commands

            async function callGeminiApi(prompt, systemInstruction = null) {
                if (geminiApiKey === "") {
                    // This logic assumes the environment will inject the key, if not, it will fail gracefully.
                }
                
                let backoff = 1000;
                const maxRetries = 5;
                for (let i = 0; i < maxRetries; i++) {
                    try {
                        let chatHistoryForApi = [{ role: "user", parts: [{ text: prompt }] }];
                        const payload = {
                            contents: chatHistoryForApi,
                            systemInstruction: systemInstruction ? { parts: [{ text: systemInstruction }] } : undefined
                        };
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${geminiApiKey}`;

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            if (response.status === 429) {
                                await new Promise(resolve => setTimeout(resolve, backoff));
                                backoff *= 2;
                                continue;
                            }
                            const errorBody = await response.json();
                            throw new Error(`API error: ${response.status} - ${errorBody.error.message}`);
                        }
                        const result = await response.json();
                        return result.candidates?.[0]?.content?.parts?.[0]?.text || "I'm not sure how to respond to that.";
                    } catch (error) {
                        console.error("Error calling Gemini API:", error);
                        if (i === maxRetries - 1) throw error;
                    }
                }
            }

            // --- MODIFIED: processCommand to include predefined answers and spontaneous actions
            async function processCommand(command) {
                if (!command || techwhizInput.disabled) return;
                
                // Clear input only if it's not a voice command that populated it (recognition.onresult clears it)
                if (techwhizInput.value.trim() === command) {
                    techwhizInput.value = '';
                }

                // Show user message immediately
                appendMessage(command, 'user');
                
                techwhizInput.disabled = true;
                sendBtn.disabled = true;
                micBtn.disabled = true;
                thinkingStatus.classList.remove('hidden');

                try {
                    const lowerCommand = command.toLowerCase();
                    let responseText = '';
                    
                    // 1. Check for predefined UI/Action commands
                    const uiAction = handleUICommand(lowerCommand);

                    if (uiAction.executed) {
                        responseText = uiAction.response;
                    } else {
                        // 2. If not a predefined action, use Gemini API
                        let baseSystemInstruction = "You are a professional and helpful electronics and computer science assistant. Provide a friendly and concise answer. Respond exclusively in the language of the user's query. Do not refer to yourself as an AI or a language model.";

                        // Contextual hint for common electronics questions
                        if (lowerCommand.includes('arduino') || lowerCommand.includes('esp32') || lowerCommand.includes('resistor') || lowerCommand.includes('sensor')) {
                             baseSystemInstruction += " Provide a simple, clear explanation suitable for a beginner or hobbyist.";
                        }

                        responseText = await callGeminiApi(command, baseSystemInstruction);
                    }
                    
                    appendMessage(responseText, 'assistant');
                    readAloud(responseText);
                } catch (error) {
                    const errorMsg = "Sorry, I'm having trouble connecting to my brain right now. The API request failed.";
                    appendMessage(errorMsg, 'assistant');
                    readAloud(errorMsg);
                } finally {
                    // FIX: Re-enable ALL controls after processing, regardless of how the command started.
                    techwhizInput.disabled = false;
                    sendBtn.disabled = false;
                    micBtn.disabled = false;
// Cleanup visual state
                    thinkingStatus.classList.add('hidden');
                    micBtn.classList.remove('speech-active');
                    listeningStatus.classList.add('hidden');

                    techwhizInput.focus();
                }
            }
            
            // Initialization
            // Ensure the initial filter is applied to render projects immediately on load
            applyProjectFilter('all'); 
            updateCart();
            // Start the skill tree render with an empty progress object initially
            renderSkillTree({});
            
            if (window.renderMathInElement) {
                renderMathInElement(document.body);
            }
        });
    </script>
</body>
</html>






