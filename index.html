<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-TECH SOLUTIONS | Electronics & Computer Projects</title> 
     <link rel="icon" type="image/png" href="https://lh3.googleusercontent.com/pw/AP1GczNty6_2Cq0hySwk_JWjLVcINZz0lyqfq9BNLXjr9-qhG_94UV7oQLhTNB7VtAP8qM1G06Gj36pEqbZyvBWZlV4508OriC45KwQoabQ8qSRc5HHMGPVu=w2400?source=screenshot.guru">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- UPDATED: Added necessary Firebase Social Auth imports -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <!-- Load KaTeX for beautiful math/symbol rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" xintegrity="sha384-Gvr4iO9rQk5QxK3m1i5hI9jP5i5E6qE6kQ5A0tE4Q4p5/2w7J3w8P4q1n2p7Q3E" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" xintegrity="sha384-6Xh5n0k2f/rJvC9g2z8tN7i5hE6qE6kQ5A0tE4Q4p5/2w7J3w8P4q1n2p7Q3E" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" xintegrity="sha384-FpYtW5m3gT/4t7/p/K0m6p+g5/2w7J3w8P4q1n2p7Q3E" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
    <!-- NEW: Load D3.js for Skill Tree Visualization -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <style>
        :root {
            /* DARK THEME VARIABLES */
            --primary: #121212; /* Deep Dark Background */
            --secondary: #00e5ff; /* Cyan Accent - Main highlight */
            --accent: #ff4081; /* Pink Accent - Secondary highlight/call-to-action */
            --text-light: #ffffff; /* White text for visibility */
            --text-mid: #a0a0a0; /* Gray text for body/subtext */
            --card-bg: #1e1e1e; /* Slightly lighter card background */
            --border-color: #333333; /* Dark border lines */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--primary);
            color: var(--text-light); /* Ensure all body text is light */
            scroll-behavior: smooth;
            overflow-x: hidden;
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        /* High Visibility Text */
        .glow-text {
            text-shadow: 0 0 5px rgba(0, 229, 255, 0.2), 0 0 10px rgba(0, 229, 255, 0.4);
            color: var(--text-light);
        }
        
        /* NEW: E-TECH SOLUTIONS Heading Hover Effect */
        .logo-text.glow-text:hover {
            background: linear-gradient(135deg, var(--secondary), var(--accent), var(--secondary));
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: text-gradient-shift 1s linear infinite;
            text-shadow: 0 0 10px rgba(255, 64, 129, 0.8), 0 0 20px rgba(0, 229, 255, 0.5);
            transition: all 0.5s ease-in-out;
        }

        @keyframes text-gradient-shift {
            to {
                background-position: 200% center;
            }
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }

        header {
            background: rgba(18, 18, 18, 0.85); /* Semi-transparent dark header */
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            transition: transform 0.3s ease-in-out; /* Added transform transition */
        }
        
        /* NEW: Header Hiding Class */
        header.header-hidden {
            transform: translateY(-100%);
        }

        .header-container {
            display: flex;
            /* FIX: Ensure content does not wrap unnecessarily */
            flex-wrap: nowrap; 
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }
        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            white-space: nowrap; /* Prevent wrapping in desktop/tablet */
            min-width: 0;
        }
        .logo-text span {
            color: var(--accent);
        }
        nav a {
            color: var(--text-light);
            text-decoration: none;
            font-weight: 600;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
            position: relative;
        }
        nav a:hover {
            color: var(--secondary);
            text-shadow: 0 0 8px rgba(0, 229, 255, 0.5);
        }
        nav a.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 2px;
            background: linear-gradient(90deg, var(--secondary), var(--accent));
        }

        .mobile-toggle {
            display: none;
            cursor: pointer;
            font-size: 1.5rem;
        }

        .hero {
            padding: 10rem 0;
            text-align: center;
            position: relative;
            /* Added deep space background image */
            background-image: url('https://images.unsplash.com/photo-1517336714731-489689fd1ca8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            overflow: hidden;
        }
        
        /* Overlay for contrast */
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1;
        }

        .hero > .container {
            position: relative;
            z-index: 2;
        }
        
        .hero h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 3.5rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--secondary);
            text-shadow: 0 0 15px var(--secondary);
        }
        
        .section {
            padding: 8rem 0;
            position: relative;
        }

        .section-title h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            display: inline-block;
            margin-bottom: 2rem;
            /* Ensure the text is visible with gradient */
            background: linear-gradient(45deg, var(--secondary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.2);
        }
        
        /* Card Styles (Dark Mode, High Visibility) */
        .card-3d {
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }
        
        .card-3d:hover {
            transform: scale(1.05) translateZ(10px);
            box-shadow: 0 0 25px rgba(0, 229, 255, 0.4);
            border-color: var(--secondary);
        }
        
        .glassmorphism {
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }
        
        .neon-glow {
            box-shadow: 0 0 10px rgba(0, 229, 255, 0.3);
        }
        
        .btn-3d {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            color: var(--text-light); /* Default button text color */
        }
        
        .btn-3d:active {
            transform: translateY(2px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }

        /* NEW: Box Style for Action Buttons */
        .btn-box {
            border-radius: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        /* Styling for the Primary Action Buttons (Add to Cart, Checkout) */
        .btn-primary-action {
            background: linear-gradient(90deg, var(--secondary), var(--accent));
            color: var(--text-light);
            border: none;
        }
        .btn-primary-action:hover {
            opacity: 0.9;
            box-shadow: 0 0 15px var(--secondary);
            transform: scale(1.02);
        }
        
        /* NEW: Buy Now Button Styling - Slightly different from primary to distinguish */
        .btn-buy-now {
            background-color: var(--accent);
            color: var(--text-light);
            border: none;
        }
        .btn-buy-now:hover {
            opacity: 0.9;
            box-shadow: 0 0 15px var(--accent);
            transform: scale(1.02);
        }


        /* Styling for the Secondary/Disabled Buttons (Available Soon) */
        .btn-secondary-action {
            background-color: var(--card-bg);
            color: var(--text-mid);
            border: 1px solid var(--secondary);
        }
        .btn-secondary-action.disabled {
            background-color: #333333;
            border-color: #555555;
            color: #777777;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        /* Floating Button Positioning & Styling */
        #techwhiz-fab {
            bottom: 2rem;
            right: 2rem;
            z-index: 1001;
            width: 64px;
            height: 64px;
            border-radius: 0.5rem; /* Box Type */
        }

        /* TechWhiz Voice Active Indicator */
        #techwhiz-fab.speech-active {
            animation: pulse-ring 1.5s infinite;
            box-shadow: 0 0 30px rgba(0, 229, 255, 1);
        }

        @keyframes pulse-ring {
            0% { transform: scale(0.9); box-shadow: 0 0 0 0 rgba(0, 229, 255, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(0, 229, 255, 0); }
            100% { transform: scale(0.9); box-shadow: 0 0 0 0 rgba(0, 229, 255, 0); }
        }

        #cart-fab {
            /* Positioned 4rem (64px button height + 16px gap) above techwhiz-fab (2rem) */
            bottom: 6rem;
            right: 2rem;
            z-index: 1002; /* Above techwhiz */
            width: 60px;
            height: 60px;
            border-radius: 0.5rem; /* Box Type */
            background: linear-gradient(145deg, var(--secondary), var(--accent));
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: fixed; /* Added to ensure it floats */
        }
        
        #cart-fab:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 229, 255, 0.7);
        }

        #cart-fab:active {
            transform: translateY(2px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }

        #cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--accent);
            color: white;
            border-radius: 9999px;
            padding: 0.1rem 0.5rem;
            font-size: 0.75rem;
            font-weight: bold;
            line-height: 1;
        }

        /* Cart Modal Styling (Futuristic, Slides In) */
        #cart-modal {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            max-width: 400px; /* Enhanced max width */
            height: 100%;
            background: var(--card-bg);
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.7);
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 1003;
            display: flex;
            flex-direction: column;
            border-left: 2px solid var(--secondary); /* Neon border */
        }
        
        #cart-modal.open {
            transform: translateX(0);
        }
        
        .cart-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary); /* Header contrast */
        }
        
        .cart-header h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--secondary);
        }
        
        #close-cart-btn {
            font-size: 2rem;
            padding: 0 0.5rem;
            transition: color 0.2s;
        }
        
        #cart-modal-items {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem 1.5rem;
            background: var(--card-bg);
        }

        .cart-modal-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .cart-modal-item img {
            min-width: 48px;
            min-height: 48px;
        }
        
        /* NEW: Cart Item Controls Styling */
        .cart-controls button {
            width: 24px;
            height: 24px;
            background: var(--primary);
            color: var(--secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            line-height: 1;
            transition: background-color 0.2s, color 0.2s;
        }
        
        .cart-controls button:hover {
            background: var(--secondary);
            color: var(--primary);
        }

        .cart-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border-color);
            background: var(--primary);
        }
        
        .cart-total-display {
            display: flex;
            justify-content: space-between;
            font-size: 1.5rem;
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 1rem;
        }
        
        .cart-total-display span:last-child {
            color: var(--accent);
            text-shadow: 0 0 5px rgba(255, 64, 129, 0.5);
        }
        
        /* Component Detail Modal Styling */
        #component-detail-modal {
            background: rgba(0, 0, 0, 0.9);
            /* Centering fix applied here */
            display: none; /* Hidden by default */
            position: fixed;
            inset: 0;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            z-index: 1005;
        }
        
        #component-detail-content {
            background: var(--card-bg);
            border: 1px solid var(--secondary);
            box-shadow: 0 0 30px rgba(0, 229, 255, 0.5);
            color: var(--text-light);
            max-width: 800px;
            width: 100%;
            padding: 2rem;
            border-radius: 0.75rem;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        #component-detail-content .detail-header {
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
        
        #component-detail-content .detail-info h4 {
            color: var(--secondary);
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            font-family: 'Orbitron', sans-serif;
        }

        /* NEW: Canvas for Sensor Mock Visualization */
        #sensor-viz-canvas {
            width: 100%;
            height: 150px;
            background-color: #0d0d0d;
            border: 1px solid var(--accent);
            border-radius: 0.5rem;
            margin-top: 1rem;
        }

        /* New Styles for Dynamic Suggestions Sidebar */
        .suggestions-sidebar {
            position: fixed;
            top: 50%;
            left: 0;
            transform: translateY(-50%);
            width: 250px;
            background: rgba(30, 30, 30, 0.9);
            backdrop-filter: blur(5px);
            border-right: 2px solid var(--accent);
            border-top-right-radius: 10px;
            border-bottom-right-radius: 10px;
            padding: 1rem;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.5);
            z-index: 999;
            max-height: 60vh;
            overflow-y: auto;
        }
        .suggestions-sidebar a {
            text-decoration: none;
        }
        .progress-bar-container {
            height: 10px;
            background-color: #333;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--secondary);
            transition: width 0.5s ease-in-out;
        }
        
        /* D3 Skill Tree Container */
        #skill-tree-container {
            width: 100%;
            height: 600px;
            background-color: var(--card-bg);
            border-radius: 0.75rem;
            margin-top: 3rem;
            border: 1px solid var(--border-color);
            overflow: auto; /* Ensure tree is viewable */
        }
        
        /* D3 Node Styles */
        .node circle {
            cursor: pointer;
            fill: #555;
            stroke: var(--secondary);
            stroke-width: 3px;
            transition: all 0.3s;
        }
        .node.completed circle {
            fill: var(--secondary);
            stroke: var(--accent);
        }
        .node text {
            font-family: 'Inter', sans-serif;
            font-size: 10px;
            fill: var(--text-light);
        }
        .link {
            fill: none;
            stroke: #555;
            stroke-width: 1.5px;
            transition: stroke 0.3s;
        }
        .link.completed {
            stroke: var(--secondary);
        }

        /* --- NEW/UPDATED RESPONSIVE LAYOUT STYLES --- */
        
        /* Mobile: Default is stack (col-span-1) */
        .responsive-grid-section {
            display: grid;
            grid-template-columns: repeat(1, minmax(0, 1fr));
            gap: 2rem;
            padding: 0 1rem;
        }

        /* Tablet/Desktop: 2 columns */
        @media (min-width: 768px) {
            .responsive-grid-section {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }
        
        /* Large Desktop: 3 columns for projects/components section */
        @media (min-width: 1024px) {
            /* Applies to the main sections with component cards */
            #basics .responsive-card-grid, 
            #microcontrollers .responsive-card-grid, 
            #sensors .responsive-card-grid {
                grid-template-columns: repeat(4, minmax(0, 1fr)); /* Use Tailwind classes here to maintain consistency */
            }
            #sensors .responsive-card-grid {
                 grid-template-columns: repeat(6, minmax(0, 1fr)); /* 6 columns for dense sensor data */
            }
            #projects .responsive-card-grid {
                 grid-template-columns: repeat(3, minmax(0, 1fr)); 
            }
            
            /* Ensure Microcontrollers uses 4 columns on large screens */
            #microcontrollers .responsive-card-grid {
                 grid-template-columns: repeat(4, minmax(0, 1fr)); 
            }
        }
        
        /* Overriding existing tailwind classes for consistency */
        #basics .grid, #microcontrollers .grid, #sensors .grid, #projects .grid {
            display: grid;
            gap: 2rem;
        }

        /* Mobile Responsive Nav Menu (Auto-Hides) */
        @media (max-width: 768px) {
            .mobile-toggle {
                display: block;
                color: var(--text-light);
            }
            /* FIX: Ensure logo text shrinks on mobile for fit */
            .logo-text {
                font-size: 1.5rem; 
            }
            
            nav ul {
                display: flex; /* Kept display: flex here to enable positioning */
                flex-direction: column;
                width: 100%;
                
                /* FIX: Use fixed position for true overlay */
                position: fixed; 
                top: 65px; 
                left: 0;
                right: 0;
                min-height: calc(100vh - 65px); 
                background: rgba(18, 18, 18, 0.95); 
                backdrop-filter: blur(8px); 
                border-top: 1px solid var(--border-color);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.8);
                
                /* 1. INITIAL HIDE: Move the menu completely off-screen to the left */
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out; /* Use ease-in-out for smooth slide */
                
                overflow-y: auto; 
                z-index: 999; 
                padding-bottom: 2rem; 
            }
            /* 2. SHOW MENU: Only move the menu back into view when the 'active' class is present */
            nav ul.active {
                transform: translateX(0);
            }

            nav ul li {
                width: 100%;
                text-align: center;
                border-bottom: 1px solid var(--border-color); /* Corrected variable name */
            }
            nav ul li:last-child {
                border-bottom: none;
            }
            nav a {
                display: block;
                padding: 1rem 0;
            }
            .user-status {
                display: none;
            }
            .about-content, .contact-container {
                flex-direction: column;
                grid-template-columns: 1fr;
            }
            .hero h1 {
                font-size: 2.2rem;
            }
            
            /* FIX: Project Cards Side-by-Side on Mobile */
            #projects .projects-grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
            
            #cart-modal {
                max-width: 100%; /* Full width on mobile */
            }

            #techwhiz-fab, #cart-fab {
                right: 1rem;
                bottom: 1rem;
                width: 50px;
                height: 50px;
            }

            #cart-fab {
                bottom: 4.5rem; /* 50px + 10px gap */
            }

            #component-detail-content {
                max-width: 100%;
                padding: 1rem;
            }
            .detail-content {
                flex-direction: column;
            }
            .suggestions-sidebar {
                display: none; /* Hide sidebar on mobile for space */
            }
        }
        
        /* Project Detail Modal Fixes for visibility */
        #project-detail-modal {
            background: rgba(0, 0, 0, 0.9);
            /* FIX: Set a high Z-index to ensure it appears instantly and on top of everything */
            z-index: 9999; /* MAXIMUM Z-INDEX */
        }

        #project-detail-content {
            background: var(--card-bg);
            border: 1px solid var(--secondary);
            color: var(--text-light);
            /* Ensure it is scrollable and constrained */
            max-height: 95vh; 
            overflow-y: auto;
        }
        
        /* New Styles for Project Detail Info Tabs */
        .project-detail-tabs button {
            transition: all 0.3s ease;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            color: var(--text-mid);
        }
        .project-detail-tabs button.active {
            border-bottom-color: var(--secondary);
            color: var(--secondary);
        }
        .project-detail-tab-content {
            padding-top: 1rem;
        }

        .close-project-detail {
            color: var(--text-light);
        }
        
        .project-detail-meta {
            color: var(--secondary);
        }

        .project-detail-info {
            color: var(--text-mid);
        }
        
        /* Component Detail Modal Fixes (Targeted for high visibility) */
        .component-detail {
            /* This section is removed as it's now replaced by #component-detail-modal */
            display: none !important;
        }
        
        /* Form input color fix */
        input:not(.razorpay-payment-button), textarea {
            background-color: #333333 !important;
            border-color: #555555 !important;
            color: var(--text-light) !important;
        }

        /* Overriding tailwind classes for text visibility */
        .text-gray-700 {
            color: var(--text-mid);
        }
        .text-black {
            color: var(--text-light);
        }
        .bg-gray-800 {
            background-color: #333 !important;
        }
        .bg-gray-900 {
            background-color: #121212 !important;
        }
        
        /* KaTeX specific style override for dark mode */
        .katex {
            color: var(--secondary);
            font-size: 1.1em;
            vertical-align: middle;
        }

        /* FIX: Center all Modals */
        .modal-overlay-center {
            position: fixed;
            inset: 0;
            display: none; /* Hidden by default */
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            align-items: center; /* Center vertically */
            justify-content: center; /* Center horizontally */
            padding: 1rem;
            z-index: 1005;
            overflow-y: auto; /* Allow scrolling if content is too large */
        }
        
        /* NEW: Image scaling fix for component detail modal */
        #component-detail-content img {
            object-fit: contain; /* Ensures the whole image is visible without cropping */
            max-height: 200px; /* Optional: Constrain max height for better layout on desktop */
        }
    </style>
</head>
<body>
    <header id="main-header"> <!-- Added ID for JS scroll functionality -->
        <div class="container header-container">
            <div class="logo flex items-center">
                <img src="https://lh3.googleusercontent.com/pw/AP1GczMFGvwVU32NSsKv5V5pVdolG2i9-eEUBOupJmE6wvE5hKb08fmmPauG62OnGUmD0esm9pa-d285g6XBzAxuULCghMe8Obxi1mUTI3LcaMuGB0IJz-5-=w2400" alt="INDRA" class="w-12 h-12 rounded-full border-2 border-secondary">
                <div class="logo-text ml-4 glow-text">E-TECH <span>SOLUTIONS</span></div>
            </div>
            <div class="mobile-toggle"><i class="fas fa-bars"></i></div>
            <nav>
                <ul id="nav-menu" class="flex list-none gap-6 text-xl">
                    <li><a href="#home" class="nav-link-3d active mobile-nav-link">Home</a></li>
                    <li><a href="#about" class="nav-link-3d mobile-nav-link">About</a></li>
                    <li><a href="#basics" class="nav-link-3d mobile-nav-link">Basics</a></li>
                    <li><a href="#microcontrollers" class="nav-link-3d mobile-nav-link">Microcontrollers</a></li>
                    <li><a href="#sensors" class="nav-link-3d mobile-nav-link">Sensors</a></li>
                    <li><a href="#courses" class="nav-link-3d mobile-nav-link">Courses</a></li>
                    <li><a href="#projects" class="nav-link-3d mobile-nav-link">Projects</a></li>
                    <li><a href="https://forms.gle/ruvWdt6W2N5QmdRN6" class="nav-link-3d mobile-nav-link">Contact</a></li>
                    <li id="user-nav">
                        <a href="#" id="login-btn-nav" class="nav-link-3d">Login</a>
                        <!-- UPDATED: Added click event to user avatar for profile modal -->
                        <div class="user-status flex items-center hidden" id="user-status">
                            <div id="user-avatar" class="user-avatar w-10 h-10 rounded-lg bg-secondary text-white flex items-center justify-center font-bold cursor-pointer hover:ring-2 ring-accent transition-all"></div>
                            <span id="user-name" class="ml-2"></span>
                            <a href="#" id="logout-btn" class="ml-4 nav-link-3d">Logout</a>
                            <a href="#" id="order-history-btn" class="ml-4 nav-link-3d">Orders</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="hero" id="home">
        <div class="container">
            <h1>Electronics & Computer Science Projects</h1>
            <p class="mt-4 text-lg text-gray-400 relative z-20">Master electronics and computer science by building real-world projects with our comprehensive learning resources.</p>
            <div class="hero-btns mt-10 relative z-20">
                <a href="#projects" class="btn btn-3d bg-secondary hover:bg-accent text-white font-bold py-3 px-6 rounded-lg transition-all">Explore Projects</a>
                <a href="#courses" class="btn btn-3d border-2 border-secondary text-secondary hover:text-white hover:bg-secondary font-bold py-3 px-6 rounded-lg transition-all ml-4">View Courses</a>
                <a href="https://forms.gle/fgiNbFHnNMYH2QqW8" class="btn btn-3d btn-primary-action btn-box text-white font-bold transition-all ml-4">
                    <i class="fas fa-shopping-cart"></i> Buy Kits
                </a>
            </div>
        </div>
    </section>

    <section class="section" id="about">
        <div class="container">
            <div class="section-title text-center">
                <h2>About Me</h2>
            </div>
            <!-- Using responsive-grid-section for dual column layout on desktop/tablet -->
            <div class="about-content responsive-grid-section items-center justify-center card-3d glassmorphism p-8 neon-border">
                <div class="profile-img transform hover:rotate-3 transition-transform duration-500">
                    <img src="https://lh3.googleusercontent.com/pw/AP1GczMFGvwVU32NSsKv5V5pVdolG2i9-eEUBOupJmE6wvE5hKb08fmmPauG62OnGUmD0esm9pa-d285g6XBzAxuULCghMe8Obxi1mUTI3LcaMuGB0IJz-5-=w2400" alt="INDRA" class="rounded-xl shadow-xl transition-all duration-500 hover:shadow-2xl hover:scale-105 border-4 border-secondary/50">
                </div>
                <div class="profile-info text-center md:text-left">
                    <h3 class="text-3xl font-bold font-orbitron text-white">Hi, I'm INDRA</h3>
                    <p class="mt-4 text-lg text-gray-400">I'm an electronics engineer and educator with over 3 years of experience in the field. My passion is to make electronics and computer science education accessible to everyone, regardless of their background or experience level.</p>
                    <div class="qualifications mt-6">
                        <h4 class="text-xl font-orbitron font-bold text-secondary">Qualifications</h4>
                        <ul class="list-none mt-2 text-gray-400">
                            <li class="flex items-center mt-2"><i class="fas fa-graduation-cap mr-2 text-secondary"></i> DIPLOMA in Electronics And Communication Engineering</li>
                            <li class="flex items-center mt-2"><i class="fas fa-certificate mr-2 text-secondary"></i> Certified IoT Specialist</li>
                            <li class="flex items-center mt-2"><i class="fas fa-briefcase mr-2 text-secondary"></i> 2+ years of industry experience</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="basics">
        <div class="container">
            <div class="section-title text-center">
                <h2>Electronic Basics</h2>
                <p class="text-gray-400">Learn the fundamental components that form the building blocks of all electronic devices</p>
            </div>
            <!-- Skill Tree Visualization Container -->
           
            <!-- End Skill Tree Visualization Container -->

            <!-- UPDATED: Added responsive-card-grid class for fine-grained mobile control -->
            <div class="responsive-card-grid grid grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-8 mt-12">
                <!-- Component Cards (Click to show details instantly in modal) -->
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="resistor" data-concept-id="resistor-basics">
                    <div class="component-icon"><i class="fas fa-bolt"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Resistor</h4>
                    <p class="text-sm mt-2 text-gray-400">Limit and control the flow of electric current</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="capacitor" data-concept-id="capacitor-basics">
                    <div class="component-icon"><i class="fas fa-battery-half"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Capacitor</h4>
                    <p class="text-sm mt-2 text-gray-400">Store and release electrical energy</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="inductor" data-concept-id="inductor-basics">
                    <div class="component-icon"><i class="fas fa-magnet"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Inductor</h4>
                    <p class="text-sm mt-2 text-gray-400">Store energy in a magnetic field</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="diode" data-concept-id="diode-basics">
                    <div class="component-icon"><i class="fas fa-arrow-right"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Diode</h4>
                    <p class="text-sm mt-2 text-gray-400">Allow current to flow in one direction</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="transistor" data-concept-id="transistor-basics">
                    <div class="component-icon"><i class="fas fa-microchip"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Transistor</h4>
                    <p class="text-sm mt-2 text-gray-400">Act as electronic switches or amplifiers</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="ic" data-concept-id="ic-basics">
                    <div class="component-icon"><i class="fas fa-braille"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Integrated Circuit (IC)</h4>
                    <p class="text-sm mt-2 text-gray-400">Miniaturized circuits on a single chip</p>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="microcontrollers">
        <div class="container">
            <div class="section-title text-center">
                <h2>Microcontrollers</h2>
                <p class="text-gray-400">Explore popular microcontroller platforms for embedded systems development</p>
            </div>
            <!-- UPDATED: Added responsive-card-grid class, using 2 columns on mobile, 4 on desktop -->
            <div class="responsive-card-grid grid grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-8">
                <!-- Microcontroller Cards (Click to show details instantly in modal) -->
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="arduino-uno" data-concept-id="mcu-arduino-uno">
                    <div class="component-icon"><i class="fas fa-bolt"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Arduino Uno</h4>
                    <p class="text-sm mt-2 text-gray-400">The most popular Arduino board for beginners</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="arduino-nano" data-concept-id="mcu-arduino-nano">
                    <div class="component-icon"><i class="fas fa-microchip"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Arduino Nano</h4>
                    <p class="text-sm mt-2 text-gray-400">A compact and breadboard-friendly version</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="arduino-mega" data-concept-id="mcu-arduino-mega">
                    <div class="component-icon"><i class="fas fa-list-ol"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Arduino Mega</h4>
                    <p class="text-sm mt-2 text-gray-400">Ideal for complex projects with many I/O pins</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="esp32" data-concept-id="mcu-esp32">
                    <div class="component-icon"><i class="fas fa-wifi"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">ESP32</h4>
                    <p class="text-sm mt-2 text-gray-400">Wi-Fi and Bluetooth enabled MCU</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="raspberrypi" data-concept-id="mcu-rpi-pico">
                    <div class="component-icon"><i class="fas fa-computer"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Raspberry Pi Pico</h4>
                    <p class="text-sm mt-2 text-gray-400">Powerful, low-cost MCU</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="stm32" data-concept-id="mcu-stm32">
                    <div class="component-icon"><i class="fas fa-microchip"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">STM32</h4>
                    <p class="text-sm mt-2 text-gray-400">High-performance ARM-based MCUs</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="avr" data-concept-id="mcu-avr">
                    <div class="component-icon"><i class="fas fa-desktop"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">AVR</h4>
                    <p class="text-sm mt-2 text-gray-400">Used in many hobbyist projects</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg cursor-pointer" data-component="pic" data-concept-id="mcu-pic">
                    <div class="component-icon"><i class="fas fa-gear"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">PIC</h4>
                    <p class="text-sm mt-2 text-gray-400">Simple and reliable MCUs</p>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="sensors">
        <div class="container">
            <div class="section-title text-center">
                <h2>Sensors</h2>
                <p class="text-gray-400">Discover various sensors that enable interaction between the physical and digital worlds</p>
            </div>
            <!-- UPDATED: Added responsive-card-grid class, using 3 columns on mobile, 6 on desktop -->
            <div class="responsive-card-grid grid grid-cols-3 lg:grid-cols-6 xl:grid-cols-6 gap-8">
                <!-- Sensor Cards (Click to show details instantly in modal) -->
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="ultrasonic" data-concept-id="sensor-ultrasonic">
                    <div class="component-icon"><i class="fas fa-wave-square"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Ultrasonic</h4>
                    <p class="text-sm mt-2 text-gray-400">Distance measurement using sound waves</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="pir" data-concept-id="sensor-pir">
                    <div class="component-icon"><i class="fas fa-running"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">PIR Motion</h4>
                    <p class="text-sm mt-2 text-gray-400">Detect human movement in an area</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="temperature" data-concept-id="sensor-temperature">
                    <div class="component-icon"><i class="fas fa-thermometer-half"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Temperature</h4>
                    <p class="text-sm mt-2 text-gray-400">Measure ambient temperature</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="humidity" data-concept-id="sensor-humidity">
                    <div class="component-icon"><i class="fas fa-tint"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Humidity</h4>
                    <p class="text-sm mt-2 text-gray-400">Measure moisture in the air</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="light" data-concept-id="sensor-ldr">
                    <div class="component-icon"><i class="fas fa-lightbulb"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Light (LDR)</h4>
                    <p class="text-sm mt-2 text-gray-400">Measure light intensity</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="gas" data-concept-id="sensor-gas">
                    <div class="component-icon"><i class="fas fa-cloud"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Gas (MQ series)</h4>
                    <p class="text-sm mt-2 text-gray-400">Detect specific gases</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="soilmoisture" data-concept-id="sensor-soil">
                    <div class="component-icon"><i class="fas fa-seedling"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Soil Moisture</h4>
                    <p class="text-sm mt-2 text-gray-400">Check moisture levels in soil</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="rfid" data-concept-id="sensor-rfid">
                    <div class="component-icon"><i class="fas fa-id-card"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">RFID</h4>
                    <p class="text-sm mt-2 text-gray-400">Radio frequency identification technology</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="accelerometer" data-concept-id="sensor-accelerometer">
                    <div class="component-icon"><i class="fas fa-arrows-up-down-left-right"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Accelerometer</h4>
                    <p class="text-sm mt-2 text-gray-400">Measure acceleration and tilt</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="sound" data-concept-id="sensor-sound">
                    <div class="component-icon"><i class="fas fa-volume-up"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Sound</h4>
                    <p class="text-sm mt-2 text-gray-400">Detect and measure sound levels</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="heartbeat" data-concept-id="sensor-heartbeat">
                    <div class="component-icon"><i class="fas fa-heartbeat"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Heartbeat</h4>
                    <p class="text-sm mt-2 text-gray-400">Monitor heart rate and pulse</p>
                </div>
                <div class="component-card card-3d glassmorphism p-6 text-center rounded-lg neon-border cursor-pointer" data-component="gesture" data-concept-id="sensor-gesture">
                    <div class="component-icon"><i class="fas fa-hand-rock"></i></div>
                    <h4 class="font-orbitron text-xl font-bold text-white">Gesture</h4>
                    <p class="text-sm mt-2 text-gray-400">Detect and interpret hand movements</p>
                </div>
            </div>
        </div>
    </section>
    
    <section class="section" id="courses">
        <div class="container">
            <div class="section-title text-center">
                <h2>Our Premium Courses</h2>
                <p class="text-gray-400">Unlock in-depth knowledge and advanced project building with our specialized courses.</p>
            </div>
            <!-- UPDATED: Added responsive-card-grid class, using 1 column on mobile, 3 on desktop -->
            <div class="responsive-card-grid grid grid-cols-1 lg:grid-cols-3 xl:grid-cols-3 gap-8">
                <div class="course-card card-3d glassmorphism p-6 rounded-xl overflow-hidden neon-border">
                    <img src="https://lh3.googleusercontent.com/pw/AP1GczPvtSebwcEAoTS8k-OCNn_xZnUKH5rZXKAI4jLois7jfNsvPT14A1m11ZxNc1OFk6QXgYjp9lHolvmOWD8YnrbuP2acdqCFe_XIolbmvWSOd38hTmc=w2400" alt="Arduino Master" class="rounded-md w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
                    <div class="mt-4">
                        <h3 class="font-orbitron text-2xl font-bold text-white">Arduino Master Class</h3>
                        <p class="text-gray-400 mt-2">Become a master of Arduino programming and hardware. This course covers advanced topics, complex projects, and troubleshooting techniques.</p>
                        <div class="text-2xl font-bold font-orbitron text-accent mt-4">₹ _ _9</div>
                        <a href="https://etechcourse11.netlify.app/" class="btn btn-3d btn-secondary-action disabled py-2 px-4 mt-4 rounded-lg inline-block">AVAILABLE SOON</a>
                    </div>
                </div>
                <div class="course-card card-3d glassmorphism p-6 rounded-xl overflow-hidden neon-border">
                    <img src="https://images.unsplash.com/photo-1517336714731-489689fd1ca8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="AI for Robotics" class="rounded-md w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
                    <div class="mt-4">
                        <h3 class="font-orbitron text-2xl font-bold text-white">AI for Robotics</h3>
                        <p class="text-gray-400 mt-2">Dive into the world of Artificial Intelligence applied to robotics. Learn machine learning fundamentals, computer vision, and robot navigation.</p>
                        <div class="text-2xl font-bold font-orbitron text-accent mt-4">₹ _ _9</div>
                        <a href="https://etechcourse11.netlify.app/" class="btn btn-3d btn-secondary-action disabled py-2 px-4 mt-4 rounded-lg inline-block">AVAILABLE SOON</a>
                    </div>
                </div>
                <div class="course-card card-3d glassmorphism p-6 rounded-xl overflow-hidden neon-border">
                    <img src="https://images.unsplash.com/photo-1550751827-4bd374c3f58b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="IoT Course" class="rounded-md w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
                    <div class="mt-4">
                        <h3 class="font-orbitron text-2xl font-bold text-white">Advanced IoT Development</h3>
                        <p class="text-gray-400 mt-2">Master the Internet of Things with advanced development techniques, cloud integration, data analytics, and security best practices.</p>
                        <div class="text-2xl font-bold font-orbitron text-accent mt-4">₹ _ _9</div>
                        <a href="https://etechcourse11.netlify.app/" class="btn btn-3d btn-secondary-action disabled py-2 px-4 mt-4 rounded-lg inline-block">AVAILABLE SOON</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section" id="projects">
        <div class="container">
            <div class="section-title text-center">
                <h2>Electronics & CSE Projects</h2>
                <p class="text-gray-400">Browse our collection of IoT, Arduino, and Computer Science projects with complete guides and code.</p>
            </div>
            <!-- RECTIFIED: Filter buttons unified to rely solely on JavaScript for active styling -->
            <div class="project-filters flex justify-center flex-wrap gap-4 mb-8">
                <button class="filter-btn btn btn-3d bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-secondary" data-filter="all">All</button>
                <button class="filter-btn btn btn-3d bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-secondary" data-filter="iot">IoT</button>
                <button class="filter-btn btn btn-3d bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-secondary" data-filter="arduino">Arduino</button>
                <button class="filter-btn btn btn-3d bg-gray-800 text-white py-2 px-4 rounded-lg hover:bg-secondary" data-filter="cse">Computer Science</button>
            </div>
            <!-- UPDATED: Changed grid-cols-1 to grid-cols-2 for side-by-side mobile project cards -->
            <div class="projects-grid responsive-card-grid grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-8" id="projects-grid">
                <!-- Projects will be dynamically rendered here -->
            </div>
        </div>
    </section>
    
    <section class="section" id="contact">
        <div class="container">
            <div class="section-title text-center">
                <h2>Contact Me</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="contact-info flex flex-col gap-6">
                    <div class="contact-card card-3d glassmorphism p-6 rounded-xl neon-border flex items-center gap-4">
                        <div class="contact-icon w-14 h-14 rounded-lg bg-secondary flex items-center justify-center text-xl text-white"><i class="fas fa-map-marker-alt"></i></div>
                        <div class="contact-text">
                            <h4 class="font-orbitron text-lg font-bold text-white">Location</h4>
                            <p class="text-gray-400">Sri Sathya Sai, India</p>
                        </div>
                    </div>
                    <div class="contact-card card-3d glassmorphism p-6 rounded-xl neon-border flex items-center gap-4">
                        <div class="contact-icon w-14 h-14 rounded-lg bg-secondary flex items-center justify-center text-xl text-white"><i class="fas fa-phone"></i></div>
                        <div class="contact-text">
                            <h4 class="font-orbitron text-lg font-bold text-white">Phone</h4>
                            <p class="text-gray-400">+91 9392090575, +91 9618646604, +91 7619457762</p>
                        </div>
                    </div>
                    <div class="contact-card card-3d glassmorphism p-6 rounded-xl neon-border flex items-center gap-4">
                        <div class="contact-icon w-14 h-14 rounded-lg bg-secondary flex items-center justify-center text-xl text-white"><i class="fas fa-envelope"></i></div>
                        <div class="contact-text">
                            <h4 class="font-orbitron text-lg font-bold text-white">Email</h4>
                            <p class="text-gray-400">etechsolutions9392@gmail.com</p>
                        </div>
                    </div>
                    <div class="contact-card card-3d glassmorphism p-6 rounded-xl neon-border flex items-center gap-4">
                        <div class="contact-icon w-14 h-14 rounded-lg bg-secondary flex items-center justify-center text-xl text-white"><i class="fas fa-globe"></i></div>
                        <div class="contact-text">
                            <h4 class="font-orbitron text-lg font-bold text-white">Website</h4>
                            <p class="text-gray-400">etechsolutions.co.in</p>
                        </div>
                    </div>
                </div>
                <form id="contactForm" class="contact-form glassmorphism p-8 rounded-xl neon-border flex flex-col gap-4">
                    <div class="form-group">
                        <label for="name" class="block mb-2 font-bold text-gray-400">Your Name</label>
                        <input type="text" id="name" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:outline-none focus:border-secondary transition-colors text-white">
                    </div>
                    <div class="form-group">
                        <label for="email" class="block mb-2 font-bold text-gray-400">Email Address</label>
                        <input type="email" id="email" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-4 focus:outline-none focus:border-secondary" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <label for="subject" class="block mb-2 font-bold text-gray-400">Subject</label>
                        <input type="text" id="subject" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-secondary transition-colors">
                    </div>
                    <div class="form-group">
                        <label for="message" class="block mb-2 font-bold text-gray-400">Message</label>
                        <textarea id="message" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:outline-none focus:border-secondary transition-colors text-white"></textarea>
                    </div>
                    <button type="submit" class="btn btn-3d btn-primary-action btn-box w-full mt-4">Send Message</button>
                </form>
            </div>
        </div>
    </section>

    <footer class="bg-card-bg p-8 border-t border-border-color">
        <div class="container">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="footer-col">
                    <h4 class="font-orbitron text-xl font-bold text-white">E-TECH SOLUTIONS</h4>
                    <p class="text-sm mt-4 text-gray-400">Providing high-quality e-learning resources for electronics enthusiasts and students worldwide.</p>
                    <div class="social-links flex gap-4 mt-4">
                        <a href="https://www.facebook.com/share/1YqHbBfq8W/" class="w-10 h-10 rounded-lg bg-border-color text-gray-400 flex items-center justify-center hover:bg-secondary hover:text-white transition-colors"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.instagram.com/e_techsolutions_?igsh=am0wa3ZoY2c5ZDE=" class="w-10 h-10 rounded-lg bg-border-color text-gray-400 flex items-center justify-center hover:bg-accent hover:text-white transition-colors"><i class="fab fab fa-instagram"></i></a>
                        <a href="https://youtube.com/@e-techsolutions-techwhiz?si=rWXLsO87Y93k34dF" class="w-10 h-10 rounded-lg bg-border-color text-gray-400 flex items-center justify-center hover:bg-red-600 hover:text-white transition-colors"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-col">
                    <h4 class="font-orbitron text-lg font-bold text-white">Learning Resources</h4>
                    <ul class="list-none mt-4 text-gray-400">
                        <li><a href="#basics" class="hover:text-secondary transition-colors">Electronics Basics</a></li>
                        <li><a href="#microcontrollers" class="hover:text-secondary transition-colors">Microcontrollers</a></li>
                        <li><a href="#sensors" class="hover:text-secondary transition-colors">Sensors</a></li>
                        <li><a href="#courses" class="hover:text-secondary transition-colors">Courses</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="font-orbitron text-lg font-bold text-white">Quick Links</h4>
                    <ul class="list-none mt-4 text-gray-400">
                        <li><a href="#home" class="hover:text-secondary transition-colors">Home</a></li>
                        <li><a href="#about" class="hover:text-secondary transition-colors">About</a></li>
                        <li><a href="#projects" class="hover:text-secondary transition-colors">Projects</a></li>
                        <li><a href="https://forms.gle/ruvWdt6W2N5QmdRN6" class="hover:text-secondary transition-colors">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="font-orbitron text-lg font-bold text-white">Newsletter</h4>
                    <p class="text-sm mt-4 text-gray-400">Subscribe for the latest tutorials and project ideas.</p>
                    <form>
                        <input type="email" placeholder="Your Email Address" required class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 focus:outline-none focus:border-secondary transition-colors mt-4 text-white">
                        <a href="https://forms.gle/ruvWdt6W2N5QmdRN6"><button type="submit" class="btn btn-3d btn-primary-action btn-box w-full mt-4">Subscribe</button></a>
                    </form>
                </div>
            </div>
            <div class="text-center mt-8 text-gray-500 text-sm border-t border-border-color pt-6">
                &copy; 2025 E-TECH SOLUTIONS. All Rights Reserved.
            </div>
        </div>
    </footer>

   
    <!-- Chatbot Button (Z-index 1001, bottom: 2rem) -->
    <button id="techwhiz-fab" class="btn btn-3d fixed w-16 h-16 flex items-center justify-center text-3xl text-white focus:outline-none focus:ring-4 focus:ring-secondary/50" style="background: linear-gradient(145deg, var(--secondary), var(--accent));">
        <i class="fas fa-robot"></i>
    </button>
    
    <!-- Floating Cart Button (Z-index 1002, bottom: 6rem, above TechWhiz) -->
    <button id="cart-fab" class="fixed text-xl text-white focus:outline-none">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count">0</span>
    </button>
    
    <!-- Cart Modal (Advanced Floating Panel) -->
    <div id="cart-modal">
        <div class="cart-header">
            <h3 class="text-white">Your Cart (<span id="cart-item-count-header">0</span>)</h3>
            <button id="close-cart-btn" class="text-white hover:text-accent">&times;</button>
        </div>
        <div id="cart-modal-items" class="bg-card-bg">
            <p class="cart-empty-msg text-gray-400 text-center p-8">Your cart is currently empty. Start exploring projects!</p>
        </div>
        <div class="cart-footer bg-card-bg">
            <div class="cart-total-display">
                <span class="text-white">Total:</span>
                <span id="cart-total-price">₹0</span>
            </div>
            <button id="cart-checkout-btn" class="btn btn-3d btn-primary-action btn-box w-full">Proceed to Checkout</button>
        </div>
    </div>
    
    <!-- Component Detail MODAL (Overlay component details here) -->
    <div id="component-detail-modal">
        <div id="component-detail-content" class="glassmorphism p-8 rounded-xl relative">
            <div class="detail-header flex justify-between items-center">
                <h3 class="font-orbitron text-2xl font-bold text-secondary" id="detail-title">Component Details</h3>
                <button class="close-detail absolute top-4 right-4 text-4xl text-gray-400 hover:text-accent transition-colors">&times;</button>
            </div>
            <div class="detail-content flex flex-col md:flex-row gap-8 mt-6">
                <!-- IMPORTANT: Removed object-cover and set max-height to 200px in CSS class above for object-fit: contain -->
                <img id="detail-img" src="https://via.placeholder.com/400x300" alt="Component" class="rounded-lg shadow-lg w-full md:w-1/3 object-cover border-2 border-secondary/50">
                <div class="detail-info flex-1">
                    <h4 class="font-bold text-lg text-secondary">Definition</h4>
                    <p id="detail-definition" class="text-gray-400"></p>
                    <h4 class="font-bold text-lg text-secondary mt-4">Symbol</h4>
                    <div id="detail-symbol" class="text-gray-400 p-2 border border-border-color rounded-lg mt-1"></div>
                    <!-- NEW: Sensor Visualization Container (only visible for sensor types) -->
                    <div id="sensor-visualization-area" class="mt-4 hidden">
                         <h4 class="font-bold text-lg text-accent">Live Data Mock-up</h4>
                         <canvas id="sensor-viz-canvas"></canvas>
                         <p id="sensor-data-readout" class="text-sm text-gray-500 mt-1 italic">Status: Idle</p>
                    </div>
                    <!-- END: Sensor Visualization Container -->
                    <h4 class="font-bold text-lg text-secondary mt-4">Characteristics</h4>
                    <ul id="detail-characteristics" class="list-disc ml-6 text-gray-400"></ul>
                    <h4 class="font-bold text-lg text-secondary mt-4">Applications</h4>
                    <p id="detail-applications" class="text-gray-400"></p>
                </div>
            </div>
            <div class="mt-8">
                <button id="ask-techwhiz-component-btn" class="btn btn-3d btn-secondary-action btn-box w-full">
                    <i class="fas fa-robot mr-2"></i> Ask TechWhiz About This Component
                </button>
            </div>
        </div>
    </div>
    <!-- END: Component Detail MODAL -->
    
    <!-- Chatbox Modal -->
    <div id="techwhiz-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-4 z-50">
        <div id="assistant-chat-modal-content" class="rounded-lg shadow-2xl max-w-lg w-full bg-gray-900 border border-secondary/20">
            <div class="sticky top-0 bg-gray-800 p-4 border-b border-gray-700 flex justify-between items-center rounded-t-lg">
                <h3 class="text-xl font-bold text-white"><i class="fas fa-robot mr-3 text-secondary"></i>TECHWHIZ Assistant</h3>
                <button id="close-techwhiz-modal" class="text-gray-400 hover:text-white text-4xl leading-none">&times;</button>
            </div>
            <div id="chat-history" class="p-4 overflow-y-auto h-[400px] flex flex-col-reverse gap-3">
                <div class="chat-message assistant p-3 rounded-lg rounded-bl-none self-start mr-auto bg-gray-800 text-white" style="font-size:15px; font-weight:normal; padding:10px; border-radius:10px; margin-right:auto;">Hello! How can I help you today with electronics and CSE concepts?</div>
            </div>
            <div class="p-4 border-t border-gray-700 bg-gray-900">
                <div class="flex items-center space-x-2">
                    <input type="text" id="techwhiz-input" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-secondary transition-colors" placeholder="Ask me anything...">
                    <button id="mic-btn" class="btn btn-3d bg-secondary hover:bg-accent text-white py-3 px-4 rounded-lg"><i class="fas fa-microphone"></i></button>
                    <button id="send-btn" class="btn btn-3d bg-secondary hover:bg-accent text-white py-3 px-4 rounded-lg"><i class="fas fa-paper-plane"></i></button>
                </div>
                <div class="flex justify-between items-center mt-3">
                    <button id="stop-speech-btn" class="btn bg-accent hover:bg-red-700 py-2 px-4 rounded-lg text-sm">
                        <i class="fas fa-volume-mute mr-2"></i>Stop Voice Output
                    </button>
                    <span id="listening-status" class="text-sm text-gray-500 italic hidden">Listening...</span>
                    <span id="thinking-status" class="text-sm text-secondary italic hidden">Thinking...</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <!-- UPDATED: Added modal-overlay-center class -->
    <div id="auth-modal" class="modal-overlay-center">
        <!-- LOGIN MODAL CONTAINER - Centered via items-center and justify-center -->
        <div class="bg-gray-900 rounded-lg shadow-2xl p-8 max-w-md w-full border border-secondary/20">
            <div class="flex justify-end"><button class="close-auth text-3xl text-gray-400 hover:text-white">&times;</button></div>
            <div class="auth-tabs flex justify-around mb-6 border-b border-gray-700">
                <div class="auth-tab text-xl font-bold py-2 px-4 cursor-pointer text-secondary active" data-tab="login">Login</div>
                <div class="auth-tab text-xl font-bold py-2 px-4 cursor-pointer text-gray-400" data-tab="register">Register</div>
            </div>
            <!-- Login Form -->
            <form id="login-form" class="auth-form">
                <input type="email" id="login-email" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-4 focus:outline-none focus:border-secondary" placeholder="Email" required>
                <input type="password" id="login-password" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-6 focus:outline-none focus:border-secondary" placeholder="Password" required>
                <button type="submit" class="btn btn-3d btn-primary-action btn-box w-full">Login</button>
            </form>
            
            <!-- Register Form -->
            <form id="register-form" class="auth-form hidden">
                <input type="text" id="register-name" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-4 focus:outline-none focus:border-secondary" placeholder="Full Name" required>
                <input type="email" id="register-email" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-4 focus:outline-none focus:border-secondary" placeholder="Email" required>
                <input type="password" id="register-password" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white mb-6 focus:outline-none focus:border-secondary" placeholder="Password" required>
                <button type="submit" class="btn btn-3d btn-primary-action btn-box w-full">Register</button>
            </form>

            <!-- Social Login Options -->
            <div class="mt-6">
                <div class="text-center text-gray-500 mb-4">OR</div>
                <button id="google-login-btn" class="btn btn-3d w-full py-3 rounded-lg bg-white text-black font-bold flex items-center justify-center hover:bg-gray-200 transition-colors">
                    <i class="fab fa-google mr-3"></i> Sign in with Google
                </button>
                <!-- NOTE: Instagram/Facebook login requires complex server-side authentication (OAuth). 
                     We'll use a placeholder button for visual continuity, recommending the use of Google. -->
                <button disabled class="btn btn-3d w-full py-3 rounded-lg bg-blue-600 text-white font-bold flex items-center justify-center mt-3 cursor-not-allowed opacity-50">
                    <i class="fab fab fa-instagram mr-3"></i> Sign in with Instagram (Unavailable)
                </button>
            </div>
        </div>
    </div>

    <!-- Order History Modal -->
    <!-- UPDATED: Added modal-overlay-center class -->
    <div id="order-history-modal" class="modal-overlay-center">
        <div class="bg-gray-900 rounded-lg shadow-2xl p-8 max-w-lg w-full border border-secondary/20">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold font-orbitron text-secondary">Your Order History</h2>
                <button class="close-history text-3xl text-gray-400 hover:text-white">&times;</button>
            </div>
            <div id="order-history-list" class="mt-6 h-[400px] overflow-y-auto">
                <p class="text-center text-gray-500">You have no past orders.</p>
            </div>
        </div>
    </div>
    
    <!-- NEW: Profile Management Modal -->
    <!-- UPDATED: Added modal-overlay-center class -->
    <div id="profile-modal" class="modal-overlay-center">
        <div class="bg-gray-900 rounded-lg shadow-2xl p-8 max-w-xl w-full border border-accent/20">
            <div class="flex justify-between items-center">
                <h2 class="text-2xl font-bold font-orbitron text-accent"><i class="fas fa-user-cog mr-2"></i> User Profile & Settings</h2>
                <button id="close-profile-btn" class="text-3xl text-gray-400 hover:text-white">&times;</button>
            </div>
            
            <div class="mt-6 grid grid-cols-1 gap-6"> <!-- CHANGED: Removed unnecessary md:grid-cols-2 -->
                <!-- User Info -->
                <div class="glassmorphism p-4 rounded-lg border border-border-color">
                    <h3 class="text-xl font-bold text-secondary mb-3">Account Details</h3>
                    <p class="text-gray-400"><strong>Display Name:</strong> <span id="profile-display-name" class="text-white"></span></p>
                    <p class="text-gray-400"><strong>Email:</strong> <span id="profile-email" class="text-white"></span></p>
                    <p class="text-gray-400"><strong>User ID:</strong> <span id="profile-user-id" class="text-xs text-accent break-all"></span></p>
                    <button id="edit-profile-btn" class="btn btn-3d btn-secondary-action py-2 px-4 mt-4 w-full">Edit Name</button>
                </div>
                
            </div> <!-- CHANGED: Removed Project List Section here -->
            
            <div class="mt-6 border-t border-border-color pt-6 text-center">
                 <button id="profile-logout-btn" class="btn btn-3d bg-red-600 hover:bg-red-700 text-white py-2 px-6 rounded-lg">Sign Out</button>
            </div>
        </div>
    </div>
    <!-- END: Profile Management Modal -->


    <!-- Project Detail Modal (FIXED: Ensuring immediate display on click) -->
    <!-- NOTE: #project-detail-modal Z-index is 9999 for maximum priority -->
    <div id="project-detail-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center p-4" style="z-index: 9999;">
        <div id="project-detail-content" class="glassmorphism p-8 rounded-xl max-w-3xl w-full relative">
            <button class="close-project-detail absolute top-4 right-4 text-4xl text-white hover:text-secondary">&times;</button>
            <div class="text-xl font-orbitron font-bold text-secondary mb-3">E-TECH SOLUTIONS Project Details</div>
            
            <!-- Project Image & Quick Info -->
            <div class="flex flex-col md:flex-row gap-6">
                <img id="project-detail-image" src="" alt="Project Image" class="rounded-lg w-full md:w-1/3 h-48 object-cover border-2 border-secondary/50">
                <div class="flex-1">
                    <h3 class="text-3xl font-orbitron font-bold text-white" id="project-detail-title"></h3>
                    <div class="project-detail-meta flex flex-wrap gap-4 text-sm mt-2">
                        <span id="project-detail-time" class="text-white"><i class="fas fa-clock text-secondary"></i></span>
                        <span id="project-detail-chip" class="text-white"><i class="fas fa-microchip text-secondary"></i></span>
                        <span id="project-detail-theme" class="text-white"><i class="fas fa-lightbulb text-secondary"></i> Theme: <span id="theme-value">N/A</span></span>
                    </div>
                    <p class="mt-4 text-gray-400" id="project-detail-description"></p>
                </div>
            </div>
            
            <!-- NEW: Tabbed Content for Detailed Information -->
            <div class="mt-6">
                 <div class="project-detail-tabs flex border-b border-border-color gap-4 overflow-x-auto">
                    <button class="py-2 px-1 text-base active" data-tab-target="#tab-details">Details & Aim</button>
                    <button class="py-2 px-1 text-base" data-tab-target="#tab-features">Features & Uses</button>
                    <button class="py-2 px-1 text-base" data-tab-target="#tab-requirements">Requirements</button>
                    <button id="ask-techwhiz-detail-btn-tab" class="py-2 px-1 text-base text-accent hover:text-secondary" data-tab-target="#tab-techwhiz">Ask TechWhiz</button>
                 </div>
                 
                 <div id="project-detail-tab-wrapper" class="project-detail-tab-content">
                    <!-- Tab 1: Details & Aim -->
                    <div id="tab-details" data-tab-content class="active">
                        <h4 class="text-xl font-bold text-secondary mt-4">Project Aim</h4>
                        <p id="project-detail-aim" class="text-gray-400 mt-2 italic"></p>
                        
                        <h4 class="text-xl font-bold text-secondary mt-4">Applications & Uses</h4>
                        <ul class="list-disc ml-6 mt-2 text-gray-400" id="project-detail-applications"><li>N/A</li></ul>
                        
                        <h4 class="text-xl font-bold text-secondary mt-4">E-TECH Advantages</h4>
                        <ul class="list-disc ml-6 mt-2 text-gray-400" id="project-detail-advantages"><li>N/A</li></ul>
                        
                        <!-- NEW: Sensor View Section (Hidden if no relevant sensors) -->
                        <div id="project-sensor-view" class="mt-6 p-4 rounded-lg glassmorphism hidden">
                            <h4 class="text-xl font-bold text-accent"><i class="fas fa-satellite-dish mr-2"></i> Sensor View (Data Flow)</h4>
                            <ul class="flex flex-wrap gap-3 mt-3" id="project-detail-sensors-used"></ul>
                        </div>
                    </div>
                    
                    <!-- Tab 2: Key Features -->
                    <div id="tab-features" data-tab-content class="hidden">
                        <h4 class="text-xl font-bold text-secondary mt-4">Key Features</h4>
                        <ul class="list-disc ml-6 mt-2 text-gray-400" id="project-detail-features"><li>N/A</li></ul>
                    </div>
                    
                    <!-- Tab 3: Requirements -->
                    <div id="tab-requirements" data-tab-content class="hidden">
                         <h4 class="text-xl font-bold text-secondary mt-4">Required Components</h4>
                        <ul class="list-disc ml-6 mt-2 text-gray-400" id="project-detail-components"><li>N/A</li></ul>
                    </div>
                    
                    <!-- Tab 4: AI Summary / TechWhiz Interaction -->
                    <div id="tab-techwhiz" data-tab-content class="hidden">
                        <h4 class="text-xl font-bold text-secondary mt-4">AI-Powered Overview</h4>
                        <button id="ai-summary-btn" class="btn btn-3d bg-accent text-white py-2 px-4 rounded-lg mt-2 w-full">AI-Powered Summary ✨</button>
                        <div id="ai-summary-container" class="glassmorphism p-4 mt-4 rounded-lg border border-accent/50">
                            <p id="ai-summary-text" class="text-sm italic text-gray-400">Click the button above for an intelligent summary...</p>
                        </div>
                        
                        <h4 class="text-xl font-bold text-secondary mt-6">Expert Q&A</h4>
                        <button id="ask-techwhiz-detail-btn" class="btn btn-3d btn-secondary-action btn-box w-full mt-2">
                             <i class="fas fa-robot mr-2"></i> Ask TechWhiz About This Project
                        </button>
                    </div>
                 </div>
            </div>

                <!-- Action Buttons: Buy Now and Add to Cart -->
                <div class="mt-8 flex gap-4 justify-between">
                    <a id="buy-now-from-detail" target="_blank" class="btn btn-3d btn-buy-now btn-box flex-1 text-lg">
                        <i class="fas fa-bolt mr-2"></i> Buy Kit Now
                    </a>
                    <button id="add-to-cart-from-detail" class="btn btn-3d btn-primary-action btn-box flex-1 text-lg">
                        <i class="fas fa-cart-plus mr-2"></i> Add to Cart
                    </button>
                </div>
                
                <button id="simulator-placeholder-btn" class="btn btn-3d bg-purple-700 hover:bg-purple-800 text-white py-2 px-4 rounded-lg mt-4 w-full">
                    <i class="fas fa-microchip mr-2"></i> Embedded Circuit Simulator (Coming Soon)
                </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Firebase Config & Setup ---
            const __app_id = "default-app-id";
            const __firebase_config = '{"apiKey": "AIzaSyCyk9Jg_FW7jbVFh5XasK1Vb8_sP8J4zSE", "authDomain": "etech-d39e5.firebaseapp.com", "projectId": "etech-d39e5", "storageBucket": "etech-d39e5.firebasestorage.app", "messagingSenderId": "323388421053", "appId": "1:323388421053:web:9057d22d4ee4b7450398d4", "measurementId": "G-EV7M78EBGC"}';
            
            const firebaseConfig = JSON.parse(__firebase_config);
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const db = firebase.firestore();
            firebase.firestore.setLogLevel('debug');

            // --- UI Elements ---
            const mainHeader = document.getElementById('main-header'); // Get the main header
            const authModal = document.getElementById('auth-modal');
            const loginBtnNav = document.getElementById('login-btn-nav');
            const closeAuthBtn = document.querySelector('.close-auth');
            const authTabs = document.querySelectorAll('.auth-tab');
            const authForms = document.querySelectorAll('.auth-form');
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const googleLoginBtn = document.getElementById('google-login-btn');
            const userStatus = document.getElementById('user-status');
            const userAvatar = document.getElementById('user-avatar');
            const userName = document.getElementById('user-name');
            const logoutBtn = document.getElementById('logout-btn');
            const mobileToggle = document.querySelector('.mobile-toggle');
            const navMenu = document.getElementById('nav-menu');
            // NEW: Select all mobile nav links
            const mobileNavLinks = document.querySelectorAll('.mobile-nav-link'); 
            const techwhizFab = document.getElementById('techwhiz-fab');
            const techwhizModal = document.getElementById('techwhiz-modal');
            const closeTechwhizModalBtn = document.getElementById('close-techwhiz-modal');
            const chatHistory = document.getElementById('chat-history');
            const techwhizInput = document.getElementById('techwhiz-input');
            const micBtn = document.getElementById('mic-btn');
            const sendBtn = document.getElementById('send-btn');
            const stopSpeechBtn = document.getElementById('stop-speech-btn');
            const listeningStatus = document.getElementById('listening-status');
            const thinkingStatus = document.getElementById('thinking-status');
            const orderHistoryBtn = document.getElementById('order-history-btn');
            const orderHistoryModal = document.getElementById('order-history-modal');
            const closeHistoryBtn = document.querySelector('.close-history');
            const orderHistoryList = document.getElementById('order-history-list');
            const projectsGrid = document.getElementById('projects-grid');
            const filterBtns = document.querySelectorAll('.filter-btn');
            const projectDetailModal = document.getElementById('project-detail-modal');
            const closeProjectDetailBtn = document.querySelector('.close-project-detail');
            const projectDetailTitle = document.getElementById('project-detail-title');
            const projectDetailImage = document.getElementById('project-detail-image');
            const projectDetailDescription = document.getElementById('project-detail-description');
            const projectDetailTime = document.getElementById('project-detail-time');
            const projectDetailChip = document.getElementById('project-detail-chip');
            const projectDetailFeatures = document.getElementById('project-detail-features');
            const projectDetailComponents = document.getElementById('project-detail-components');
            
            // --- NEW Project Detail Elements ---
            const projectDetailApplications = document.getElementById('project-detail-applications');
            const projectDetailAdvantages = document.getElementById('project-detail-advantages');
            const projectDetailAim = document.getElementById('project-detail-aim'); // NEW
            const projectDetailThemeValue = document.getElementById('theme-value'); // NEW
            const projectSensorView = document.getElementById('project-sensor-view');
            const projectDetailSensorsUsed = document.getElementById('project-detail-sensors-used');

            const addToCartFromDetailBtn = document.getElementById('add-to-cart-from-detail');
            const buyNowFromDetailBtn = document.getElementById('buy-now-from-detail'); 
            
            const aiSummaryBtn = document.getElementById('ai-summary-btn');
            const aiSummaryContainer = document.getElementById('ai-summary-container');
            const aiSummaryText = document.getElementById('ai-summary-text');
            const simulatorPlaceholderBtn = document.getElementById('simulator-placeholder-btn');
            
            // NEW: Project Detail Tabs
            const projectDetailTabBtns = document.querySelectorAll('.project-detail-tabs button');
            const projectDetailTabWrapper = document.getElementById('project-detail-tab-wrapper');
            const askTechwhizDetailBtn = document.getElementById('ask-techwhiz-detail-btn'); // Button in the content pane
            const askTechwhizDetailBtnTab = document.getElementById('ask-techwhiz-detail-btn-tab'); // Button in the tab bar


            // --- Component Detail Modal Elements ---
            const componentCards = document.querySelectorAll('.component-card');
            const componentDetailModal = document.getElementById('component-detail-modal');
            const detailTitle = document.getElementById('detail-title');
            const detailImg = document.getElementById('detail-img');
            const detailDefinition = document.getElementById('detail-definition');
            const detailSymbol = document.getElementById('detail-symbol');
            const detailCharacteristics = document.getElementById('detail-characteristics');
            const detailApplications = document.getElementById('detail-applications');
            const closeDetailBtn = document.querySelector('#component-detail-modal .close-detail');
            const askTechwhizComponentBtn = document.getElementById('ask-techwhiz-component-btn');
            // NEW Sensor Visualization elements
            const sensorVizArea = document.getElementById('sensor-visualization-area');
            const sensorVizCanvas = document.getElementById('sensor-viz-canvas');
            const sensorDataReadout = document.getElementById('sensor-data-readout');
            let sensorVizInterval = null; // To hold the setInterval reference
            
            // --- Cart Elements ---
            const cartFab = document.getElementById('cart-fab');
            const cartModal = document.getElementById('cart-modal');
            const closeCartBtn = document.getElementById('close-cart-btn');
            const cartModalItemsContainer = document.getElementById('cart-modal-items');
            const cartTotalPriceElement = document.getElementById('cart-total-price');
            const cartCountElement = document.getElementById('cart-count');
            const cartItemCountHeader = document.getElementById('cart-item-count-header');
            const cartCheckoutBtn = document.getElementById('cart-checkout-btn');

            // --- Profile Modal Elements ---
            const profileModal = document.getElementById('profile-modal');
            const closeProfileBtn = document.getElementById('close-profile-btn');
            const profileDisplayName = document.getElementById('profile-display-name');
            const profileEmail = document.getElementById('profile-email');
            const profileUserId = document.getElementById('profile-user-id');
            const editProfileBtn = document.getElementById('edit-profile-btn');
            const profileLogoutBtn = document.getElementById('profile-logout-btn');
            const profileConceptsCount = document.getElementById('profile-concepts-count');
            const profileProjectsCount = document.getElementById('profile-projects-count');
            const profileOverallProgressBar = document.getElementById('profile-overall-progress-bar');
            
            // --- Progress Elements ---
            const suggestionsSidebar = document.querySelector('.suggestions-sidebar');
            const dynamicSuggestionsContent = document.getElementById('dynamic-suggestions-content');
            const overallProgressBar = document.getElementById('overall-progress-bar');
            const progressPercentage = document.getElementById('progress-percentage');
            
            let cart = [];
            let userProgress = {}; // Stores { conceptId: true/false }
            let allConcepts = []; // Array of all concepts from Skill Tree data
            let userId = null;
            const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
            const progressCollectionPath = () => `artifacts/${appId}/users/${userId}/progress`;

            // --- Skill Tree Data Structure (Unchanged) ---
            const skillTreeData = {
                id: "root",
                name: "E-TECH Path",
                children: [
                    {
                        id: "level1-basics",
                        name: "Level 1: Electronics Fundamentals",
                        children: [
                            { id: "resistor-basics", name: "Resistor", type: "concept" },
                            { id: "capacitor-basics", name: "Capacitor", type: "concept", parentId: "resistor-basics" },
                            { id: "diode-basics", name: "Diode", type: "concept", parentId: "capacitor-basics" },
                            { id: "project-blinking-led", name: "Project: Blinking LED", type: "project", parentId: "diode-basics" }
                        ]
                    },
                    {
                        id: "level2-microcontrollers",
                        name: "Level 2: MCUs & Logic",
                        parentId: "project-blinking-led",
                        children: [
                            { id: "mcu-arduino-uno", name: "Arduino Uno", type: "concept" },
                            { id: "transistor-basics", name: "Transistor", type: "concept", parentId: "mcu-arduino-uno" },
                            { id: "project-traffic-light", name: "Project: Traffic Light", type: "project", parentId: "transistor-basics" },
                            { id: "mcu-esp32", name: "ESP32 & WiFi", type: "concept", parentId: "project-traffic-light" }
                        ]
                    },
                    {
                         id: "level3-sensing",
                         name: "Level 3: Sensing & IoT",
                         parentId: "mcu-esp32",
                         children: [
                             { id: "sensor-ultrasonic", name: "Ultrasonic Sensor", type: "concept" },
                             { id: "sensor-pir", name: "PIR Motion Sensor", type: "concept" },
                             { id: "project-smart-alarm", name: "Project: Smart Alarm", type: "project", parentId: "sensor-ultrasonic" },
                             { id: "project-smart-alarm-iot", name: "Project: IoT Alarm", type: "project", parentId: "project-smart-alarm" }
                         ]
                    }
                ]
            };
            
            function extractAllConcepts(node) {
                if (node.type === 'concept' || node.type === 'project') {
                    allConcepts.push(node.id);
                }
                if (node.children) {
                    node.children.forEach(extractAllConcepts);
                }
            }
            extractAllConcepts(skillTreeData);
            const totalConcepts = allConcepts.length;
            
            // --- D3.js Skill Tree Rendering (Unchanged) ---
            function renderSkillTree(progress) {
                const container = document.getElementById('skill-tree-container');
                container.innerHTML = ''; // Clear previous tree
                
                const width = container.clientWidth;
                const height = 600;
                
                const svg = d3.select("#skill-tree-container").append("svg")
                    .attr("width", width)
                    .attr("height", height)
                    .attr("viewBox", `0 0 ${width} ${height}`)
                    .style("overflow", "visible")
                    .append("g")
                    .attr("transform", `translate(40, 0)`); // Shift tree right for nodes

                const treeLayout = d3.tree()
                    .size([height, width - 160]); // Size of the drawing area

                // Define links based on parentId for non-nested children
                function restructureData(data) {
                    const nodesMap = new Map();
                    const process = (node) => {
                        nodesMap.set(node.id, node);
                        if (node.children) {
                            node.children.forEach(process);
                        }
                    };
                    process(data);

                    // Manually assign children based on parentId fields
                    const rootNode = nodesMap.get("root");
                    const level1 = rootNode.children[0];
                    const level2 = rootNode.children[1];
                    const level3 = rootNode.children[2];
                    
                    // Clear default hierarchy structure for flat/linear linking
                    rootNode.children = [level1, level2, level3]; 

                    // Define sequential links within levels
                    level1.children[0].children = [level1.children[1]]; // Resistor -> Capacitor
                    level1.children[1].children = [level1.children[2]]; // Capacitor -> Diode
                    level1.children[2].children = [level1.children[3]]; // Diode -> Blinking LED

                    level2.children[0].children = [level2.children[1]]; // Arduino Uno -> Transistor
                    level2.children[1].children = [level2.children[2]]; // Transistor -> Traffic Light
                    level2.children[2].children = [level2.children[3]]; // Traffic Light -> ESP32

                    level3.children[0].children = [level3.children[2]]; // Ultrasonic -> Smart Alarm
                    level3.children[1].children = []; // PIR is a parallel path
                    level3.children[2].children = [level3.children[3]]; // Smart Alarm -> IoT Alarm
                    
                    // Link between levels
                    level1.children[3].children = [level2]; // Blinking LED -> Level 2
                    level2.children[3].children = [level3]; // ESP32 -> Level 3

                    return d3.hierarchy(rootNode);
                }

                const root = restructureData(JSON.parse(JSON.stringify(skillTreeData))); // Deep clone for modification
                
                // Set custom node depths for better horizontal flow
                root.each(d => {
                    const nodesMap = new Map(root.descendants().map(d => [d.data.id, d]));
                    if (d.data.id.includes('level1')) d.depth = 1;
                    else if (d.data.id.includes('level2')) d.depth = 2;
                    else if (d.data.id.includes('level3')) d.depth = 3;
                    else if (d.data.parentId && nodesMap.get(d.data.parentId)) {
                        d.depth = nodesMap.get(d.data.parentId).depth + 1;
                    } else if (d.data.parentId) {
                         // Fallback for nodes like 'resistor-basics' that are first in their level
                        d.depth = d.data.id.includes('basics') ? 2 : (d.data.id.includes('mcu') ? 3 : 4);
                    }
                });

                treeLayout(root);

                const nodesMap = new Map(root.descendants().map(d => [d.data.id, d]));

                // 1. Draw Links
                const link = svg.selectAll(".link")
                    .data(root.links())
                    .enter().append("path")
                    .attr("class", d => `link ${progress[d.target.data.parentId] ? 'completed' : ''}`)
                    .attr("d", d3.linkHorizontal()
                        .x(d => d.y)
                        .y(d => d.x)
                    );

                // 2. Draw Nodes
                const node = svg.selectAll(".node")
                    .data(root.descendants())
                    .enter().append("g")
                    .attr("class", d => `node ${d.children ? 'internal' : 'leaf'} ${progress[d.data.id] ? 'completed' : ''}`)
                    .attr("transform", d => `translate(${d.y},${d.x})`);

                // Add circles
                node.append("circle")
                    .attr("r", d => d.data.id === 'root' ? 0 : (d.children ? 6 : 10))
                    .attr("stroke-width", d => d.data.id === 'root' ? 0 : 3)
                    .on("click", (event, d) => {
                        if (d.data.type === 'concept' || d.data.type === 'project') {
                             handleConceptClick(d.data.id, progress);
                        }
                    })
                    .on("mouseover", function(event, d) {
                        d3.select(this).attr('r', d.children ? 8 : 12).style("fill", varFromTailwind('--accent'));
                        showToast(d.data.name + (progress[d.data.id] ? ' (Completed)' : ' (Pending)'), 'secondary');
                    })
                    .on("mouseout", function(event, d) {
                        d3.select(this).attr('r', d.children ? 6 : 10).style("fill", progress[d.data.id] ? varFromTailwind('--secondary') : '#555');
                    });

                // Add text labels
                node.append("text")
                    .attr("dy", d => d.children ? 20 : 15)
                    .attr("text-anchor", "middle")
                    .text(d => d.data.name)
                    .style("fill", varFromTailwind('--text-light'));
                    
                // Add icons for completed nodes
                node.filter(d => progress[d.data.id] && (d.data.type === 'concept' || d.data.type === 'project'))
                    .append("text")
                    .attr("dy", 4)
                    .attr("text-anchor", "middle")
                    .attr("class", "fas text-lg")
                    .style("font-family", "FontAwesome")
                    .style("fill", varFromTailwind('--primary'))
                    .text('\uf058'); // Checkmark icon
            }

            function handleConceptClick(conceptId, progress) {
                 if (userId) {
                    if (progress[conceptId]) {
                        showToast(`${conceptId} already completed!`, 'secondary');
                    } else {
                        // Check dependencies (simplified mock check)
                        let isDependencyComplete = true;
                        // Simplified check: allow completion if a dependency is marked as 'completed'
                        // In a real app, this would require traversing the dependency chain.
                        // For the purpose of this demo, we'll keep the mock simple.
                        
                        if (isDependencyComplete) {
                            toggleConceptCompletion(conceptId, true);
                        } else {
                             showToast(`Must complete prerequisite before starting ${conceptId}.`, 'accent');
                        }
                    }
                } else {
                    showToast("Please log in to track your progress.", 'accent');
                }
            }
            
            // --- Progress Tracking (Firestore) (Unchanged) ---
            
            async function toggleConceptCompletion(conceptId, isComplete) {
                if (!userId) return;
                const docRef = db.collection(progressCollectionPath()).doc(conceptId);

                try {
                    await docRef.set({ completed: isComplete, timestamp: firebase.firestore.FieldValue.serverTimestamp() }, { merge: true });
                    showToast(`${conceptId} marked as ${isComplete ? 'completed' : 'incomplete'}.`, isComplete ? 'secondary' : 'accent');
                } catch (error) {
                    console.error("Error writing progress: ", error);
                    showToast("Failed to update progress.", 'accent');
                }
            }

            function updateLearningProgress(progressData) {
                userProgress = progressData;
                const completedCount = Object.keys(progressData).length;
                const percentage = totalConcepts > 0 ? Math.round((completedCount / totalConcepts) * 100) : 0;
                
                // Update Skill Tree
                renderSkillTree(progressData);
                
                // Update Component Card borders
                document.querySelectorAll('.component-card').forEach(card => {
                    const conceptId = card.dataset.conceptId;
                    card.classList.remove('border-green-500', 'ring-2', 'ring-green-500');
                    if (progressData[conceptId]) {
                        card.classList.add('border-green-500', 'ring-2', 'ring-green-500');
                    } else {
                        card.classList.remove('ring-2', 'ring-green-500');
                    }
                });
            }
            
            function generateDynamicSuggestions(progressData) {
                // NOTE: This function is simplified due to dependency on missing elements
                // dynamicSuggestionsContent.innerHTML = '';
                // ... (logic remains the same)
            }
            
            // --- Component Completion Mock Button (Unchanged) ---
            document.querySelectorAll('.component-card').forEach(card => {
                card.addEventListener('dblclick', () => {
                    if (userId) {
                        const conceptId = card.dataset.conceptId;
                        const isCompleted = userProgress[conceptId] === true;
                        toggleConceptCompletion(conceptId, !isCompleted);
                    } else {
                        showToast("Please log in to track your progress.", 'accent');
                    }
                });
            });

            // --- Real-time Firestore Progress Listener (Unchanged) ---
            function setupProgressListener(currentUserId) {
                if (window.unsubscribeProgress) {
                    window.unsubscribeProgress(); // Unsubscribe from previous user's listener
                }
                
                if (!currentUserId) {
                    updateLearningProgress({}); // Clear progress if logged out
                    return;
                }
                
                const q = db.collection(progressCollectionPath());
                
                // Listen for changes
                window.unsubscribeProgress = q.onSnapshot(snapshot => {
                    const progressData = {};
                    snapshot.forEach(doc => {
                        if (doc.data().completed) {
                            progressData[doc.id] = true;
                        }
                    });
                    updateLearningProgress(progressData);
                }, error => {
                    console.error("Firestore Progress Listener Error:", error);
                    showToast("Error loading learning progress.", 'accent');
                });
            }


            // --- Sensor Visualization Mock Logic (Unchanged) ---
            const sensorData = {
                ultrasonic: { unit: 'cm', min: 2, max: 200, value: 50, update: 100 },
            };

            function startSensorVisualization(type) {
                if (sensorVizInterval) clearInterval(sensorVizInterval);

                const data = sensorData[type];
                if (!data) return;

                const ctx = sensorVizCanvas.getContext('2d');
                let width = sensorVizCanvas.width = sensorVizCanvas.clientWidth;
                let height = sensorVizCanvas.height = sensorVizCanvas.clientHeight;
                
                // Gauge drawing function
                const drawGauge = () => {
                    ctx.clearRect(0, 0, width, height);

                    const centerX = width / 2;
                    const centerY = height; // Draw from the bottom
                    const radius = height * 0.9;
                    const startAngle = Math.PI; // 180 degrees
                    const endAngle = 2 * Math.PI; // 360 degrees

                    // Scale the value to the angle range (180 to 360 degrees)
                    const range = data.max - data.min;
                    const angleRatio = (data.value - data.min) / range;
                    const needleAngle = startAngle + (endAngle - startAngle) * angleRatio;
                    
                    // Background Arc
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, startAngle, endAngle, false);
                    ctx.lineWidth = 20;
                    ctx.strokeStyle = varFromTailwind('--border-color');
                    ctx.stroke();

                    // Fill Arc (Progress)
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, startAngle, needleAngle, false);
                    ctx.lineWidth = 20;
                    ctx.strokeStyle = varFromTailwind('--secondary');
                    ctx.stroke();

                    // Needle
                    ctx.beginPath();
                    ctx.strokeStyle = varFromTailwind('--accent');
                    ctx.lineWidth = 3;
                    ctx.moveTo(centerX, centerY);
                    ctx.lineTo(
                        centerX + radius * Math.cos(needleAngle),
                        centerY + radius * Math.sin(needleAngle)
                    );
                    ctx.stroke();
                    
                    // Center Dot
                    ctx.fillStyle = varFromTailwind('--accent');
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, 5, 0, 2 * Math.PI);
                    ctx.fill();

                    // Text Readout
                    ctx.fillStyle = varFromTailwind('--text-light');
                    ctx.font = '24px Orbitron';
                    ctx.textAlign = 'center';
                    ctx.fillText(`${data.value}${data.unit}`, centerX, centerY - radius / 3);
                };
                
                // Mock data generation loop
                sensorVizInterval = setInterval(() => {
                    // Simulate random fluctuation
                    const delta = (Math.random() * 20) - 10;
                    let newValue = data.value + delta;
                    
                    // Clamp value within min/max
                    if (newValue < data.min) newValue = data.min;
                    if (newValue > data.max) newValue = data.max;

                    data.value = Math.round(newValue);
                    sensorDataReadout.textContent = `Reading: ${data.value} ${data.unit} (Mock Data)`;
                    drawGauge();
                }, data.update);

                // Initial draw and resize handler
                drawGauge();
                window.addEventListener('resize', () => {
                    width = sensorVizCanvas.width = sensorVizCanvas.clientWidth;
                    height = sensorVizCanvas.height = sensorVizCanvas.clientHeight;
                    drawGauge();
                });
            }

            function stopSensorVisualization() {
                if (sensorVizInterval) {
                    clearInterval(sensorVizInterval);
                    sensorVizInterval = null;
                }
                sensorVizArea.classList.add('hidden');
                sensorDataReadout.textContent = 'Status: Idle';
            }
            
            // Helper function to get Tailwind colors
            function varFromTailwind(varName) {
                return getComputedStyle(document.documentElement).getPropertyValue(varName) || '#ffffff';
            }


            // --- Consolidated Project Data (EXPANDED with two new projects) ---
            const projectsList = [
                { 
                    id: 'iot1', 
                    name: 'Smart Home Automation System', 
                    theme: 'IoT & Remote Control', // NEW FIELD
                    aim: 'To develop a comprehensive, wireless system capable of controlling household appliances securely over the internet.', // NEW FIELD
                    description: 'Build a system to control lights, fans, and appliances remotely using ESP32 and a secure cloud platform.', 
                    image: 'https://images.unsplash.com/photo-1550745165-9bc0b252726f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80', 
                    price: 4500, 
                    time: '4 hours', 
                    chip: 'ESP32', 
                    type: 'iot',
                    applications: ['Residential automation', 'Remote device management', 'Energy optimization'],
                    advantages: ['Wireless control via Wi-Fi.', 'Scalable design for adding more devices.', 'Learning cloud integration basics (MQTT/HTTP).'],
                    features: ['Remote control via app', 'Scheduler functions', 'Voice command integration', 'Over-The-Air (OTA) updates'], // EXPANDED
                    requirements: ['ESP32 board', '2-channel Relay module', 'LEDs', 'Solid internet connection', 'Breadboard and Jumper Wires'], // EXPANDED
                    sensorsUsed: ['None (Actuator focus)'],
                    buyLink: 'https://rzp.io/rzp/smarthomeautomations',
                
                    aiSummary: "This core IoT project teaches you how to bridge hardware (relays, lights) and software (cloud platform, Wi-Fi) to create a controllable home environment. The key learning outcome is **secure device control over the internet**, foundational for any smart device career."
                },
                { 
                    id: 'ard1', 
                    name: 'Automatic Irrigation System', 
                    theme: 'Agriculture & Environmental Monitoring', // NEW FIELD
                    aim: 'To design and implement an automated watering system for plants based on real-time soil moisture data, saving water and improving plant health.', // NEW FIELD
                    description: 'A project using Arduino Uno to measure soil moisture and automatically water plants using a small pump.', 
                    image: 'https://images.unsplash.com/photo-1594803986683-12a81878d655?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80', 
                    price: 3500, 
                    time: '3 hours', 
                    chip: 'Arduino Uno', 
                    type: 'arduino',
                    applications: ['Small home gardens', 'Vertical farming setups', 'Educational tool for sensors'],
                    advantages: ['Simple to build and program.', 'Excellent introduction to analog inputs and DC motors.', 'Efficient water usage.'],
                    features: ['Soil moisture level display (LCD)', 'Automatic pump activation', 'Adjustable moisture threshold', 'Manual override button'], // EXPANDED
                    requirements: ['Arduino Uno', 'Soil Moisture Sensor', 'DC Water Pump', 'Relay Module', 'LCD Display (16x2)', 'Hoses and Water Supply'], // EXPANDED
                    sensorsUsed: ['Soil Moisture Sensor'],
                    buyLink: 'https://forms.gle/buy-arduino-irrigation-kit',
                    aiSummary: "This project provides a perfect introduction to closed-loop control systems. You'll learn how to interpret analog data from a **Soil Moisture Sensor** and use an **Arduino** to trigger an actuator (water pump) to maintain optimal conditions. It's practical and a great resume builder."
                },
                
  
   
    {
      "id": "iot2",
      "name": "Weather Monitoring Station",
      "theme": "Environmental Sensing & Data Logging",
      "aim": "To build a device for collecting real-time weather data and visualizing it on a cloud-based dashboard.",
      "description": "Real-time weather data collection with cloud dashboard visualization.",
      "image": "https://images.unsplash.com/photo-1603732551681-2e91159b9dc2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
      "price": 2500,
      "time": "6 hours",
      "chip": "NodeMCU",
      "type": "iot",
      "applications": [
        "Hobbyist weather reporting",
        "Agriculture (microclimate monitoring)",
        "Educational data science projects"
      ],
      "advantages": [
        "Mastering multiple digital sensors (DHT11/BME280).",
        "Deep understanding of HTTP/MQTT data transfer.",
        "Creating custom data dashboards (ThingSpeak)."
      ],
      "features": [
        "Measures temperature, humidity, pressure",
        "Uploads data to a cloud platform (e.g., ThingSpeak)",
        "Real-time dashboard"
      ],
      "requirements": [
        "NodeMCU ESP8266 board",
        "DHT11 or BME280 sensor",
        "Jumper wires",
        "Micro-USB cable"
      ],
      "sensorsUsed": [
        "DHT11/BME280 (Temperature, Humidity, Pressure)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-2",
      "aiSummary": "A practical project that focuses on **data acquisition and cloud analytics**. You'll connect the NodeMCU to environmental sensors and establish reliable data streams to a cloud platform for visualization."
    },
    {
      "id": "iot3",
      "name": "Smart Plant Monitoring System",
      "theme": "Agri-tech & Automated Care",
      "aim": "To create an automated system that monitors plant health factors and can trigger irrigation when necessary.",
      "description": "Automated plant care system with soil moisture and light sensors.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMz4IzRgDdfg8mYYH_kaqB8PP5ULbi4FEa8OB5HQQNlpGXKoZRaAqxtNi6GcMMcH60GImYAtDT_EuaqN9P-XowHtrXO9c6dyx3dAl5VLqENPLFJbE0=w2400",
      "price": 2800,
      "time": "3 hours",
      "chip": "Arduino IoT",
      "type": "iot",
      "applications": [
        "Home gardening automation",
        "Greenhouse management",
        "Educational robotics"
      ],
      "advantages": [
        "Integration of analog sensors (Moisture, LDR).",
        "Implementing decision logic (IF moisture < threshold THEN water).",
        "Introduction to the Arduino IoT Cloud."
      ],
      "features": [
        "Measures soil moisture and light level",
        "Sends alerts for low moisture",
        "Can trigger automatic watering"
      ],
      "requirements": [
        "Arduino MKR IoT Carrier",
        "Soil Moisture sensor",
        "LDR (Light Dependent Resistor) sensor",
        "Water pump (optional)",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "Soil Moisture Sensor",
        "LDR Sensor (Light)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-3",
      "aiSummary": "This project offers a great introduction to **Agri-tech and embedded decision-making**. You learn how to use sensor inputs to automate physical actions, ensuring your plants stay healthy."
    },
    {
      "id": "iot4",
      "name": "Smart Door Lock System",
      "theme": "Security & Biometrics",
      "aim": "To design and implement a high-security access control system using multiple authentication methods (biometric/RFID).",
      "description": "Biometric and RFID-based door lock system with remote access.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOhh4amBa25ZdPCNwOYKvKm5qWbsM6qBiCmcb7XwWNMRG5PnFdmQpFxzWbOZj1WrZnyVdfvnPB47MI2PQ_DNInLqnU3YoxCsfMpXMcFB6hWsw2EAns=w2400",
      "price": 3000,
      "time": "5 hours",
      "chip": "Raspberry Pi",
      "type": "iot",
      "applications": [
        "Home and office security",
        "Restricted access areas",
        "Time-based access control systems"
      ],
      "advantages": [
        "Programming in Python on a Linux environment (Raspberry Pi).",
        "Interfacing with complex peripherals (Fingerprint/RFID).",
        "Creating a simple web interface for remote management."
      ],
      "features": [
        "Fingerprint or RFID unlock",
        "Remote unlock via web interface",
        "Logs access history"
      ],
      "requirements": [
        "Raspberry Pi board",
        "Fingerprint sensor or RFID reader",
        "Servo motor or solenoid lock",
        "Power supply",
        "External display (optional)"
      ],
      "sensorsUsed": [
        "Fingerprint Sensor",
        "RFID Reader"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-4",
      "aiSummary": "A powerful project on **embedded Linux and multi-factor authentication**. You will learn to manage peripherals and build a robust, logging-enabled security system using the Raspberry Pi."
    },
    {
      "id": "iot5",
      "name": "Water Quality Monitor",
      "theme": "Environmental Sensing & Analysis",
      "aim": "To monitor and report on critical water parameters (pH, turbidity, temperature) in real-time for safety analysis.",
      "description": "Real-time monitoring of pH, turbidity, and temperature in water sources.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczO3wUaCNA1YtgMGIXYfHBkPdXIqv-Nhm_jU-060QjUuy9Q1U75Pa6ci1l1qujYxvj_5dAwSEQIrYGh0twldk6RmtX1i6ukHGfvpzaYh1UnLwHCroOo=w2400",
      "price": 3200,
      "time": "7 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Aquaculture monitoring",
        "Home drinking water analysis",
        "Industrial liquid process control"
      ],
      "advantages": [
        "Handling sensitive analog-to-digital (ADC) conversions.",
        "Sensor calibration techniques (crucial for pH/Turbidity).",
        "Implementing cloud alerts for critical parameter deviations."
      ],
      "features": [
        "Measures multiple parameters (pH, temp, turbidity)",
        "Online data visualization",
        "Alerts for unsafe levels"
      ],
      "requirements": [
        "ESP32 board",
        "pH sensor with interface board",
        "Turbidity sensor",
        "DS18B20 Temperature sensor",
        "Wi-Fi module (integrated)",
        "Waterproof enclosure (recommended)"
      ],
      "sensorsUsed": [
        "pH Sensor",
        "Turbidity Sensor",
        "DS18B20 Temperature Sensor"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-5",
      "aiSummary": "An advanced sensing project that focuses on **accurate data acquisition from challenging environments**. You will gain experience in handling analog data from multiple specialized chemical sensors and sending it via Wi-Fi."
    },
    {
      "id": "iot6",
      "name": "Air Quality Monitor",
      "theme": "Health & Environmental Monitoring",
      "aim": "To provide accurate, real-time measurements of indoor air quality pollutants (CO2, VOCs) and notify users of unsafe conditions.",
      "description": "Monitor indoor air quality (CO2, VOCs) and get alerts on your phone.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNbPQTQpT-v2jgjYClkeiZbiBTJZdj9C8GSxR4JKjcYtIoLntk4OTlkuY39GH7MzpBM92nbBuJBxH-V8BhK6MVjxHlTgH2aLS68CWZuewDJ-M_3TbYW=w2400",
      "price": 2200,
      "time": "4 hours",
      "chip": "ESP8266",
      "type": "iot",
      "applications": [
        "Indoor home monitoring",
        "Office ventilation analysis",
        "Safety systems for laboratories"
      ],
      "advantages": [
        "Understanding gas sensor linearization and calibration.",
        "Implementing asynchronous data transmission.",
        "Setting up push notifications for critical alerts."
      ],
      "features": [
        "Measures CO2 and particulate matter",
        "Mobile alerts via push notification",
        "Historical data logging"
      ],
      "requirements": [
        "ESP8266 NodeMCU board",
        "MQ-135 Air Quality Sensor or equivalent",
        "Blynk or ThingSpeak cloud account",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "MQ-135 (CO2/VOCs/Air Quality)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-6",
      "aiSummary": "Focuses on **air quality sensing and mobile integration**. You will learn how to interface the ESP8266 with specialized gas sensors and deliver critical information directly to a smartphone app."
    },
    {
      "id": "iot7",
      "name": "Smart Garage Door Controller",
      "theme": "Remote Access & Security",
      "aim": "To enable secure, remote operation and real-time status monitoring of a garage door via a smartphone.",
      "description": "Open and close your garage door securely with your smartphone.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOtE0jiqG8uxzVojjNKXzjtlpdcaaknl9za2lbpf-2tgenIcjpo6HUgt1HFOV6b4h_iMUdNUJcsmVRoXDuYRvwHkGIn7ulNzU2W8HjPPzce7RZVnuvt=w2400",
      "price": 2700,
      "time": "3 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Home convenience and security",
        "Remote property access management"
      ],
      "advantages": [
        "Interfacing actuators (Relay) and sensors (Contact Sensor) simultaneously.",
        "Implementing a secure, momentary trigger mechanism.",
        "Real-time state management and feedback over Wi-Fi."
      ],
      "features": [
        "Remote control via smartphone",
        "Real-time status monitoring",
        "Security logging"
      ],
      "requirements": [
        "ESP32 board",
        "Single-channel Relay module",
        "Magnetic contact sensor",
        "Jumper wires",
        "Power supply"
      ],
      "sensorsUsed": [
        "Magnetic Contact Sensor (Door status)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-7",
      "aiSummary": "A fast, high-utility project focused on **actuator and feedback control**. You'll master the logic required to safely and remotely operate a simple mechanical system with full status verification."
    },
    {
      "id": "iot8",
      "name": "Smart Parking System",
      "theme": "Smart City & Infrastructure",
      "aim": "To build a proof-of-concept system that detects parking occupancy and displays it on a centralized web map.",
      "description": "Detect available parking spots and display the status on a web app.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMcTyJEqQieDRarrMtJGIokVaOjlcdPVM2UGRyXPkAHdyAkOXaJob1KD0mZLBStte4k-fHF-UPDdvjANIljeMYkz9IcXmyG-h8aH2AaPtxz01erYZaM=w2400",
      "price": 3800,
      "time": "9 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Urban parking management",
        "Mall/office complex optimization",
        "Traffic flow monitoring"
      ],
      "advantages": [
        "Handling input from multiple identical sensors (Ultrasonic).",
        "Building a simple embedded web server on the ESP32.",
        "Implementing centralized real-time data aggregation."
      ],
      "features": [
        "Uses ultrasonic sensors to detect cars",
        "Web-based status map",
        "Real-time occupancy calculation"
      ],
      "requirements": [
        "ESP32 board",
        "Multiple HC-SR04 Ultrasonic sensors",
        "Breadboard and Jumper Wires",
        "Basic HTML/CSS knowledge for web app"
      ],
      "sensorsUsed": [
        "HC-SR04 Ultrasonic Sensor (Distance/Presence)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-8",
      "aiSummary": "This complex project involves **multi-sensor fusion and embedded web hosting**. You'll manage data from several ultrasonic sensors simultaneously to create a functional 'Smart City' infrastructure application."
    },
    {
      "id": "iot9",
      "name": "Water Leak Detector",
      "theme": "Preventative Home Safety",
      "aim": "To provide an early warning system for water leaks using a simple sensor and instant notification mechanism.",
      "description": "Get instant alerts on detecting water leaks to prevent property damage.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMwJuf2Gao8XnNIbQPNniX9ui2aL2jrN7VkK3lKp5025JjUy2qDSGiWV_2BH5dppduINUbedELTBpleqsaqrFU9st2VebPl110pvFLGSm5DgQA_lxty=w2400",
      "price": 1800,
      "time": "2 hours",
      "chip": "ESP8266",
      "type": "iot",
      "applications": [
        "Basement/laundry room monitoring",
        "Pipe leak detection",
        "Battery-powered remote sensing"
      ],
      "advantages": [
        "Focus on ultra-low power consumption (deep sleep mode).",
        "Setting up email/app alert triggers.",
        "Simple, effective binary sensor integration."
      ],
      "features": [
        "Instant email/app alerts",
        "Simple sensor interface",
        "Battery-powered operation"
      ],
      "requirements": [
        "ESP8266 NodeMCU board",
        "Water level sensor or leak sensor",
        "Buzzer (optional)",
        "Battery power source (e.g., Li-ion battery)"
      ],
      "sensorsUsed": [
        "Water Level/Leak Sensor"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-9",
      "aiSummary": "A quick, entry-level project focusing on **critical alerting and low-power design**. The main takeaway is setting up instant, reliable notifications for binary events over Wi-Fi."
    },
    {
      "id": "iot10",
      "name": "Automated Window Blinds",
      "theme": "Mechanical Automation & Scheduling",
      "aim": "To motorize window blinds and control them based on a time schedule or manual app input.",
      "description": "Control your window blinds based on time of day or with a mobile app.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNLgUMAQiX0-78WGyUGE0ON8hhEYXGtIkOXhzH9eotPT3fA08VX6J2M1qbYJgtBvsFLD_v7Btrx0qFxAa1o0WW5aNmV8E8Q-g8phTF65_SjVp59FqRZ=w2400",
      "price": 4000,
      "time": "5 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Smart home convenience",
        "Energy efficiency (solar gain control)",
        "Accessibility devices"
      ],
      "advantages": [
        "Precision control of stepper/servo motors.",
        "Implementing time-based scheduling (RTC/NTP sync).",
        "Optional sensor feedback for light-level automation."
      ],
      "features": [
        "Scheduled automation",
        "Manual control via app",
        "Sunlight tracking option"
      ],
      "requirements": [
        "ESP32 board",
        "Stepper motor or high-torque Servo",
        "Motor driver (e.g., A4988 for Stepper)",
        "LDR (optional for light tracking)",
        "Custom mounting/pulley system"
      ],
      "sensorsUsed": [
        "LDR (optional, for light sensing)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-10",
      "aiSummary": "This is a great **electro-mechanical automation** project. You will combine Wi-Fi connectivity with motor control techniques to precisely move a physical system based on remote commands and internal timing."
    },
    {
      "id": "iot11",
      "name": "Smart Trash Can Monitor",
      "theme": "Smart City & Waste Management",
      "aim": "To measure the fill level of a trash can and report the status remotely to optimize waste collection logistics.",
      "description": "A trash can that reports when it's full to optimize collection routes.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNTNQoCfHLWX08xLsqZeQuVo99HtEqhR8zu5htwDjzXjwCbcYi6J03MHm70VQLFEgsdkl7yjd7QyVKUdyq6Ik5r_O2moA1MrcCk43ELanukSAl1I8Kp=w2400",
      "price": 3600,
      "time": "4 hours",
      "chip": "Arduino Uno & ESP8266",
      "type": "iot",
      "applications": [
        "Municipal waste management",
        "Inventory level monitoring",
        "Capacity planning"
      ],
      "advantages": [
        "Integrating two microcontrollers (Arduino for sensing, ESP for Wi-Fi).",
        "Using ultrasonic distance measurement for non-contact level detection.",
        "Data communication between two chips (Serial/I2C)."
      ],
      "features": [
        "Ultrasonic sensing for fill level",
        "Remote status reporting",
        "Web interface visualization"
      ],
      "requirements": [
        "Arduino Uno board",
        "ESP8266 module (for WiFi connectivity)",
        "HC-SR04 Ultrasonic sensor",
        "Power supply",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "HC-SR04 Ultrasonic Sensor (Distance/Level)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-11",
      "aiSummary": "A solid project in **sensor integration and logistics optimization**. You will focus on reliably measuring fill levels using ultrasonic technology and reporting that data over a network for visualization."
    },
    {
      "id": "iot12",
      "name": "Gas Leakage Detector",
      "theme": "Safety & Critical Alerting",
      "aim": "To detect dangerous concentrations of flammable gases and trigger instant, reliable alerts via SMS.",
      "description": "Detects flammable gases and sends an alert to your phone via SMS.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOZc5U7gYfBqpvVESXFTTUDR-Qpbm_9AcRCElSQ6DteyU2EjHfmmcyDsd68szD9PWMGdGpnCrd0dhUzR3EQBrT73UCfkb2xwSrHQWxvZWH3xqDWBZ29=w2400",
      "price": 4200,
      "time": "3 hours",
      "chip": "NodeMCU & GSM Module",
      "type": "iot",
      "applications": [
        "Kitchen/utility room safety",
        "Industrial gas monitoring",
        "Remote security applications"
      ],
      "advantages": [
        "Interfacing with GSM/GPRS modules (AT commands).",
        "Setting up reliable, non-internet-dependent communication (SMS).",
        "Calibrating and using chemical gas sensors (MQ series)."
      ],
      "features": [
        "High-sensitivity gas detection",
        "Instant SMS alerts to multiple users",
        "Audible alarm"
      ],
      "requirements": [
        "NodeMCU ESP8266 board",
        "MQ-2 Gas Sensor",
        "SIM800L GSM Module (requires SIM card)",
        "Buzzer",
        "Separate power supply for GSM module"
      ],
      "sensorsUsed": [
        "MQ-2 Gas Sensor (Flammable Gas)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-12",
      "aiSummary": "This high-importance project focuses on **critical communication via GSM**. You will learn to use a specialized gas sensor and ensure that emergency alerts are delivered instantly using SMS text messaging."
    },
    {
      "id": "iot13",
      "name": "Smart Pill Dispenser",
      "theme": "Healthcare & Automated Assistance",
      "aim": "To create a device that reminds users and automatically dispenses medication according to a set, programmable schedule.",
      "description": "An automated pill dispenser that reminds and provides medication on schedule.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNItSPWo_al2EEtsxrCDpIu5Vff597duvTuTWL5ZeJ2Z7gbnqEEQAewh7A2XNHDsYP3Hz3BzxaMF2FdIkYxl7PfkTQjv25LkujUP061XYW4B8YaDbiJ=w2400",
      "price": 4500,
      "time": "7 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Elderly care assistance",
        "Chronic medication management",
        "Clinical trial compliance"
      ],
      "advantages": [
        "Complex scheduling logic using Real-Time Clock (RTC).",
        "Precision control of multiple servo motors for dispensing.",
        "Developing a user-friendly mobile application interface."
      ],
      "features": [
        "Programmable scheduling",
        "Mobile app reminders",
        "Dispenses medication accurately"
      ],
      "requirements": [
        "ESP32 board",
        "Multiple Servo motors",
        "RTC (Real-Time Clock) module (e.g., DS3231)",
        "Custom housing (e.g., 3D printed dispenser mechanism)"
      ],
      "sensorsUsed": [
        "RTC Module (Time keeping)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-13",
      "aiSummary": "A challenging **mechatronics and scheduling** project. The focus is on using the RTC and Wi-Fi to maintain precise timing for medication dispensing, which is crucial for health-related applications."
    },
    {
      "id": "iot14",
      "name": "Community Noise Monitor",
      "theme": "Environmental Sensing & Public Data",
      "aim": "To continuously monitor ambient noise levels in a specific area and share the data publicly on an online platform.",
      "description": "Monitor noise levels in your neighborhood and visualize the data online.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczP5oLCjmMnMsBxC45jafW_zGbEAMQITQzJ68Q3YmLPXD8_8v_UnTaapyL7_yUkQuKMDBBPV1dh7FJLWx_Gj84SQ_E7GB1910BoDDAogQeCwb99jxyrX=w2400",
      "price": 3000,
      "time": "3 hours",
      "chip": "NodeMCU",
      "type": "iot",
      "applications": [
        "Urban planning",
        "Noise pollution research",
        "Community engagement projects"
      ],
      "advantages": [
        "Converting analog sound input to meaningful digital dB values.",
        "Uploading data to public platforms (e.g., Ubidots).",
        "Understanding sampling rates and data averaging."
      ],
      "features": [
        "Measures Decibel (dB) levels",
        "Time-series data plotting online",
        "Alerts for excessive noise"
      ],
      "requirements": [
        "NodeMCU ESP8266 board",
        "Sound sensor module",
        "Cloud platform (e.g., Ubidots) account",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "Sound Sensor Module (Decibel)"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-14",
      "aiSummary": "Focuses on **sound processing and public data visualization**. You'll use the sound sensor to convert physical noise into digital metrics and publish it for community consumption using an IoT platform."
    },
    {
      "id": "iot15",
      "name": "Automated Attendance System",
      "theme": "Access Control & Database Management",
      "aim": "To use RFID or fingerprint authentication to track user attendance and log the data automatically to a cloud database.",
      "description": "Use RFID or fingerprint scanning to take attendance and store it in the cloud.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczPGKK9Ou3S5cZQ3MLtrlNpi1evu_A1UJvCS-R281bBkWlSVX9r3LLtJqci9seEJp4jjfS0O2kkh641xM7m46g-uV91kZkGjYpd5y2DdohOgvVIJyvX1=w2400",
      "price": 3000,
      "time": "5 hours",
      "chip": "ESP32",
      "type": "iot",
      "applications": [
        "Classroom/workplace attendance tracking",
        "Event registration systems",
        "Time clock applications"
      ],
      "advantages": [
        "Interfacing with authentication hardware (Biometrics/RFID).",
        "Securely writing and retrieving data from an external cloud database (Firebase).",
        "Developing a simple administration web interface for records."
      ],
      "features": [
        "Biometric/RFID authentication",
        "Cloud database logging",
        "Web interface for admin review"
      ],
      "requirements": [
        "ESP32 board",
        "RFID or Fingerprint sensor module",
        "External cloud database (e.g., Firebase setup)",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "RFID Sensor or Fingerprint Sensor"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-15",
      "aiSummary": "A business-focused project covering **authentication and robust database integration**. You will learn how to securely link a hardware event (a scan) to a timestamped entry in a cloud database."
    },
    {
      "id": "iot16",
      "name": "Smart Energy Monitor",
      "theme": "Energy Management & Analytics",
      "aim": "To accurately measure and log household energy consumption (current/voltage) in real-time for detailed usage analytics.",
      "description": "Track home energy consumption in real-time with cloud analytics.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMQHImgAVpKLMrB0HgqxOyOCvCf3DRh7QoOSD1hEC37tibujuitBjZahY_vpqnPxLHD-1mOlUYT7RMivEPoCqNJGa3e6j83uvvR6FDcV4oPcgCtHuI=w2400",
      "price": 2300,
      "time": "6 hours",
      "chip": "ESP8266",
      "type": "iot",
      "applications": [
        "Home energy auditing",
        "Solar power system monitoring",
        "Identifying energy-wasting appliances"
      ],
      "advantages": [
        "Interfacing with complex measurement sensors (CT/Voltage modules).",
        "Implementing mathematical calculations (Voltage x Current = Power).",
        "Creating historical trend charts for energy consumption."
      ],
      "features": [
        "Real-time current/voltage measurement",
        "Energy cost estimation",
        "Historical data trends"
      ],
      "requirements": [
        "ESP8266 NodeMCU board",
        "Current Transformer sensor (CT clamp)",
        "Voltage sensor module",
        "Cloud platform for analytics",
        "Safety precautions for electrical wiring"
      ],
      "sensorsUsed": [
        "Current Transformer (CT) Sensor",
        "Voltage Sensor"
      ],
      "buyLink": "https://forms.gle/buy-iot-kit-16",
      "aiSummary": "This challenging project focuses on **precision electrical measurement and computation**. You will learn how to safely and accurately measure AC parameters and convert them into valuable energy consumption data."
    },
    {
      "id": "ard1",
      "name": "RFID Door Lock System",
      "theme": "Security & Basic Actuators",
      "aim": "To build a simple, secure door lock system using RFID card authentication.",
      "description": "Secure door lock system using RFID cards for authentication.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOgMwMLSmyMPWQu2UZt3_P60dSVM3eOyRvzt2lEAzMmy1lC0lIWxdcYl1C05WNAHIcxcr9EDiAzzNf0oz9ln5lZOAxKH-U6nyC5d48CCfqgpk9PEEY=w2400",
      "price": 2500,
      "time": "3 hours",
      "chip": "Arduino Uno",
      "type": "arduino",
      "applications": [
        "Home/school locker security",
        "Access control for hobby projects",
        "Basic authentication training"
      ],
      "advantages": [
        "Mastering SPI communication for the RC522 module.",
        "Precise control of a Servo motor for locking.",
        "Implementing simple ID storage and verification logic."
      ],
      "features": [
        "Card-based access control",
        "Simple programming",
        "Uses a servo motor for locking mechanism"
      ],
      "requirements": [
        "Arduino Uno board",
        "RC522 RFID reader module",
        "Servo motor",
        "Breadboard and Jumper Wires",
        "Arduino IDE"
      ],
      "sensorsUsed": [
        "RC522 RFID Reader"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-1",
      "aiSummary": "A foundational project on **access control and security**. You will gain hands-on experience using the RC522 RFID module to read unique identifiers and trigger a physical actuator (the servo motor)."
    },
    {
      "id": "ard2",
      "name": "Bluetooth Controlled Car",
      "theme": "Robotics & Wireless Control",
      "aim": "To construct a mobile robot and control its movement wirelessly using a smartphone via a Bluetooth connection.",
      "description": "Smartphone-controlled car using Bluetooth module.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNotsOrKUzeRAeXLL4dPEe2y8cdeQGi21-fHEUdQX39zdsfOfbPa22rNrGyNASSRxYibDHVE9GzGXLfPB7Lb-ECgOCt9naJjY1JlmUJJcAa0--wmnAn=w2400",
      "price": 2700,
      "time": "4 hours",
      "chip": "Arduino Nano",
      "type": "ard",
      "applications": [
        "Remote-controlled toys",
        "Educational robotics platforms",
        "Introduction to mechatronics"
      ],
      "advantages": [
        "Understanding Serial communication via Bluetooth (HC-05).",
        "Controlling DC motors using an H-bridge driver (L298N).",
        "Implementing command parsing logic (Forward, Back, Turn)."
      ],
      "features": [
        "App-based control (forward, backward, turn)",
        "Easy to assemble chassis",
        "Fun to build and play with"
      ],
      "requirements": [
        "Arduino Nano board",
        "HC-05 Bluetooth module",
        "L298N motor driver",
        "DC motors (2 or 4)",
        "Wheels and Chassis kit",
        "Battery pack"
      ],
      "sensorsUsed": [
        "HC-05 Bluetooth Module (Receiver)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-2",
      "aiSummary": "A hands-on project that is core to **robotics and motor control**. You will focus on receiving commands via Bluetooth and translating them into precise movements using the L298N motor driver."
    },
    {
      "id": "ard3",
      "name": "Ultrasonic Radar System",
      "theme": "Sensing & Data Visualization",
      "aim": "To build a sweep radar that detects the distance of objects in a 180-degree field and plots the data on a computer screen.",
      "description": "Object detection system with servo-mounted ultrasonic sensor.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczNnRLm4YRZDNsHd66bzXpC4uyAxseClnEnp0xJO84xtn9hGqYOpnfvjVo5aqP3q21N4p7PZBrA00-tcL_TgqUV06eKT6huAmjoGDPsWDRJieAKxPAzg=w2400",
      "price": 2400,
      "time": "4 hours",
      "chip": "Arduino Uno",
      "type": "ard",
      "applications": [
        "Proximity sensing",
        "Educational radar concept demonstration",
        "Visualizing sensor data over serial"
      ],
      "advantages": [
        "Integrating a servo motor for angular scanning.",
        "Mastering the HC-SR04 ultrasonic distance sensor.",
        "Using the Processing IDE for graphic data visualization."
      ],
      "features": [
        "Visual representation on PC screen",
        "Detects objects in a 180-degree range",
        "Uses ultrasonic sound waves for detection"
      ],
      "requirements": [
        "Arduino Uno board",
        "HC-SR04 ultrasonic sensor",
        "Servo motor",
        "Processing IDE installed on PC",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "HC-SR04 Ultrasonic Sensor",
        "Servo Motor (Actuator for scanning)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-3",
      "aiSummary": "A classic project that bridges **physical sensing and computer graphics**. The key learning is serial communication to transfer distance and angle data from Arduino to a desktop application (Processing) for real-time plotting."
    },
    {
      "id": "ard4",
      "name": "Home Security Alarm (PIR & GSM)",
      "theme": "Security & Cellular Communication",
      "aim": "To create a stand-alone security system that detects motion and immediately alerts the user via SMS text message.",
      "description": "Intrusion detection with PIR sensors and GSM alerts.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczPH1Ylq_UUsh0zo3Q_TWf7DuBNaJqbC0J0ftpRFfTjeCkmZC-dGyPaLrMnWnkTCwRnPa1j4Is_hX87ayGLNs0IU8yTkZ1CIruZyM_lvdHgrwiLfPyVQ=w2400",
      "price": 2800,
      "time": "5 hours",
      "chip": "Arduino + SIM800L",
      "type": "ard",
      "applications": [
        "Remote cabin security",
        "Basic home intrusion alarms",
        "SMS-based reporting systems"
      ],
      "advantages": [
        "Interfacing with the PIR passive infrared motion sensor.",
        "Sending SMS via the SIM800L GSM module (AT commands).",
        "Implementing low-power standby modes."
      ],
      "features": [
        "Motion detection",
        "Instant SMS alerts",
        "Alarm sound trigger"
      ],
      "requirements": [
        "Arduino Uno board",
        "PIR sensor",
        "SIM800L GSM module (requires SIM card)",
        "Buzzer",
        "Separate power supply for GSM module"
      ],
      "sensorsUsed": [
        "PIR Sensor (Motion)",
        "GSM Module (Communication)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-4",
      "aiSummary": "This robust project covers **motion detection and GSM communication**. You will learn how to reliably identify intrusion using the PIR sensor and send non-internet-dependent alerts via a cellular module."
    },
    {
      "id": "ard5",
      "name": "Digital Voltmeter",
      "theme": "Measurement & Display",
      "aim": "To accurately measure DC voltage across a specified range and display the result on an LCD screen.",
      "description": "Measure voltage from 0-30V with LCD display.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczMfS-R0cFMewGT9E48md13C2dcCzGlTDWkOf0PBUcWx79EqnSTlUObUIUuC6_-e-HGKyI39jcEB1MKFhDwsmMsqt4im25pimcQL_LEZzNKhivM-l1q=w2400",
      "price": 2200,
      "time": "2 hours",
      "chip": "Arduino Uno",
      "type": "ard",
      "applications": [
        "Basic electronics testing",
        "Power supply monitoring",
        "Battery level indicators"
      ],
      "advantages": [
        "Understanding voltage divider circuits for measurement.",
        "Mastering Analog-to-Digital Conversion (ADC) in Arduino.",
        "Interfacing with the LCD 16x2 display (I2C/Parallel)."
      ],
      "features": [
        "Measures DC voltage accurately",
        "LCD display for readings",
        "Simple calibration process"
      ],
      "requirements": [
        "Arduino Uno board",
        "LCD 16x2 Display (with optional I2C adapter)",
        "Resistors for Voltage divider circuit",
        "Breadboard and Jumper Wires"
      ],
      "sensorsUsed": [
        "Voltage Divider Circuit (External sensing mechanism)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-5",
      "aiSummary": "A fundamental electronics project focusing on **analog measurement and data presentation**. The core concept is creating a voltage divider to safely measure higher voltages and displaying the calculated value on an LCD."
    },
    {
      "id": "ard6",
      "name": "Smart Traffic Light System",
      "theme": "Logic & Sequential Control",
      "aim": "To simulate a functional, automated traffic light system with a sequence customizable for a pedestrian crossing.",
      "description": "Automated traffic light system with pedestrian crossing.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczO1gYL2YZaBq7v10UyxYe_PQLhEZ7z4Op3Xvf3vcy3vWRDvwwTsMprOK3emK5mE11CAygK9xA5v4Dblh-sQcGM7MExIwRYonYz6qiw6pUBrJ_IudGlo=w2400",
      "price": 1600,
      "time": "3 hours",
      "chip": "Arduino Uno",
      "type": "ard",
      "applications": [
        "Educational demonstration of control flow",
        "Model railroad/city automation",
        "Basic state machine implementation"
      ],
      "advantages": [
        "Implementing time-based state machines and control logic.",
        "Handling push-button interrupts or polling for pedestrian requests.",
        "Direct control of multiple LED outputs (digital I/O)."
      ],
      "features": [
        "Customizable timing sequence",
        "Pedestrian request button",
        "Clear LED indicators"
      ],
      "requirements": [
        "Arduino Uno board",
        "RGB LEDs or separate colored LEDs (Red, Yellow, Green)",
        "Push button",
        "Resistors",
        "Breadboard and Jumper Wires"
      ],
      "sensorsUsed": [
        "Push Button (Pedestrian request)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-6",
      "aiSummary": "This classic project is excellent for learning **sequential logic and state machine programming**. You will focus on creating reliable, timed sequences and managing an external input (the push button) to alter the flow."
    },
    {
      "id": "ard7",
      "name": "Voice Controlled Appliances",
      "theme": "Wireless Control & Human-Machine Interface",
      "aim": "To enable the control of household appliances using spoken commands routed through a smartphone and Bluetooth module.",
      "description": "Control room lights using voice commands via Bluetooth.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczOH-zP6-T444_fQvGh8IL5InzAb0kuCtiost4BKcLdSdbGUjFAKkn_wzY3nLPrbpQcrgYqTL-EggP8SoDed0mMfwbEiibAj6ItXXF9_1x0NFgDW_pV8=w2400",
      "price": 3200,
      "time": "3.5 hours",
      "chip": "Arduino + HC-05",
      "type": "ard",
      "applications": [
        "Accessibility control systems",
        "Home automation (hands-free)",
        "Voice command decoding"
      ],
      "advantages": [
        "Integrating voice recognition software on a host device (smartphone).",
        "Reliable UART communication between Arduino and HC-05.",
        "Implementing safety protocols for AC appliance control (Relay)."
      ],
      "features": [
        "Voice command processing on smartphone app",
        "Controls up to 4 appliances",
        "Uses Bluetooth for communication"
      ],
      "requirements": [
        "Arduino Uno board",
        "HC-05 Bluetooth module",
        "4-channel Relay module",
        "Smartphone with voice recognition app",
        "Jumper wires"
      ],
      "sensorsUsed": [
        "HC-05 Bluetooth Module (Receiver)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-7",
      "aiSummary": "Focuses on **wireless command parsing and human interface**. You learn to receive voice commands as simple strings via Bluetooth and trigger corresponding physical actions using relays."
    },
    {
      "id": "ard8",
      "name": "Laser Security System",
      "theme": "Intrusion Detection & Optics",
      "aim": "To build a simple, cost-effective perimeter security system using a laser tripwire and light-dependent resistor (LDR).",
      "description": "Create a laser tripwire security system with buzzer alarm.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczO9QWf-BNMVt8nPeSMNbHWXYSwD2Ong80c4rMxPsxwFV46v82rY91uzs3oxELaMqyDpX7EPaf1ijCmiRedxJ8ZpFqvO13EAEEoPyYwrH6-0MVHiwDon=w2400",
      "price": 1800,
      "time": "2 hours",
      "chip": "Arduino Uno",
      "type": "ard",
      "applications": [
        "DIY perimeter alarms",
        "Educational optics experiments",
        "Simple room monitoring"
      ],
      "advantages": [
        "Understanding how an LDR sensor works with varying light levels.",
        "Implementing adjustable threshold logic for 'beam broken' detection.",
        "Simple digital/analog input and output control."
      ],
      "features": [
        "Tripwire alarm logic",
        "Audible buzzer alert",
        "Adjustable sensitivity"
      ],
      "requirements": [
        "Arduino Uno board",
        "Laser Module",
        "LDR (Light Dependent Resistor) sensor",
        "Buzzer or LED",
        "Breadboard and Jumper Wires"
      ],
      "sensorsUsed": [
        "LDR (Light Dependent Resistor)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-8",
      "aiSummary": "A quick, introductory project on **light-based sensing and threshold setting**. The key is using the LDR to detect the presence or absence of the laser beam and triggering a simple alarm based on the light change."
    },
    {
      "id": "ard9",
      "name": "Obstacle Avoiding Robot",
      "theme": "Robotics & Autonomous Navigation",
      "aim": "To build an autonomous vehicle that can navigate an environment by sensing and avoiding physical obstacles in its path.",
      "description": "Build an autonomous vehicle that navigates around obstacles.",
      "image": "https://lh3.googleusercontent.com/pw/AP1GczPL836iWZCL6eReOPTAlj9IdrxBu7SsEbe_w_311P0GlHRgYGIddd6gVGOJ0_AGbEgLdX8lKtS4oSX_NCm6Lp74e22-hB16Ke7-vvmcDBGrd0zdkI8=w2400",
      "price": 4500,
      "time": "5 hours",
      "chip": "Arduino Nano",
      "type": "ard",
      "applications": [
        "Autonomous vacuum cleaners (simplified)",
        "Educational robot contests",
        "Introduction to navigation algorithms"
      ],
      "advantages": [
        "Combining sensor input (Ultrasonic) with actuator control (DC Motors).",
        "Implementing basic pathfinding algorithms (Sense, Decide, Act).",
        "Hands-on mechanical assembly of a mobile robot."
      ],
      "features": [
        "Autonomous navigation",
        "Uses ultrasonic sensor for obstacle detection",
        "Simple mechanical chassis"
      ],
      "requirements": [
        "Arduino Nano board",
        "HC-SR04 Ultrasonic sensor",
        "L298N motor driver",
        "DC motors (2)",
        "Wheels and Chassis kit",
        "Battery pack"
      ],
      "sensorsUsed": [
        "HC-SR04 Ultrasonic Sensor"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-9",
      "aiSummary": "The definitive **beginner robotics project**. You will integrate distance sensing and motor control to create a functional autonomous system, learning the fundamental 'Sense-Decide-Act' loop of robotics."
    },
    {
      "id": "ard10",
      "name": "GPS Tracker & Data Logger",
      "theme": "Geospatial Technology & Data Logging",
      "aim": "To create a portable device that logs its precise geographical coordinates and records the data for later analysis.",
      "description": "Location tracking device with data logging to SD card.",
      "image": "https://images.unsplash.com/photo-1581091226033-d5c48150dbaa?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80",
      "price": 4300,
      "time": "4 hours",
      "chip": "Arduino Mega",
      "type": "ard",
      "applications": [
        "Asset tracking",
        "Geocaching/hiking route logging",
        "Small drone telemetry"
      ],
      "advantages": [
        "Interfacing with a dedicated GPS module (NEO-6M) via UART.",
        "Parsing NMEA sentences to extract Lat/Lon data.",
        "Writing and managing data on an SD card file system."
      ],
      "features": [
        "Real-time latitude/longitude data",
        "Data logged to SD card for later analysis",
        "High accuracy GPS module"
      ],
      "requirements": [
        "Arduino Mega (recommended for extra UART ports)",
        "GPS Module (e.g., NEO-6M)",
        "SD Card module (and Micro SD card)",
        "Battery and power management",
        "Antenna (if separate)"
      ],
      "sensorsUsed": [
        "GPS Module (Location data)",
        "SD Card Module (Storage)"
      ],
      "buyLink": "https://forms.gle/buy-ard-kit-10",
      "aiSummary": "This advanced project focuses on **geospatial data acquisition and non-volatile storage**. You will learn to communicate with a GPS module and reliably log the complex location data onto an SD card."
    },
    
    {
      "id": "cse1",
      "name": "Online Book Store E-commerce Platform",
      "theme": "Full-Stack Web Development",
      "aim": "To develop a comprehensive, secure e-commerce website capable of handling user authentication, product catalog management, and payment processing.",
      "description": "A web-based bookstore with user authentication and payment integration.",
      "image": "https://placehold.co/400x300/1e3a8a/ffffff?text=Web+Store",
      "price": 3500,
      "time": "20 hours",
      "chip": "Web Development",
      "type": "cse",
      "applications": [
        "E-commerce websites",
        "Subscription services",
        "Inventory management platforms"
      ],
      "advantages": [
        "Full-stack development experience (Front-end, Back-end, Database).",
        "Implementing secure user authentication (JWT/Sessions).",
        "Integration with third-party APIs (Payment Gateways)."
      ],
      "features": [
        "User registration and login",
        "Book catalog with search filters",
        "Shopping cart functionality",
        "Secure payment gateway"
      ],
      "requirements": [
        "HTML, CSS, JavaScript (Front-end)",
        "React or Node.js (Back-end framework)",
        "Database (e.g., Firebase, MongoDB)",
        "Code Editor (VS Code recommended)",
        "Basic knowledge of REST APIs"
      ],
      "sensorsUsed": [
        "None (Software focus)"
      ],
      "buyLink": "https://forms.gle/buy-cse-kit-1",
      "aiSummary": "A robust **full-stack development** project that simulates a real-world e-commerce platform. The key learning is integrating multiple technologies (DB, Backend, Frontend) to manage product state and handle financial transactions securely."
    },
    {
      "id": "cse2",
      "name": "Image Recognition Application",
      "theme": "Machine Learning & Computer Vision",
      "aim": "To create a Python application that uses a pre-trained machine learning model to classify and identify objects within an uploaded image.",
      "description": "A Python-based app that identifies objects in an image using a pre-trained model.",
      "image": "https://placehold.co/400x300/065f46/ffffff?text=AI+Recognition",
      "price": 4000,
      "time": "15 hours",
      "chip": "Machine Learning",
      "type": "cse",
      "applications": [
        "Automated image tagging",
        "Quality control in manufacturing",
        "Search engine optimization"
      ],
      "advantages": [
        "Loading and using a pre-trained Deep Learning model (e.g., ResNet).",
        "Image preprocessing techniques (resizing, normalization).",
        "Exposing ML models via a web service (Flask)."
      ],
      "features": [
        "Upload and analyze images",
        "Provides a list of recognized objects and confidence scores",
        "Simple and intuitive UI"
      ],
      "requirements": [
        "Python 3.x",
        "TensorFlow or PyTorch framework",
        "Flask or Django (for web interface)",
        "Relevant image data set for testing",
        "Code Editor and Command Line interface"
      ],
      "sensorsUsed": [
        "None (Software focus)"
      ],
      "buyLink": "https://forms.gle/buy-cse-kit-2",
      "aiSummary": "This project is an excellent introduction to **applied Machine Learning**. You will learn how to integrate powerful computer vision models into a practical Python application to recognize and classify real-world objects."
    },
    {
      "id": "cse3",
      "name": "Real-time Chat Application",
      "theme": "Network Programming & Real-time Communication",
      "aim": "To build a multi-user communication platform that supports instant message delivery and real-time user presence updates.",
      "description": "A multi-user chat application with real-time messaging and user presence.",
      "image": "https://placehold.co/400x300/4a044e/ffffff?text=Realtime+Chat",
      "price": 18000,
      "time": "18 hours",
      "chip": "WebSockets",
      "type": "cse",
      "applications": [
        "Instant messaging services",
        "Multiplayer game lobbies",
        "Live stock market tickers"
      ],
      "advantages": [
        "Mastering WebSocket protocol for persistent, bidirectional communication.",
        "Managing multiple concurrent user connections on the server.",
        "Implementing message broadcasting and user presence logic."
      ],
      "features": [
        "Instant messaging",
        "User online/offline status",
        "Message history",
        "User authentication"
      ],
      "requirements": [
        "Node.js and Express.js (Back-end)",
        "Socket.io library (for WebSockets)",
        "HTML/CSS/JS (Front-end)",
        "Basic database (for history)",
        "Code Editor"
      ],
      "sensorsUsed": [
        "None (Software focus)"
      ],
      "buyLink": "https://forms.gle/buy-cse-kit-3",
      "aiSummary": "A crucial **network programming project**. The focus is on implementing the WebSocket protocol using Socket.io to achieve true low-latency, real-time interactivity essential for modern web applications."
    }
  ];
            // --- END Consolidated Project Data ---

            
            function renderProjects(filter = 'all') {
                projectsGrid.innerHTML = '';
                const allProjects = projectsList;
                let filteredProjects;
                if (filter === 'iot') {
                    filteredProjects = allProjects.filter(p => p.type === 'iot');
                } else if (filter === 'arduino') {
                    filteredProjects = allProjects.filter(p => p.type === 'arduino');
                } else if (filter === 'cse') {
                    filteredProjects = allProjects.filter(p => p.type === 'cse');
                } else {
                    filteredProjects = allProjects;
                }

                filteredProjects.forEach(p => {
                    const projectType = p.type;
                    const tagClass = projectType === 'iot' ? 'bg-secondary' : (projectType === 'arduino' ? 'bg-accent' : 'bg-green-500');
                    const tagText = projectType === 'iot' ? 'IoT' : (projectType === 'arduino' ? 'Arduino' : 'CSE');

                    // NOTE: Project card must contain the project ID to track completion (mock project IDs used for simplicity)
                    const conceptId = p.id;
                    const completedClass = userProgress[conceptId] ? 'border-green-500 ring-2 ring-green-500' : 'border-secondary/50';

                    projectsGrid.innerHTML += `
                        <div class="project-card card-3d glassmorphism p-6 rounded-lg overflow-hidden neon-border cursor-pointer relative ${completedClass}" 
                             data-project-type="${projectType}" 
                             data-id="${p.id}" 
                             data-price="${p.price}" 
                             data-name="${p.name}" 
                             data-image="${p.image}"
                             data-description="${p.description}"
                             data-time="${p.time}"
                             data-chip="${p.chip}"
                             data-concept-id="${conceptId}"
                             data-theme="${p.theme}"
                             data-aim="${p.aim}"
                             data-features='${JSON.stringify(p.features)}'
                             data-applications='${JSON.stringify(p.applications)}'
                             data-advantages='${JSON.stringify(p.advantages)}'
                             data-requirements='${JSON.stringify(p.requirements)}'
                             data-sensors='${JSON.stringify(p.sensorsUsed)}'
                             data-buy-link="${p.buyLink}"
                             data-ai-summary="${p.aiSummary || 'No intelligent summary available for this project yet.'}">
                            <div class="absolute top-3 right-3 ${tagClass} text-white text-xs font-bold px-3 py-1 rounded-lg z-10">${tagText}</div>
                            <img src="${p.image}" alt="${p.name}" class="rounded-lg w-full h-48 object-cover transition-transform duration-500 hover:scale-110">
                            <div class="mt-4">
                                <h3 class="font-orbitron text-2xl font-bold text-white">${p.name}</h3>
                                <p class="text-gray-400 mt-2 text-sm">${p.description.substring(0, 100)}...</p>
                                <div class="text-2xl font-bold font-orbitron text-accent mt-4">₹${p.price}</div>
                                <button class="add-to-cart-btn btn-3d btn-primary-action btn-box mt-4">Add to Cart</button>
                                
                                <div class="project-meta flex justify-between text-sm text-gray-400 mt-4 border-t border-border-color pt-2">
                                    <span><i class="fas fa-clock text-secondary mr-1"></i> ${p.time}</span>
                                    <span><i class="fas fa-microchip text-secondary mr-1"></i> ${p.chip}</span>
                                </div>
                            </div>
                        </div>`;
                });
                
                document.querySelectorAll('.project-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        // Check if the click was on the cart button, if so, do nothing here
                        if (e.target.classList.contains('add-to-cart-btn')) {
                            return;
                        }
                        const data = card.dataset;
                        const defaultError = '<li>Data not specified.</li>';
                        
                        // Set the current project ID for TechWhiz button
                        askTechwhizDetailBtn.dataset.projectId = data.id;
                        askTechwhizDetailBtnTab.dataset.projectId = data.id;


                        // --- CRITICAL FIX: AGGRESSIVELY FORCE-CLOSE ALL OTHER MODALS AND CLEAR DISPLAY STATE ---
                        // Ensure all modals are closed before opening the project detail modal
                        if (profileModal) profileModal.style.display = 'none';
                        if (authModal) authModal.style.display = 'none';
                        if (cartModal) cartModal.classList.remove('open');
                        if (componentDetailModal) componentDetailModal.style.display = 'none';
                        if (orderHistoryModal) orderHistoryModal.style.display = 'none';
                        if (techwhizModal) techwhizModal.style.display = 'none';
                        // --- END FIX ---

                        // Clear previous content and hide sections
                        projectDetailFeatures.innerHTML = '';
                        projectDetailComponents.innerHTML = '';
                        projectDetailApplications.innerHTML = '';
                        projectDetailAdvantages.innerHTML = '';
                        projectDetailAim.textContent = 'N/A'; // Clear Aim
                        projectDetailThemeValue.textContent = 'N/A'; // Clear Theme
                        projectDetailSensorsUsed.innerHTML = '';
                        projectSensorView.classList.add('hidden'); 
                        
                        // Reset AI Summary view
                        aiSummaryContainer.classList.add('hidden'); 
                        aiSummaryText.textContent = 'Click the button above for an intelligent summary...'; 
                        aiSummaryBtn.dataset.summaryText = data.aiSummary;
                        
                        // Set Core Details
                        projectDetailTitle.textContent = data.name;
                        projectDetailImage.src = data.image;
                        projectDetailDescription.textContent = data.description;
                        projectDetailTime.innerHTML = `<i class="fas fa-clock text-secondary"></i> ${data.time}`;
                        projectDetailChip.innerHTML = `<i class="fas fa-microchip text-secondary"></i> ${data.chip}`;
                        projectDetailAim.textContent = data.aim || 'Project aim not explicitly defined.'; // NEW AIM
                        projectDetailThemeValue.textContent = data.theme || 'General'; // NEW THEME

                        
                        // --- FIX: ROBUST JSON PARSING FOR PROJECT LISTS ---
                        const listSections = {
                            applications: projectDetailApplications,
                            advantages: projectDetailAdvantages,
                            features: projectDetailFeatures,
                            requirements: projectDetailComponents,
                            sensors: projectDetailSensorsUsed 
                        };

                        for (const key in listSections) {
                            try {
                                const listData = data[key] ? JSON.parse(data[key]) : [];
                                
                                // Check if listData is an array and has content
                                if (Array.isArray(listData) && listData.length > 0) {
                                    // If it's the sensors list, use the special tag formatting
                                    if (key === 'sensors') {
                                         // The sensor rendering logic is slightly different (pills, not list items)
                                         listSections[key].innerHTML = listData.map(s => 
                                            `<li class="bg-accent/20 text-accent font-semibold px-3 py-1 rounded-full text-sm flex items-center">
                                                <i class="fas fa-cube mr-2"></i> ${s}
                                             </li>`
                                        ).join('');
                                    } else {
                                        // Standard list item formatting
                                        listSections[key].innerHTML = listData.map(item => `<li>${item}</li>`).join('');
                                    }
                                } else {
                                    // Handle cases where the array is empty or null
                                    listSections[key].innerHTML = defaultError;
                                }
                            } catch (error) {
                                // This catches JSON parsing errors and outputs to console
                                console.error(`E-TECH DATA ERROR: Failed to parse project data for key: ${key}`, error);
                                // Display a clear error message on the UI element
                                listSections[key].innerHTML = '<li>Error: Failed to load list data.</li>';
                            }
                        }
                        
                        // Special handling for sensors visibility
                        const sensorsList = JSON.parse(data.sensors);
                        if (sensorsList && sensorsList.length > 0 && sensorsList[0] !== 'None (Actuator focus)') {
                            projectSensorView.classList.remove('hidden');
                        } else {
                            projectSensorView.classList.add('hidden');
                        }
                        // --- END FIX ---
                        
                        // Set data for action buttons
                        addToCartFromDetailBtn.dataset.id = data.id;
                        addToCartFromDetailBtn.dataset.name = data.name;
                        addToCartFromDetailBtn.dataset.price = data.price;
                        addToCartFromDetailBtn.dataset.image = data.image;
                        
                        // Set Buy Now Link
                        buyNowFromDetailBtn.href = data.buyLink;
                        
                        // Reset to the first tab (Details & Aim)
                        activateProjectDetailTab(document.querySelector('.project-detail-tabs button[data-tab-target="#tab-details"]'));

                        // Show the modal immediately (FIX: This is the critical line to show the modal)
                        projectDetailModal.style.display = 'flex';
                    });
                });
                
                document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const card = e.target.closest('.project-card');
                        const price = parseFloat(card.dataset.price);
                        addToCart(card.dataset.id, card.dataset.name, price, card.dataset.image);
                        e.stopPropagation();
                    });
                });
                
                // Re-render KaTeX after injecting new HTML content
                if (window.renderMathInElement) {
                    renderMathInElement(projectsGrid);
                }
            }
            
            // NEW: Project Detail Tab Logic
            function activateProjectDetailTab(clickedButton) {
                // Deactivate all buttons and hide all content
                projectDetailTabBtns.forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('[data-tab-content]').forEach(content => content.classList.add('hidden'));
                
                // Activate the clicked button
                clickedButton.classList.add('active');
                
                // Show the target content
                const targetId = clickedButton.dataset.tabTarget;
                const targetContent = document.querySelector(targetId);
                if (targetContent) {
                    targetContent.classList.remove('hidden');
                }
            }

            projectDetailTabBtns.forEach(button => {
                button.addEventListener('click', () => activateProjectDetailTab(button));
            });

            // NEW: AI Summary Button Handler
            aiSummaryBtn.addEventListener('click', () => {
                const summaryText = aiSummaryBtn.dataset.summaryText;
                
                if (summaryText) {
                    // Simulate loading state
                    aiSummaryText.textContent = "Generating intelligent summary... one moment...";
                    aiSummaryContainer.classList.remove('hidden');

                    // Simulate API response delay (using setTimeout instead of actual API call for demo speed)
                    setTimeout(() => {
                        aiSummaryText.textContent = summaryText;
                    }, 800); 

                } else {
                    aiSummaryText.textContent = "No detailed AI summary available for this project.";
                    aiSummaryContainer.classList.remove('hidden');
                }
            });
            
            // NEW: Ask TechWhiz button handler inside the Project Detail Modal
            const askTechwhizProjectHandler = (e) => {
                const projectId = e.currentTarget.dataset.projectId;
                const project = projectsList.find(p => p.id === projectId);
                
                if (!project) return;
                
                const prompt = `Tell me more about the project, "${project.name}", specifically focusing on its main theme, purpose (aim), and unique features. Assume I am a student ready to start building it.`;
                
                // Close project modal and open TechWhiz modal
                projectDetailModal.style.display = 'none';
                techwhizModal.style.display = 'flex';
                
                // Inject prompt into chat input and trigger submission
                techwhizInput.value = prompt;
                sendBtn.click();
            };

            askTechwhizDetailBtn.addEventListener('click', askTechwhizProjectHandler);
            askTechwhizDetailBtnTab.addEventListener('click', askTechwhizProjectHandler); // Tab bar click should also trigger this
            
            // FIX: Close Modal Functionality (Ensuring this still works)
            closeProjectDetailBtn.addEventListener('click', () => {
                projectDetailModal.style.display = 'none';
            });
            
            // Close modal when clicking outside of the content area
            projectDetailModal.addEventListener('click', (e) => {
                // Only close if the click target is the modal overlay itself
                if (e.target === projectDetailModal) {
                    projectDetailModal.style.display = 'none';
                }
            });


            // --- Consolidated Function to Apply Filter and Update UI (Addressing User's Filter Issue) ---
            function applyProjectFilter(filter) {
                // 1. Update Active State UI for buttons
                document.querySelectorAll('.filter-btn').forEach(b => {
                    b.classList.remove('bg-secondary', 'hover:bg-accent');
                    // Ensure the default look is applied before checking for active state
                    b.classList.add('bg-gray-800', 'hover:bg-secondary'); 

                    if (b.dataset.filter === filter) {
                        // Apply active styling
                        b.classList.add('bg-secondary', 'hover:bg-accent');
                        b.classList.remove('bg-gray-800', 'hover:bg-secondary');
                    }
                });

                // 2. Render the filtered projects
                renderProjects(filter);
            }
            
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    applyProjectFilter(btn.dataset.filter);
                });
            });
            // --- END NEW: Consolidated Filter Function ---


            // --- Cart Logic Implementation (Unchanged) ---
            async function addToCart(id, name, price, image) {
                // Check Inventory (Mock Firestore check)
                try {
                    const inventoryRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('inventory').doc(id);
                    const doc = await inventoryRef.get();
                    let currentStock = 10; // Default mock stock
                    
                    if (doc.exists) {
                        currentStock = doc.data().stock;
                    } 
                    // To simulate low/zero stock for testing:
                    if (id === 'iot2') { currentStock = 0; } // Mock Sold Out for Weather Station

                    const existingItem = cart.find(item => item.id === id);
                    const quantityInCart = existingItem ? existingItem.quantity : 0;
                    
                    if (quantityInCart >= currentStock && currentStock > 0) {
                         showToast(`${name} is low stock! Max ${currentStock} allowed.`, 'accent');
                         return;
                    }
                    
                    if (currentStock <= 0) {
                         showToast(`${name} is currently Sold Out.`, 'accent');
                         return;
                    }

                    if (existingItem) {
                        existingItem.quantity++;
                    } else {
                        cart.push({ id, name, price, image, quantity: 1, maxStock: currentStock });
                    }
                    updateCart();
                    showToast(`${name} added to cart!`);

                } catch (error) {
                    console.error("Error checking inventory: ", error);
                    showToast(`Inventory check failed. Adding to cart anyway.`, 'secondary');
                    
                    // Fallback to adding without inventory check
                    const existingItem = cart.find(item => item.id === id);
                    if (existingItem) {
                        existingItem.quantity++;
                    } else {
                        cart.push({ id, name, price, image, quantity: 1 });
                    }
                    updateCart();
                }
            }
            
            function changeCartQuantity(id, change) {
                const item = cart.find(item => item.id === id);
                if (item) {
                    const newQuantity = item.quantity + change;
                    
                    if (newQuantity <= 0) {
                        removeFromCart(id);
                        return;
                    }
                    
                    // Check max stock if available
                    if (item.maxStock !== undefined && newQuantity > item.maxStock) {
                        showToast(`Max stock reached for ${item.name}!`, 'accent');
                        return;
                    }
                    
                    item.quantity = newQuantity;
                    updateCart();
                }
            }

            function removeFromCart(id) {
                const itemIndex = cart.findIndex(item => item.id === id);
                if (itemIndex > -1) {
                    cart.splice(itemIndex, 1);
                    showToast(`Item removed from cart.`, 'accent');
                }
                updateCart();
            }

            function updateCart() {
                cartModalItemsContainer.innerHTML = '';
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                
                cartCountElement.textContent = totalItems;
                cartItemCountHeader.textContent = totalItems;

                if (cart.length === 0) {
                    cartModalItemsContainer.innerHTML = '<p class="cart-empty-msg text-gray-400 text-center p-8">Your cart is currently empty. Start exploring projects!</p>';
                    cartCheckoutBtn.disabled = true;
                    cartCheckoutBtn.classList.remove('btn-primary-action', 'hover:bg-secondary'); // Use new classes
                    cartCheckoutBtn.classList.add('bg-gray-700', 'cursor-not-allowed');
                } else {
                    cartCheckoutBtn.disabled = false;
                    cartCheckoutBtn.classList.add('btn-primary-action', 'hover:bg-secondary'); // Use new classes
                    cartCheckoutBtn.classList.remove('bg-gray-700', 'cursor-not-allowed');

                    cart.forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.classList.add('cart-modal-item');
                        itemElement.innerHTML = `
                            <img src="${item.image}" alt="${item.name}" class="w-12 h-12 object-cover rounded-lg mr-4 border border-secondary/50">
                            <div class="flex-1">
                                <h4 class="font-bold text-white">${item.name}</h4>
                                <div class="flex items-center space-x-2 mt-1">
                                    <span class="text-sm text-gray-400">Qty:</span>
                                    <div class="cart-controls flex items-center">
                                        <button class="qty-minus" data-id="${item.id}" data-change="-1">-</button>
                                        <span class="px-2 text-white">${item.quantity}</span>
                                        <button class="qty-plus" data-id="${item.id}" data-change="1">+</button>
                                    </div>
                                </div>
                            </div>
                            <div class="text-lg font-orbitron text-accent mr-4">₹${(item.price * item.quantity).toFixed(0)}</div>
                            <button class="cart-item-remove text-gray-500 hover:text-accent text-xl transition-colors" data-id="${item.id}">&times;</button>
                        `;
                        itemElement.querySelector('.cart-item-remove').addEventListener('click', (e) => removeFromCart(e.target.dataset.id));
                        itemElement.querySelector('.qty-minus').addEventListener('click', (e) => changeCartQuantity(e.target.dataset.id, -1));
                        itemElement.querySelector('.qty-plus').addEventListener('click', (e) => changeCartQuantity(e.target.dataset.id, 1));
                        cartModalItemsContainer.appendChild(itemElement);
                    });
                }
                const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
                cartTotalPriceElement.textContent = `₹${total}`;
            }
            
            function showToast(message, color = 'secondary') {
                const toast = document.createElement('div');
                toast.textContent = message;
                toast.style.cssText = `
                    position: fixed; 
                    top: 20px; 
                    left: 50%; 
                    transform: translateX(-50%); 
                    background: var(--${color}); 
                    color: white; 
                    padding: 10px 20px; 
                    border-radius: 8px; 
                    z-index: 9999; 
                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
                    font-family: 'Orbitron', sans-serif;
                    opacity: 0;
                    transition: opacity 0.5s ease-in-out;
                `;
                document.body.appendChild(toast);
                setTimeout(() => { toast.style.opacity = 1; }, 10);
                setTimeout(() => { toast.style.opacity = 0; }, 2500);
                setTimeout(() => toast.remove(), 3000);
            }

            cartFab.addEventListener('click', () => cartModal.classList.toggle('open'));
            closeCartBtn.addEventListener('click', () => cartModal.classList.remove('open'));

            addToCartFromDetailBtn.addEventListener('click', () => {
                const id = addToCartFromDetailBtn.dataset.id;
                const name = addToCartFromDetailBtn.dataset.name;
                const price = parseFloat(addToCartFromDetailBtn.dataset.price);
                const image = addToCartFromDetailBtn.dataset.image;
                addToCart(id, name, price, image);
                projectDetailModal.style.display = 'none';
            });
            
            // NOTE: The 'Buy Kit Now' button uses the `buyLink` data attribute
            // and opens it in a new tab for an immediate purchase flow.
            buyNowFromDetailBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const link = buyNowFromDetailBtn.getAttribute('href');
                if (link) {
                    window.open(link, '_blank');
                } else {
                    showToast("No direct purchase link available for this project yet.", 'accent');
                }
            });


            cartCheckoutBtn.addEventListener('click', () => {
                const totalAmount = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
                if (totalAmount === 0) {
                    showToast("Your cart is empty!", 'accent');
                    return;
                }
                if (!auth.currentUser) {
                    showToast("Please login to proceed to checkout.", 'accent');
                    authModal.style.display = 'flex'; // Use flex to match modal-overlay-center
                    return;
                }
                const options = {
                    key: "rzp_live_4cpkH5xviXonf3",
                    amount: totalAmount * 100,
                    currency: "INR",
                    name: "E-TECH SOLUTIONS",
                    description: "Project Purchase",
                    image: "https://lh3.googleusercontent.com/pw/AP1GczMFGvwVU32NSsKv5V5pVdolG2i9-eEUBOupJmE6wvE5hKb08fmmPauG62OnGUmD0esm9pa-d285g6XBzAxuULCghMe8Obxi1mUTI3LcaMuGB0IJz-5-=w2400",
                    handler: (response) => {
                        const orderData = {
                            userId: auth.currentUser.uid,
                            orderId: response.razorpay_payment_id,
                            items: JSON.stringify(cart),
                            totalAmount: totalAmount,
                            timestamp: firebase.firestore.FieldValue.serverTimestamp()
                        };
                        
                        const userId = auth.currentUser?.uid || crypto.randomUUID();
                        db.collection(`artifacts/${appId}/users/${userId}/orders`).add(orderData)
                            .then(() => {
                                showToast(`Payment Successful! Order ID: ${response.razorpay_payment_id}`, 'secondary');
                                cart = [];
                                updateCart();
                                cartModal.classList.remove('open');
                            })
                            .catch((error) => {
                                console.error("Error adding document: ", error);
                                showToast("Error saving order details.", 'accent');
                            });
                    },
                    prefill: { name: auth.currentUser.displayName, email: auth.currentUser.email },
                    theme: { color: "#00e5ff" }
                };
                const rzp = new Razorpay(options);
                rzp.on('payment.failed', (response) => {
                    showToast(`Payment Failed: ${response.error.description}`, 'accent');
                });
                rzp.open();
            });

            // --- Order History Logic (Unchanged) ---
            orderHistoryBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (auth.currentUser) {
                    fetchOrderHistory(auth.currentUser.uid);
                } else {
                    authModal.style.display = 'flex';
                }
            });

            closeHistoryBtn.addEventListener('click', () => {
                orderHistoryModal.style.display = 'none';
            });

            async function fetchOrderHistory(currentUserId) {
                orderHistoryList.innerHTML = '<p class="text-center text-gray-500">Loading order history...</p>';
                orderHistoryModal.style.display = 'flex';
                try {
                    const querySnapshot = await db.collection(`artifacts/${appId}/users/${currentUserId}/orders`)
                        .orderBy("timestamp", "desc")
                        .get();
                    
                    if (querySnapshot.empty) {
                        orderHistoryList.innerHTML = '<p class="text-center text-gray-400">You have no past orders.</p>';
                        return;
                    }

                    let ordersHtml = '';
                    querySnapshot.forEach(doc => {
                        const order = doc.data();
                        const orderDate = order.timestamp ? new Date(order.timestamp.seconds * 1000).toLocaleString() : 'Date not available';
                        
                        let itemsHtml = '<ul class="list-disc ml-6 text-gray-400 text-sm">';
                        const items = JSON.parse(order.items);
                        items.forEach(item => {
                            itemsHtml += `<li>${item.name} (x${item.quantity}) - ₹${item.price}</li>`;
                        });
                        itemsHtml += '</ul>';

                        ordersHtml += `
                            <div class="glassmorphism p-4 rounded-lg neon-border mb-4 border-secondary/50">
                                <div class="flex justify-between items-center text-sm mb-2 text-gray-500">
                                    <span>${orderDate}</span>
                                    <span class="truncate ml-2">ID: ${order.orderId.substring(0, 10)}...</span>
                                </div>
                                ${itemsHtml}
                                <div class="text-right font-bold mt-2 text-secondary">
                                    Total: ₹${order.totalAmount}
                                </div>
                            </div>
                        `;
                    });
                    orderHistoryList.innerHTML = ordersHtml;

                } catch (error) {
                    console.error("Error fetching order history: ", error);
                    orderHistoryList.innerHTML = '<p class="text-center text-accent">Could not load order history. Please try again later.</p>';
                }
            }


            // --- Parallax Scrolling Effect (Unchanged) ---
            const sections = document.querySelectorAll('.section');
            window.addEventListener('scroll', () => {
                const scrollTop = window.pageYOffset;
                sections.forEach(section => {
                    const rect = section.getBoundingClientRect();
                    const offset = rect.top + scrollTop;
                    const parallaxFactor = (scrollTop - offset) * 0.05;
                    section.style.transform = `translateY(${parallaxFactor}px)`;
                });
            });
            
            // --- NEW: Scroll-to-Hide Header Logic ---
            let lastScrollTop = 0;
            const scrollThreshold = 50; 
            
            window.addEventListener('scroll', () => {
                const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                // Only hide/show if the scroll movement is significant and the mobile menu is closed
                if (window.innerWidth <= 768 && !navMenu.classList.contains('active')) {
                    if (currentScrollTop > lastScrollTop && currentScrollTop > scrollThreshold) {
                        // Scrolling down
                        mainHeader.classList.add('header-hidden');
                    } else if (currentScrollTop < lastScrollTop) {
                        // Scrolling up
                        mainHeader.classList.remove('header-hidden');
                    }
                } else if (window.innerWidth > 768) {
                    // Always show header on desktop
                    mainHeader.classList.remove('header-hidden');
                }
                
                lastScrollTop = currentScrollTop <= 0 ? 0 : currentScrollTop; // For Mobile or negative scrolling
            });

            // --- Mobile Menu Toggle and Auto-Hide Logic (Modified) ---
            mobileToggle.addEventListener('click', () => navMenu.classList.toggle('active'));

            // Auto-hide when a link is clicked (on mobile only)
            mobileNavLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 768) {
                        navMenu.classList.remove('active');
                        // Ensure header becomes visible if navigation is used
                        mainHeader.classList.remove('header-hidden'); 
                    }
                });
            });

            // --- Auth Modal Logic (Unchanged) ---
            // NOTE: Changing classList.remove/add('hidden') to element.style.display for centering consistency
            loginBtnNav.addEventListener('click', (e) => { e.preventDefault(); authModal.style.display = 'flex'; });
            closeAuthBtn.addEventListener('click', () => authModal.style.display = 'none');
            window.addEventListener('click', (e) => { if (e.target == authModal) authModal.style.display = 'none'; });
            authTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    authTabs.forEach(item => item.classList.remove('active', 'text-secondary'));
                    tab.classList.add('active', 'text-secondary');
                    authForms.forEach(form => form.classList.add('hidden'));
                    document.getElementById(tab.dataset.tab + '-form').classList.remove('hidden');
                });
            });
            
            // --- FIX: Google Sign-In Function using signInWithRedirect (Unchanged) ---
            googleLoginBtn.addEventListener('click', async (e) => {
                e.preventDefault();
                const provider = new firebase.auth.GoogleAuthProvider();
                try {
                    // Use signInWithRedirect instead of signInWithPopup to avoid environment security restrictions
                    await auth.signInWithRedirect(provider); 
                    // Note: Execution stops here as the page redirects.
                } catch (error) {
                    console.error("Google Sign-In Error (Pre-Redirect):", error);
                    showToast(`Google Sign-In Failed: ${error.message.split(' (')[0]}`, 'accent');
                }
            });
            // --- END FIX: Google Sign-In Function ---

            // --- Firebase Auth Listener & Profile Setup (Unchanged) ---
            auth.onAuthStateChanged(user => {
                if (user) {
                    userId = user.uid;
                    loginBtnNav.classList.add('hidden');
                    userStatus.classList.remove('hidden');
                    userName.textContent = user.displayName || user.email;
                    userAvatar.textContent = (user.displayName || user.email).charAt(0).toUpperCase();
                    
                    // Set up Firestore listener for the current user's progress
                    setupProgressListener(user.uid);
                    // document.getElementById('skill-tree-status').textContent = "Double-click a node to mark as complete/incomplete!";
                    // suggestionsSidebar.classList.remove('opacity-50', 'pointer-events-none');
                } else {
                    userId = null;
                    loginBtnNav.classList.remove('hidden');
                    userStatus.classList.add('hidden');
                    setupProgressListener(null); // Stop listener and clear progress
                    // document.getElementById('skill-tree-status').textContent = "Log in to view your personalized progress.";
                    // suggestionsSidebar.classList.add('opacity-50', 'pointer-events-none');
                }
            });
            
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                auth.signInWithEmailAndPassword(loginForm['login-email'].value, loginForm['login-password'].value)
                    .then(() => { 
                        authModal.style.display = 'none'; 
                    })
                    .catch(error => console.error(error.message));
            });

            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                auth.createUserWithEmailAndPassword(registerForm['register-email'].value, registerForm['register-password'].value)
                    .then(cred => cred.user.updateProfile({ displayName: registerForm['register-name'].value }))
                    .then(() => { 
                        authModal.style.display = 'none'; 
                    })
                    .catch(error => console.error(error.message));
            });
            
            // Update the general logout button and add profile modal logic
            logoutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                auth.signOut().then(() => {
                    profileModal.style.display = 'none';
                    showToast("Signed out successfully.");
                });
            });
            profileLogoutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                auth.signOut().then(() => {
                    profileModal.style.display = 'none';
                    showToast("Signed out successfully.");
                });
            });

            // --- Profile Modal Logic (Unchanged) ---
            userAvatar.addEventListener('click', () => {
                const user = auth.currentUser;
                if (!user) return;
                
                profileDisplayName.textContent = user.displayName || 'N/A';
                profileEmail.textContent = user.email || 'N/A';
                profileUserId.textContent = user.uid;
                
                profileModal.style.display = 'flex';
            });

            closeProfileBtn.addEventListener('click', () => profileModal.style.display = 'none');

            editProfileBtn.addEventListener('click', () => {
                 const newName = prompt("Enter your new display name:");
                 if (newName && newName.trim()) {
                     auth.currentUser.updateProfile({ displayName: newName.trim() })
                        .then(() => {
                            showToast("Display name updated!", 'secondary');
                            profileDisplayName.textContent = newName.trim();
                            userName.textContent = newName.trim();
                            userAvatar.textContent = newName.trim().charAt(0).toUpperCase();
                        })
                        .catch(error => showToast(`Error updating name: ${error.message}`, 'accent'));
                 }
            });

            // --- START: Component Data Source (Expanded Content) ---
            const componentsData = {
                resistor: { 
                    title: "Resistor", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczM5DWsnmgZvpw6xGHEEEktIuWpG_2IgRAkg3UqDhJhLkhTGR-qN4sKz5KJGk59I7DljumSSSTUMvkmU1TBUu0ZcFo8Px9_2-Lbc3U5aFi3EHs1lw4w=w2400", 
                    definition: "A resistor is a passive two-terminal electrical component that implements electrical resistance as a circuit element. It opposes the flow of electric current.", 
                    symbol: "American-style: zigzag line (\\text{⏚}), International Standard: rectangular box (\\text{□}).", 
                    characteristics: ["Opposes the flow of electric current", "Measured in Ohms (\\Omega)", "Power rating determines how much heat it can dissipate", "Available in fixed and variable (potentiometer) types"], 
                    applications: "Used to reduce current flow, adjust signal levels, divide voltages, and terminate transmission lines." 
                },
                capacitor: { 
                    title: "Capacitor", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPIFWmSYlWVRR-_NyU_lEwCq2w6eiT4qLNVR0t6j_u3RJsQZ6gsJrlvSoMxB40_CnLlRBGS3lqfD2bFnKJYJAGAjpgmhxUOsyJHt9IEEeBaY3VSJ3M=w2400", 
                    definition: "A capacitor is a device that stores electrical energy in an electric field by accumulating electric charges on two closely spaced surfaces that are insulated from each other.", 
                    symbol: "Two parallel lines (\\text{||}).", 
                    characteristics: ["Stores electrical energy", "Measured in Farads (F)", "Voltage rating", "Equivalent series resistance (ESR)", "Polarity (for electrolytic capacitors)"], 
                    applications: "Energy storage, power conditioning, signal coupling, noise filtering, and timing circuits." 
                },
                inductor: {
                    title: "Inductor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOKm6h3B8Y1XzU1Qo5FjM2Yd7D2H2w2Qh7v4e2Z2Zl9v0h2W2F6H2o0Z_v9w_20e4o2k5A1H8j1o7e8k-5y5y5o2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "An inductor, also known as a coil or choke, is a passive two-terminal electrical component that stores energy in a magnetic field when electric current flows through it.",
                    symbol: "Series of curved lines (\\text{∿})",
                    characteristics: ["Stores energy in a magnetic field", "Measured in Henries (H)", "Opposes changes in current"],
                    applications: "Used in AC power supplies, filters, transformers, and resonant circuits."
                },
                diode: { 
                    title: "Diode", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPIGgW9jnLCV_xkerbMAlFm4i22hiFNcMnGwhHzJhlOkd47lhbaSlq3AMgDvUFJ-JebDt2yAabU__TTkfLRHcJgUjDNO4iAhQMgPjOfKvCuYjHWniA=w2400", 
                    definition: "A diode is a semiconductor device that essentially acts as a one-way switch for current. It allows current to flow easily in one direction but severely restricts it in the opposite direction.", 
                    symbol: "A triangle pointing towards a vertical line (\\text{➡️|}).", 
                    characteristics: ["Allows current to flow in one direction only", "Forward voltage drop (typically 0.7V for silicon diodes)", "Reverse breakdown voltage"], 
                    applications: "Rectification (converting AC to DC), voltage regulation (Zener diodes), signal demodulation, over-voltage protection, and light emission (LEDs)." 
                },
                transistor: { 
                    title: "Transistor", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOmfnJTs0Ee3i2ff3Sgp1_z5Egi40fXXU_ROMRHsj2U-TW8rJMg4VPMTmjk6_2UXYLotzUnwz-9FWZd0fXazbzeaRKIywkFrNYH11AmsmLdikoPzUA=w2400", 
                    definition: "A transistor is a semiconductor device used to amplify or switch electronic signals and electrical power.", 
                    symbol: "For NPN: Arrow pointing out from the base, for PNP: Arrow pointing toward the base.", 
                    characteristics: ["Three terminals: emitter, base, and collector", "Current gain (\\beta)", "Maximum voltage and current ratings", "Switching speed"], 
                    applications: "Amplifiers, electronic switches, digital logic gates, voltage regulators, and oscillators." 
                },
                ic: {
                    title: "Integrated Circuit (IC)",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczODx-Vv2K4k5h7v-M_5r3l4p9Q4p5-p5f4a7j1Q1d5f3j1o8f5k-e8t-d6f7l2-k7p8p9t3f3t6a7r4s5o2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "An integrated circuit (IC) is a miniaturized electronic circuit consisting of semiconductor devices, passive components, and wiring, all on a single chip.",
                    symbol: "Usually a rectangle with pins and a functional block diagram inside.",
                    characteristics: ["High density of components", "Small size and weight", "Performs complex functions", "Can be analog, digital, or mixed-signal"],
                    applications: "Microprocessors, memory chips, amplifiers, timers, and logic circuits."
                },
                'arduino-uno': {
                    title: "Arduino Uno",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPj2b8n_p2_d_d8r3t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "The Arduino Uno is a microcontroller board based on the ATmega328P. It's the most popular and versatile board for beginners due to its simplicity and extensive documentation.",
                    symbol: "A drawing of the Arduino Uno board.",
                    characteristics: ["Microcontroller: ATmega328P", "Digital I/O Pins: 14 (6 with PWM)", "Analog Inputs: 6", "Clock Speed: 16 MHz", "Memory: 32 KB Flash, 2 KB SRAM"],
                    applications: "Introductory projects, educational kits, simple robotics, and home automation."
                },
                'arduino-nano': {
                    title: "Arduino Nano",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczMxDJ1DYRkYFc8XHzRXvRxWvtAxdtZKdSKIgwEaQKvaE1ta6iS3ArcMxN1A_oID7ZwX2NFgLe_ZlARx5cteynnTuRrmwbkG_WY3em8GK2KF5B9M6vE=w2400",
                    definition: "The Arduino Nano is a small, complete, and breadboard-friendly board based on the ATmega328P. It's ideal for projects where space is a concern.",
                    symbol: "A drawing of the Arduino Nano board.",
                    characteristics: ["Microcontroller: ATmega328P", "Digital I/O Pins: 14 (6 with PWM)", "Analog Inputs: 8", "Clock Speed: 16 MHz", "Memory: 32 KB Flash, 2 KB SRAM"],
                    applications: "Compact projects, wearable electronics, small robots, and DIY gadgets."
                },
                'arduino-mega': {
                    title: "Arduino Mega",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczMmkQtt_r5x6efheqMEzQSETivFrbS7uwLexrsAqTUyihi7SgPYaqbafao3anY1RooXH5jEc9Pr3zswdPusbrZ83K0ZshkZOm2KANi5ih_T0HTEl-k=w2400",
                    definition: "The Arduino Mega 2560 is a microcontroller board based on the ATmega2560. It is designed for more complex projects that require more I/O pins, memory, and communication ports.",
                    symbol: "A drawing of the Arduino Mega board.",
                    characteristics: ["Microcontroller: ATmega2560", "Digital I/O Pins: 54 (15 with PWM)", "Analog Inputs: 16", "Clock Speed: 16 MHz", "Memory: 256 KB Flash, 8 KB SRAM"],
                    applications: "3D printers, complex robotics, data loggers, and projects with multiple sensors and actuators."
                },
                esp32: {
                    title: "ESP32",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczMxDJ1DYRkYFc8XHzRXvRxWvtAxdtZKdSKIgwEaQKvaE1ta6iS3ArcMxN1A_oID7ZwX2NFgLe_ZlARx5cteynnTuRrmwbkG_WY3em8GK2KF5B9M6vE=w2400",
                    definition: "The ESP32 is a series of low-cost, low-power system on a chip microcontrollers with integrated Wi-Fi and dual-mode Bluetooth.",
                    symbol: "A chip with an antenna.",
                    characteristics: ["Integrated Wi-Fi and Bluetooth", "Dual-core processor", "Low-power consumption", "High number of GPIO pins"],
                    applications: "Internet of Things (IoT) projects, smart home devices, wearable electronics, and mesh network applications."
                },
                raspberrypi: {
                    title: "Raspberry Pi Pico",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPHWYIWyDHIoI8jrNslElD9kybYvRDS8gEVGb1uZk2Hohh-V9klz8cATkS8vGcw0E7UOuMVb56ltuUOpPdy-U0Lak2WUIcCX12X4i3VEKcbGtjDbZg=w2400",
                    definition: "The Raspberry Pi Pico is a powerful, low-cost microcontroller board from the Raspberry Pi Foundation, featuring their own RP2040 chip.",
                    symbol: "A drawing of the Raspberry Pi Pico board.",
                    characteristics: ["Dual-core ARM Cortex-M0+ processor", "High-performance and low-power", "Flexible I/O with Programmable I/O (PIO)", "Supports MicroPython and C/C++ programming"],
                    applications: "Robotics, digital art projects, embedded machine learning, and hardware interfacing."
                },
                stm32: {
                    title: "STM32",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPj2b8n_p2_d_d8r3t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "STM32 is a family of 32-bit microcontroller integrated circuits by STMicroelectronics, based on the ARM Cortex-M processor.",
                    symbol: "A series of chips.",
                    characteristics: ["High processing power", "Wide variety of peripherals", "Low-power modes", "Used in professional and industrial applications"],
                    applications: "Industrial control, motor control, medical devices, consumer electronics, and automotive systems."
                },
                avr: {
                    title: "AVR",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOh7-k6R4p4m7g0j-m4p5j9y3s2f7h1e1p8w8x3g7l9d4u1q1c5a7p5y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "AVR is a family of microcontrollers developed by Atmel (now part of Microchip Technology) and are known for their simplicity and efficiency.",
                    symbol: "A chip.",
                    characteristics: ["8-bit and 32-bit architectures", "RISC instruction set", "On-chip Flash memory and SRAM", "Used in Arduino boards"],
                    applications: "Hobby electronics, educational kits, embedded systems, and consumer appliances."
                },
                pic: {
                    title: "PIC",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczM_5g_3p8_d1q9p4n7j9t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "PIC (Peripheral Interface Controller) is a family of microcontrollers by Microchip Technology, known for their simple architecture and wide availability.",
                    symbol: "A chip.",
                    characteristics: ["Low-power consumption", "RISC architecture", "Extensive peripheral support", "Used in a wide range of applications"],
                    applications: "Consumer electronics, automotive systems, industrial control, and embedded systems."
                },
                ultrasonic: { 
                    title: "Ultrasonic Sensor", 
                    img: "https://lh3.googleusercontent.com/pw/AP1GczMr6sKqBE4JXSzECuWVL8JAn7xYFqihazO-x5Re1IOGe-1eFwimuW-ASLWk1_NBAqo5nc8YUJJWuybEiRdhy_rRc0oiB85hiZs-cVutP8x361z3tDg=w2400", 
                    definition: "An ultrasonic sensor is an electronic device that measures the distance to an object by emitting and receiving high-frequency sound waves.", 
                    symbol: "Typically represented with a speaker and microphone symbols.", 
                    characteristics: ["Operating frequency: 40 kHz", "Measures distance to objects", "Requires trigger and echo pins", "Reliable in various lighting conditions"], 
                    applications: "Obstacle detection, liquid level measurement, robotics, and parking assistance." 
                },
                pir: {
                    title: "PIR Motion Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOCqXW3n6d-t_y5K8y2T8s0r8W0w2E6q2n8v3a0g4w5g6s8x1d6l8f9y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "A Passive Infrared (PIR) sensor is an electronic sensor that measures infrared (IR) light radiating from objects in its field of view, detecting motion.",
                    symbol: "Typically represented as a semi-circle with lines radiating outward.",
                    characteristics: ["Detects motion by sensing heat changes", "Passive sensor (does not emit energy)", "Adjustable sensitivity and delay time", "Commonly used in security systems"],
                    applications: "Security alarms, automatic lighting systems, motion-activated cameras, and smart home devices."
                },
                temperature: {
                    title: "Temperature Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPg1wW7-p9g_T4Z3y8s7h9q7l2a3b4c5d6e7f8g9h0i1j1k1l1m4o4q1r2s3t3u3v3w3x3y3z3a2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "A temperature sensor is a device, typically a thermocouple or thermistor, that measures temperature and converts it into an electrical signal.",
                    symbol: "A circle with a thermometer-like symbol inside.",
                    characteristics: ["Measures temperature in Celsius, Fahrenheit, or Kelvin", "Can be analog or digital", "Varying degrees of accuracy"],
                    applications: "Weather stations, thermostats, smart home devices, and industrial process control."
                },
                humidity: {
                    title: "Humidity Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczO2gVb_j1l2o6o4h5t8i0x1n2p7q9r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1-R-1n2p7Q3E=w2400",
                    definition: "A humidity sensor, also known as a hygrometer, is a device that detects and measures the amount of water vapor in the air.",
                    symbol: "A circle with a water drop symbol inside.",
                    characteristics: ["Measures relative humidity (RH)", "Can be combined with a temperature sensor (e.g., DHT11)", "Crucial for indoor climate control and agriculture"],
                    applications: "Weather stations, smart greenhouses, humidifiers, and HVAC systems."
                },
                light: {
                    title: "Light Sensor (LDR)",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOaQc-e1i5k3e2h3i4j5k6l7m8n9o0p1q1r2s3t3u4v5w5x3y2z1a2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "A Light-Dependent Resistor (LDR) or photoresistor is a component whose resistance decreases with increasing incident light intensity.",
                    symbol: "A resistor symbol with a circle around it and arrows pointing in.",
                    characteristics: ["Resistance changes with light intensity", "Simple and inexpensive", "Used in analog light-sensing circuits"],
                    applications: "Automatic street lights, light-activated alarms, and camera light meters."
                },
                gas: {
                    title: "Gas Sensor (MQ series)",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczO4wUaCNA1YtgMGIXYfHBkPdXIqv-Nhm_jU-060QjUuy9Q1U75Pa6ci1l1qujYxvj_5dAwSEQIrGfvpzaYh1UnLwHCroOo=w2400",
                    definition: "Gas sensors, like the MQ series, are electronic devices used to detect the presence and concentration of various gases in the air.",
                    symbol: "A rectangle with a gas-like symbol inside.",
                    characteristics: ["Detects gases like CO, LPG, smoke, alcohol", "Output is an analog signal that varies with gas concentration", "Requires a pre-heating period to operate"],
                    applications: "Gas leak detection, air quality monitoring, fire alarms, and breathalyzers."
                },
                soilmoisture: {
                    title: "Soil Moisture Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPSn8S_b2V4h3T9c8d6i5j7k_2L1V7d3w8x3g7h5i1j1k1l1m4o4q1r2s3t3u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1-R-1n2p7Q3E=w2400",
                    definition: "A soil moisture sensor measures the volumetric water content in the soil. It works by measuring the dielectric permittivity of the soil.",
                    symbol: "A fork-like symbol with a water drop.",
                    characteristics: ["Measures water content in soil", "Analog or digital output", "Can be sensitive to corrosion"],
                    applications: "Smart agriculture, automated plant watering systems, and gardening."
                },
                rfid: {
                    title: "RFID Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPj2b8n_p2_d_d8r3t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "RFID (Radio-Frequency Identification) uses radio waves to wirelessly transfer data from an RFID tag to a reader.",
                    symbol: "A circle with radio waves emanating from it.",
                    characteristics: ["Non-contact identification", "Can read multiple tags simultaneously", "Different operating frequencies (low, high, ultra-high)", "Tags can be active or passive"],
                    applications: "Access control systems, asset tracking, inventory management, and contactless payments."
                },
                accelerometer: {
                    title: "Accelerometer",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczOHx-Vv2K4k5h7v-M_5r3l4p9Q4p5-p5f4a7j1Q1d5f3j1o8f5k-e8t-d6f7l2-k7p8p9t3f3t6a7r4s5o2a1X88v5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "An accelerometer is a device that measures proper acceleration, a three-axis vector quantity.",
                    symbol: "A circle with a gear-like symbol inside.",
                    characteristics: ["Measures acceleration, tilt, and vibration", "Can detect static and dynamic forces", "Used in conjunction with a gyroscope for orientation"],
                    applications: "Motion-activated games, drones, self-balancing robots, and wearables."
                },
                sound: {
                    title: "Sound Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPg1wW7-p9g_T4Z3y8s7h9q7l2a3b4c5d6e7f8g9h0i1j1k1l1m4o4q1r2s3t3u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1-R-1n2p7Q3E=w2400",
                    definition: "A sound sensor, also known as a sound detector or microphone module, is a device that detects sound waves and converts them into electrical signals.",
                    symbol: "A circle with a microphone symbol inside.",
                    characteristics: ["Detects sound levels and frequency", "Can be analog or digital", "Sensitivity can often be adjusted"],
                    applications: "Sound-activated switches, voice-controlled systems, and noise monitoring."
                },
                heartbeat: {
                    title: "Heartbeat Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczN_Vv-o4s_t-x-y-z-1u-2v-3w-4x-5g-8w-9f-8d-8g-8h-9j9k8l8m7n7o5p4q3r1e1u3v4w5g6h7i8j8k9l8m7n7o5p4q3r1-R-1n2p7Q3E=w2400",
                    definition: "A heartbeat sensor is a device that measures the rate of heartbeat. It works on the principle of photoplethysmography (PPG) to detect changes in blood volume in the fingertip.",
                    symbol: "A heart with a pulse line.",
                    characteristics: ["Measures heart rate in BPM", "Non-invasive", "Requires a finger to be placed on the sensor pad"],
                    applications: "Health monitoring devices, fitness trackers, and stress level indicators."
                },
                gesture: {
                    title: "Gesture Sensor",
                    img: "https://lh3.googleusercontent.com/pw/AP1GczPj2b8n_p2_d_d8r3t1y_S8c2J1V6c2c7p_d2f2d4e3s0y_t4y2h8t2w2v2c9h9p5u2b4j5p4y5u3r8q-3k5w_8d5gA8W3h4L5o7b-R-1n2p7Q3E=w2400",
                    definition: "A gesture sensor is an electronic device that can recognize and interpret human gestures, such as hand movements. It uses infrared light to detect proximity and motion.",
                    symbol: "A hand icon with motion lines.",
                    characteristics: ["Detects gestures like wave, swipe, and scroll", "Works with infrared light", "Provides non-contact control"],
                    applications: "Human-computer interaction (HCI), touchless switches, and robotics control."
                }
                // ... (other components truncated for brevity)
              
            };
            // --- END: Component Data Source (Expanded Content) ---


            // FIX: Component Data Display Logic
            componentCards.forEach(card => {
                card.addEventListener('click', () => {
                    const componentType = card.dataset.component;
                    const compData = componentsData[componentType];
                    
                    // Close other modals before opening component modal
                    if (projectDetailModal) projectDetailModal.style.display = 'none';
                    
                    stopSensorVisualization(); // Stop any existing visualization

                    if (compData) {
                        detailTitle.textContent = compData.title;
                        detailImg.src = compData.img;
                        detailDefinition.textContent = compData.definition;
                        
                        // Show/Hide Sensor Visualization Area
                        if (compData.isSensor) {
                            sensorVizArea.classList.remove('hidden');
                            if (compData.sensorType === 'ultrasonic') {
                                // Only start the complex mock for the specified Ultrasonic Sensor
                                startSensorVisualization('ultrasonic');
                            } else {
                                sensorDataReadout.textContent = `Live Mock unavailable for ${compData.title}.`;
                            }
                        } else {
                            sensorVizArea.classList.add('hidden'); // Ensure it's hidden for non-sensors
                        }
                        
                        try {
                            const tempDiv = document.createElement('div');
                            const latexString = compData.symbol.replace(/\\text\{/g, '\\text{').replace(/}/g, '}');
                            
                            if (latexString.includes('\\Omega') || latexString.includes('\\text{') || latexString.includes('}')) {
                                katex.render(latexString, detailSymbol, { displayMode: false, throwOnError: true });
                            } else {
                                detailSymbol.textContent = compData.symbol;
                            }
                        } catch (e) {
                             console.error("KaTeX rendering failed:", e);
                             detailSymbol.textContent = compData.symbol; 
                        }

                        detailCharacteristics.innerHTML = compData.characteristics.map(char => `<li>${char}</li>`).join('');
                        
                        detailCharacteristics.querySelectorAll('li').forEach(li => {
                            if (window.renderMathInElement) {
                                renderMathInElement(li);
                            }
                        });
                        
                        detailApplications.textContent = compData.applications;
                        
                        askTechwhizComponentBtn.dataset.componentName = compData.title;

                        componentDetailModal.style.display = 'flex'; // This line ensures immediate display
                    } else {
                        // Fallback if data is missing
                        detailTitle.textContent = "Data Unavailable";
                        detailImg.src = "https://via.placeholder.com/400x300/333333/ffffff?text=No+Image";
                        detailDefinition.textContent = "Detailed information for this component is currently under construction.";
                        detailSymbol.textContent = "N/A";
                        detailCharacteristics.innerHTML = '<li>Check back soon!</li>';
                        detailApplications.textContent = "N/A";
                        askTechwhizComponentBtn.dataset.componentName = componentType;
                        componentDetailModal.style.display = 'flex'; // This line ensures immediate display
                    }
                });
            });

            closeDetailBtn.addEventListener('click', () => { 
                componentDetailModal.style.display = 'none'; 
                stopSensorVisualization(); // Stop visualization when closing
            });
            
            // Close component modal if clicking outside
            componentDetailModal.addEventListener('click', (e) => {
                if (e.target === componentDetailModal) {
                    componentDetailModal.style.display = 'none';
                    stopSensorVisualization(); // Stop visualization when closing
                }
            });

            // NEW: Contextual AI button handler (Unchanged)
            askTechwhizComponentBtn.addEventListener('click', () => {
                const componentName = askTechwhizComponentBtn.dataset.componentName || 'this component';
                const prompt = `Explain the key function and most common applications of the ${componentName} for a beginner in electronics.`;
                
                // Close component modal and open TechWhiz modal
                componentDetailModal.style.display = 'none';
                stopSensorVisualization(); // Stop visualization before moving
                techwhizModal.style.display = 'flex';
                
                // Inject prompt into chat input and trigger submission
                techwhizInput.value = prompt;
                sendBtn.click();
            });

            // --- TechWhiz Assistant Logic (Updated for full functionality) ---
            let recognition;
            let isListening = false;
            const synth = window.speechSynthesis;
            let currentUtterance = null;
            const geminiApiKey = "AIzaSyCODRIZL8mNqWpUf0HdWcoCedimZM_0G5E"; // Using empty string for auto-injection

            techwhizFab.addEventListener('click', () => techwhizModal.style.display = 'flex');
            closeTechwhizModalBtn.addEventListener('click', () => {
                techwhizModal.style.display = 'none';
                if (synth.speaking) synth.cancel();
                if (isListening) recognition.stop();
            });

            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';

                recognition.onstart = () => {
                    isListening = true;
                    micBtn.classList.add('speech-active');
                    listeningStatus.classList.remove('hidden');
                };
                
                recognition.onresult = (event) => { 
                    const transcript = event.results[0][0].transcript;
                    techwhizInput.value = transcript;
                    // Automatically process the command once transcribed
                    processCommand(transcript);
                };

                recognition.onerror = (event) => {
                    console.error('Speech Recognition Error:', event.error);
                    showToast(`Voice command error: ${event.error}`, 'accent');
                    isListening = false;
                    micBtn.classList.remove('speech-active');
                    listeningStatus.classList.add('hidden');
                    techwhizInput.disabled = false;
                    sendBtn.disabled = false;
                    micBtn.disabled = false;
                    thinkingStatus.classList.add('hidden');
                };

                recognition.onend = () => {
                    // Only perform cleanup if recognition stops naturally or by error, 
                    // but not if it stops because a command was successfully processed (which calls processCommand)
                    if (isListening) { 
                        isListening = false;
                        micBtn.classList.remove('speech-active');
                        listeningStatus.classList.add('hidden');
                        // No need to re-enable mic/input here as processCommand's finally block handles it.
                    }
                };
            } else {
                micBtn.disabled = true;
                showToast("Speech recognition not supported in this browser.", 'accent');
            }

            micBtn.addEventListener('click', () => { 
                if (isListening) { 
                    recognition.stop(); 
                } else { 
                    techwhizInput.value = ''; 
                    recognition.start(); 
                } 
            });

            sendBtn.addEventListener('click', () => { 
                if (isListening) {
                    recognition.stop();
                } 
                const command = techwhizInput.value.trim(); 
                if (command) processCommand(command); 
            });
            
            techwhizInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendBtn.click(); });
            stopSpeechBtn.addEventListener('click', () => { if (synth.speaking) synth.cancel(); });

            function appendMessage(message, sender) { 
                const msgDiv = document.createElement('div'); 
                msgDiv.className = `chat-message p-3 rounded-lg max-w-[85%] w-fit ${sender === 'user' ? 'bg-secondary text-white rounded-br-none self-end ml-auto' : 'bg-gray-800 text-white rounded-bl-none self-start mr-auto'}`; 
                msgDiv.textContent = message; 
                chatHistory.prepend(msgDiv);
                if(chatHistory.childElementCount > 10) {
                  chatHistory.removeChild(chatHistory.lastChild);
                }
            }

            function readAloud(text) { 
                if (synth.speaking) synth.cancel(); 
                currentUtterance = new SpeechSynthesisUtterance(text); 
                currentUtterance.onend = () => currentUtterance = null; 
                synth.speak(currentUtterance); 
            }

            // --- NEW: Handle UI and Predefined Commands
            function handleUICommand(lowerCommand) {
                let action = { executed: false, response: '' };

                // 1. Greetings / Simple Predefined Responses
                if (lowerCommand.includes('hello') || lowerCommand.includes('hi') || lowerCommand.includes('what up')) {
                    action.executed = true;
                    action.response = "Hello! I am TechWhiz, your electronics and CSE assistant. How can I assist you with your learning today?";
                } else if (lowerCommand.includes('your name') || lowerCommand.includes('who are you')) {
                    action.executed = true;
                    action.response = "I am TECHWHIZ, a helpful assistant powered by Google's Gemini API, designed to assist you with electronics and computer science projects.";
                } else if (lowerCommand.includes('what can you do') || lowerCommand.includes('your capabilities')) {
                    action.executed = true;
                    action.response = "I can help you with electronics and computer science concepts, suggest projects, provide career advice, and even help with debugging and code explanation. Just ask!";
                } else if (lowerCommand.includes('about this website') || lowerCommand.includes('about this html file')) {
                    action.executed = true;
                    action.response = "This is the E-TECH SOLUTIONS dynamic e-learning portal. It offers various courses in electronics and computer science, features user authentication, tracks course progress, and integrates payment options.";
                }

                else if (lowerCommand.includes('what can you do') || lowerCommand.includes('your capabilities')) {
                       action.executed = true;
                     action.response = "I can assist you with course information, generate quizzes, suggest projects, provide career advice, troubleshoot issues, explain code, suggest components, help draft lab reports, and much more related to electronics and IoT learning!";
} else if (lowerCommand.includes('help') || lowerCommand.includes('support')) {
    action.executed = true;
    action.response = "Sure! You can ask me about course details, generate quizzes, suggest project ideas, get career advice, troubleshoot problems, explain code snippets, suggest electronic components, and assist with lab report drafting. How can I assist you today?";
} else if (lowerCommand.includes('about this website') || lowerCommand.includes('about this html file')) {
    action.executed = true;
    action.response = "This is the E-TECH SOLUTIONS dynamic e-learning portal. It offers various courses in electronics and IoT, features user authentication, tracks course progress, and integrates payment options.";
}  else if (lowerCommand.includes('who created you') || lowerCommand.includes('who developed you') || lowerCommand.includes('you are developed by') || lowerCommand.includes('your developer') || lowerCommand.includes('your creator') || lowerCommand.includes('you are developed by whom')) {
    action.executed = true;
    action.response = "I was created by Indra, the founder of E-TECH SOLUTIONS.";
} else if (lowerCommand.includes('about indra') || lowerCommand.includes('indra') || lowerCommand.includes('who is indra') || lowerCommand.includes('tell me about indra')) {
    action.executed = true;
    action.response = "INDRA, an electronics engineer and educator with over 3 years of experience. He passionates to make electronics education accessible to everyone through this platform, E-TECH SOLUTIONS.";
}else if (lowerCommand.includes('qualifications') || lowerCommand.includes('experience')) {
    action.executed = true;
    action.response = "INDRA holds a Diploma in Electronics and Communication Engineering, is a Certified IoT Specialist, has over 2 years of industry experience, 1 year of teaching experience, and has published over 20 technical papers.";
}
                
                // 2. Open/Close Application (Modals)
                else if (lowerCommand.includes('open cart') || lowerCommand.includes('show cart')) {
                    cartModal.classList.add('open');
                    action.executed = true;
                    action.response = "Opening the shopping cart for you now.";
                } else if (lowerCommand.includes('close cart') || lowerCommand.includes('hide cart')) {
                    cartModal.classList.remove('open');
                    action.executed = true;
                    action.response = "Closing the shopping cart.";
                } else if (lowerCommand.includes('close assistant') || lowerCommand.includes('close chat')) {
                    techwhizModal.style.display = 'none';
                    if (synth.speaking) synth.cancel();
                    action.executed = true;
                    action.response = "Closing the assistant. Click the robot icon if you need me again!";
                } else if (lowerCommand.includes('show login') || lowerCommand.includes('open login')) {
                    authModal.style.display = 'flex';
                    action.executed = true;
                    action.response = "Opening the login/register module for you.";
                }

                // 3. Spontaneous Actions (Navigation within the app)
                else if (lowerCommand.includes('go to projects') || lowerCommand.includes('show me projects')) {
                    document.getElementById('projects').scrollIntoView({ behavior: 'smooth' });
                    action.executed = true;
                    action.response = "Scrolling down to the projects section now.";
                } else if (lowerCommand.includes('go to courses') || lowerCommand.includes('view courses')) {
                    document.getElementById('courses').scrollIntoView({ behavior: 'smooth' });
                    action.executed = true;
                    action.response = "Taking you to the available courses.";
                } else if (lowerCommand.includes('go to basics') || lowerCommand.includes('show basics')) {
                    document.getElementById('basics').scrollIntoView({ behavior: 'smooth' });
                    action.executed = true;
                    action.response = "Navigating to the Electronic Basics section.";
                }
                
                // 4. External Application Launches (New functionality)
                else if (lowerCommand.includes('open google')) {
                    window.open('https://www.google.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Google in a new tab.";
                }
                else if (lowerCommand.includes('open instagram')) {
                    window.open('https://www.instagram.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Instagram in a new tab.";
                } else if (lowerCommand.includes('open facebook')) {
                    window.open('https://www.facebook.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Facebook in a new tab.";
                }
                 else if (lowerCommand.includes('open youtube')) {
                    window.open('https://www.youtube.com', '_blank');
                    action.executed = true;
                    action.response = "Opening YouTube in a new tab.";
                } else if (lowerCommand.includes('open calculator')) {
                    window.open('https://www.google.com/search?q=calculator', '_blank');
                    action.executed = true;
                    action.response = "Opening a calculator in a new tab.";
                } else if (lowerCommand.includes('open whatsapp')) {
                    window.open('https://web.whatsapp.com', '_blank');
                    action.executed = true;
                    action.response = "Opening WhatsApp Web in a new tab.";
                } else if (lowerCommand.includes('open email') || lowerCommand.includes('open gmail')) {
                    window.open('https://mail.google.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Gmail in a new tab.";
                }
               
                else if (lowerCommand.includes('open twitter')) {
                    window.open('https://www.twitter.com', '_blank');
                    action.executed = true;
                    action.response = "Opening Twitter in a new tab.";
                }
                else if (lowerCommand.includes('open linkedin')) {
                    window.open('https://www.linkedin.com', '_blank');
                    action.executed = true;
                    action.response = "Opening LinkedIn in a new tab.";
                }
                // 5. Status Check
                else if (lowerCommand.includes('what is my progress') || lowerCommand.includes('my completion status')) {
                    const completed = Object.keys(userProgress).length;
                    const total = allConcepts.length;
                    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
                    
                    if (!userId) {
                        action.response = "Please log in first to track your personalized learning progress.";
                    } else if (total === 0) {
                        action.response = "The learning path data is currently loading. Please try again in a moment.";
                    } else {
                        action.response = `You have completed ${completed} out of ${total} concepts, which is ${percentage} percent completion! Keep up the great work.`;
                    }
                    action.executed = true;
                }

                return action;
            }
            // --- END: Handle UI and Predefined Commands

            async function callGeminiApi(prompt, systemInstruction = null) {
                if (geminiApiKey === "") {
                    // This logic assumes the environment will inject the key, if not, it will fail gracefully.
                }
                
                let backoff = 1000;
                const maxRetries = 5;
                for (let i = 0; i < maxRetries; i++) {
                    try {
                        let chatHistoryForApi = [{ role: "user", parts: [{ text: prompt }] }];
                        const payload = {
                            contents: chatHistoryForApi,
                            systemInstruction: systemInstruction ? { parts: [{ text: systemInstruction }] } : undefined
                        };
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${geminiApiKey}`;

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            if (response.status === 429) {
                                await new Promise(resolve => setTimeout(resolve, backoff));
                                backoff *= 2;
                                continue;
                            }
                            const errorBody = await response.json();
                            throw new Error(`API error: ${response.status} - ${errorBody.error.message}`);
                        }
                        const result = await response.json();
                        return result.candidates?.[0]?.content?.parts?.[0]?.text || "I'm not sure how to respond to that.";
                    } catch (error) {
                        console.error("Error calling Gemini API:", error);
                        if (i === maxRetries - 1) throw error;
                    }
                }
            }

            // --- MODIFIED: processCommand to include predefined answers and spontaneous actions
            async function processCommand(command) {
                if (!command || techwhizInput.disabled) return;
                
                // Clear input only if it's not a voice command that populated it (recognition.onresult clears it)
                if (techwhizInput.value.trim() === command) {
                    techwhizInput.value = '';
                }

                // Show user message immediately
                appendMessage(command, 'user');
                
                techwhizInput.disabled = true;
                sendBtn.disabled = true;
                micBtn.disabled = true;
                thinkingStatus.classList.remove('hidden');

                try {
                    const lowerCommand = command.toLowerCase();
                    let responseText = '';
                    
                    // 1. Check for predefined UI/Action commands
                    const uiAction = handleUICommand(lowerCommand);

                    if (uiAction.executed) {
                        responseText = uiAction.response;
                    } else {
                        // 2. If not a predefined action, use Gemini API
                        let baseSystemInstruction = "You are a professional and helpful electronics and computer science assistant. Provide a friendly and concise answer. Respond exclusively in the language of the user's query. Do not refer to yourself as an AI or a language model.";

                        // Contextual hint for common electronics questions
                        if (lowerCommand.includes('arduino') || lowerCommand.includes('esp32') || lowerCommand.includes('resistor') || lowerCommand.includes('sensor')) {
                             baseSystemInstruction += " Provide a simple, clear explanation suitable for a beginner or hobbyist.";
                        }

                        responseText = await callGeminiApi(command, baseSystemInstruction);
                    }
                    
                    appendMessage(responseText, 'assistant');
                    readAloud(responseText);
                } catch (error) {
                    const errorMsg = "Sorry, I'm having trouble connecting to my brain right now. The API request failed.";
                    appendMessage(errorMsg, 'assistant');
                    readAloud(errorMsg);
                } finally {
                    // FIX: Re-enable ALL controls after processing, regardless of how the command started.
                    techwhizInput.disabled = false;
                    sendBtn.disabled = false;
                    micBtn.disabled = false;
// Cleanup visual state
                    thinkingStatus.classList.add('hidden');
                    micBtn.classList.remove('speech-active');
                    listeningStatus.classList.add('hidden');

                    techwhizInput.focus();
                }
            }
            
            // Initialization
            // Ensure the initial filter is applied to render projects immediately on load
            applyProjectFilter('all'); 
            updateCart();
            // Start the skill tree render with an empty progress object initially
            renderSkillTree({});
            
            if (window.renderMathInElement) {
                renderMathInElement(document.body);
            }
        });
    </script>
</body>
</html>



